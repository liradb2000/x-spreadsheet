{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/component/event.js","webpack:///./src/component/element.js","webpack:///./src/core/alphabet.js","webpack:///./src/core/cell_range.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/history.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/helper.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/core/data_proxy.js","webpack:///./src/config.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/editor.js","webpack:///./src/component/button.js","webpack:///./src/canvas/draw.js","webpack:///./src/core/font.js","webpack:///./src/core/cell.js","webpack:///./src/core/formula.js","webpack:///./src/core/format.js","webpack:///./src/component/table.js","webpack:///./src/component/print.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/toolbar/item.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/toolbar/dropdown_item.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/toolbar/align.js","webpack:///./src/component/toolbar/valign.js","webpack:///./src/component/toolbar/toggle_item.js","webpack:///./src/component/toolbar/autofilter.js","webpack:///./src/component/toolbar/bold.js","webpack:///./src/component/toolbar/italic.js","webpack:///./src/component/toolbar/strike.js","webpack:///./src/component/toolbar/underline.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/toolbar/border.js","webpack:///./src/component/toolbar/icon_item.js","webpack:///./src/component/toolbar/clearformat.js","webpack:///./src/component/toolbar/paintformat.js","webpack:///./src/component/toolbar/text_color.js","webpack:///./src/component/toolbar/fill_color.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/component/toolbar/font_size.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/toolbar/font.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/toolbar/format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/toolbar/formula.js","webpack:///./src/component/toolbar/freeze.js","webpack:///./src/component/toolbar/merge.js","webpack:///./src/component/toolbar/redo.js","webpack:///./src/component/toolbar/undo.js","webpack:///./src/component/toolbar/print.js","webpack:///./src/component/toolbar/textwrap.js","webpack:///./src/component/toolbar/more.js","webpack:///./src/component/toolbar/index.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/sheet.js","webpack:///./src/component/bottombar.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","eventEL","current","window","document","resizeFunc","Set","target","fn","addEventListener","add","unbind","removeEventListener","unbindClickoutside","el","xclickoutside","body","bindClickoutside","cb","evt","detail","contains","hide","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","Math","abs","createEventEmitter","listeners","Map","on","eventName","callback","currentListener","has","Array","isArray","push","set","concat","removeListener","idx","indexOf","splice","length","once","execCalllback","args","fire","exec","removeAllListeners","clear","Element","tag","className","this","createElement","data","undefined","eventNames","handler","split","fen","oen","test","navigator","userAgent","k","button","stopPropagation","keys","forEach","css","top","offsetTop","left","offsetLeft","height","offsetHeight","width","offsetWidth","v","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","arguments","childNodes","ele","child","removeChild","arg","createTextNode","appendChild","classList","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","setAttribute","getAttribute","removeAttribute","content","innerHTML","focus","style","removeProperty","getComputedStyle","h","alphabets","stringAt","index","str","cindex","parseInt","indexAt","ret","charCodeAt","expr2xy","src","x","y","charAt","xy2expr","expr2expr","xn","yn","condition","CellRange","sri","sci","eri","eci","w","ref","refs","ri","ci","rowFilter","j","other","addRet","dsr","dsc","der","dec","multiple","Selector","range","size","Scroll","History","undoItems","redoItems","JSON","stringify","currentd","canUndo","parse","pop","canRedo","Clipboard","state","cellRange","Filter","operator","includes","Sort","order","AutoFilter","filters","sort","map","it","getData","filter","getFilter","hrange","getCell","rset","fset","cell","ctext","text","cnt","valueOf","Merges","_","cr","within","intersects","union","deleteWithin","type","cbWithin","rn","cn","it1","merges","merge","toString","mergeDeep","sources","source","digits","a","numberCalc","a1","a2","Number","isNaN","al1","al2","num1","num2","toFixed","max","cloneDeep","obj","equals","obj1","obj2","v1","v2","ai","arrayEquals","sum","objOrAry","total","rangeEach","min","rangeSum","getv","rangeReduceIf","inits","initv","ifv","deleteProperty","oldv","Rows","len","isHide","row","getOrNew","setHide","exceptSet","helper","getHeight","sumHeight","cells","what","getCellOrNew","editable","srcCellRange","dstCellRange","autofill","dsri","dsci","deri","deci","drn","dcn","isAdd","dn","ii","nri","nci","jj","ncell","replace","word","result","substring","setCell","ncellmm","each","eachCells","setCellText","ndata","rndata","deleteCell","col","ks","entries","assign","Cols","indexWidth","minWidth","getWidth","sumWidth","$languages","$messages","en","toolbar","undo","redo","print","paintformat","clearformat","format","fontName","fontSize","fontBold","fontItalic","underline","strike","color","bgcolor","border","align","valign","textwrap","freeze","autofilter","formula","more","contextmenu","copy","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","deleteSheet","deleteRow","deleteColumn","deleteCellText","validation","cellprintable","cellnonprintable","celleditable","cellnoneditable","orientation","orientations","normal","number","percent","rmb","usd","eur","date","time","datetime","duration","average","_if","and","or","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","error","pasteForMergedCell","calendar","weeks","months","next","cancel","save","ok","desc","asc","empty","dataValidation","criteria","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","lang","message","match","x_spreadsheet","tf","rules","returnMessage","Validator","Date","values","parseValue","Validation","validator","nrefs","difference","Validations","errors","validate","getByValidator","addRef","defaultSize","documentElement","clientHeight","clientWidth","defaultSettings","view","showGrid","showToolbar","showContextmenu","showBottomBar","font","bold","italic","canPaste","dst","clone","srn","scn","copyPaste","rows","deleteCells","cutPaste","clipboard","move","setStyleBorder","bss","styles","cstyle","addStyle","setStyleBorders","selector","isSingleSelected","mergeIndexes","mri","mci","mrl","mcl","bottom","right","getCellMerge","getCellRowByY","scrollOffsety","fsh","freezeTotalHeight","frset","exceptRowSet","getCellColByX","scrollOffsetx","cols","fsw","freezeTotalWidth","DataProxy","settings","validations","hyperlinks","comments","scroll","history","autoFilter","change","sortedRowMap","unsortedRowMap","changeData","setData","copyText","join","clipboardData","clearData","preventDefault","writeText","then","err","console","log","isClear","isCopy","isCut","resetSheet","eventTrigger","readText","contentToPaste","parseClipboardContent","startRow","startColumn","cellContent","clipboardContent","parsedData","txt","lines","srcRange","cri","cci","getFirstIncludes","unmerge","nfont","oldCell","oldText","vIndex","findIndex","getSelectedRect","x1","y1","getRect","left0","top0","totalWidth","totalHeight","cellRect","addFilter","setSort","resetAutoFilter","filteredRows","fary","from","oldAry","b","si","insert","shift","rsize","csize","fci","fri","cellStyle","defaultStyle","getCellStyleOrDefault","setHeight","setWidth","maxCell","exceptRows","exceptRowTH","viewHeight","viewWidth","viewRange","filterIntersects","rlen","clen","unhide","frary","offset","rowHeight","colWidth","nstyle","cssPrefix","devicePixelRatio","Resizer","vertical","minDistance","moving","children","unhideHoverEl","mousedblclickHandler","hoverEl","mousedownHandler","lineEl","cRect","finishedFn","unhideFn","unhideIndex","show","rect","line","hideUnhide","startEvt","distance","e","buttons","movementX","movementY","Scrollbar","moveFn","contentEl","contentDistance","cssKey","startZIndex","SelectorElement","useHideInput","autoFocus","inputChange","cornerEl","areaEl","clipboardEl","autofillEl","hideInput","hideInputDiv","of","val","calBRAreaOffset","ftwidth","ftheight","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","areaOffset","indexes","arange","lastri","lastci","resetAreaOffset","freezeHeight","freezeWidth","setOffset","coffset","getClipboardRect","resetOffset","indexesUpdated","calSelectedRangeByStart","setIndexes","moveIndexes","calSelectedRangeByEnd","setEnd","ern","ecn","showAutofill","hideAutofill","showClipboard","hideClipboard","inputMovePrev","filterItems","itemIndex","inputMoveNext","inputEnter","click","inputKeydownHandler","keyCode","ctrlKey","Suggest","items","itemClick","cssRemoveKeys","parent","startsWith","toUpperCase","title","item","label","html","input","Icon","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","cvalue","headerLeftEl","bodyEl","buildAll","prev","week","selectChange","buildHeaderLeft","buildBody","getFullYear","trs","year","month","cdate","startDate","datess","disabled","getDate","monthDays","tds","Datepicker","setValue","RegExp","resetTextareaSize","inputText","textlineEl","textEl","txts","maxTxtSize","fontWidth","tlineWidth","maxWidth","viewFn","h1","twidth","insertText","itxt","selectionEnd","ntxt","slice","setSelectionRange","keydownEventHandler","altKey","inputEventHandler","suggest","search","start","lastIndexOf","setTextareaRange","position","setTimeout","setText","blur","suggestItemClick","sit","eit","resetSuggestItems","setItems","formulas","Editor","datepicker","dateFormat","bindInputEvents","suggestPosition","elOffset","sOffset","Button","dpr","thinLineWidth","npx","px","npxLine","DrawBox","padding","borderTop","borderRight","borderBottom","borderLeft","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","ctx","getContext","resize","scale","clearRect","options","beginPath","restore","fillRect","fillText","mtxt","box","attr","textWrap","textx","textAlign","textBaseline","fillStyle","strokeStyle","biw","innerWidth","ntxts","txtWidth","measureText","textLine","substr","txtHeight","texty","lineWidth","setLineDash","moveTo","lineTo","stroke","topxys","rightxys","bottomxys","leftxys","sx","sy","closePath","fill","dtextcb","clip","baseFonts","fontSizes","pt","getFontSizePxByPt","infixExprToSuffixExpr","operatorStack","stack","subStrs","fnArgType","fnArgOperator","fnArgsLen","oldc","c1","ex","ey","rangelen","nc","evalSubExpr","subExpr","cellRender","fl","expr","evalSuffixExpr","srcStack","formulaMap","cellList","fc","params","render","reverse","getCellText","baseFormulas","ary","reduce","f","every","some","formulam","formatStringRender","formatNumberRender","first","parts","baseFormats","formatm","tableFixedHeaderCleanStyle","tableGridStyle","getDrawBox","rindex","yoffset","renderCell","draw","nrindex","frozen","dbox","setBorders","strokeBorders","cellText","evalPaused","_cell","getCellTextOrDefault","getError","renderAutofilter","afRange","dropdown","renderContent","fw","fh","exceptRowTotalHeight","filteredTranslateFunc","eachMergesInView","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","rowEach","colEach","renderFixedLeftTopCell","renderContentGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","theight","Table","vr","freezeViewRange","PAGER_SIZES","PAGER_ORIENTATIONS","inches2px","inc","btnClick","toPrint","pagerSizeChange","paper","ps","preview","pagerOrientationChange","Print","iwidth","iheight","contentRange","pages","canvases","mViewRange","th","yo","wrap","canvas","rh","yof","contentWindow","idoc","head","cloneNode","drawImage","menuItems","buildMenuItem","buildMenu","ContextMenu","setMode","hideEl","vhf","Item","shortcut","tip","element","elBox","tooltip","DropdownItem","dd","getValue","setTitle","Dropdown","showArrow","placement","headerClick","setContentChildren","headerEl","DropdownAlign","aligns","icon","naligns","iconName","setName","Align","Valign","ToggleItem","hasClass","Autofilter","Bold","Italic","Strike","Underline","themeColorPlaceHolders","themeColors","standardColors","buildTd","ColorPalette","table","DropdownColor","colorPalette","lineTypes","DropdownLineType","beforei","lineTypeEls","iti","buildTable","BorderPalette","ddColor","ddType","DropdownBorder","borderPalette","Border","IconItem","Clearformat","Paintformat","TextColor","FillColor","DropdownFontSize","nfontSizes","Format","DropdownFontsize","DropdownFont","nfonts","Font","DropdownFormat","nformats","DropdownFormula","nformulas","Freeze","Merge","Redo","Undo","Textwrap","DropdownMore","moreBtns","More","buildDivider","initBtns2","btns2","computedStyle","marginLeft","marginRight","moreResize","btns","moreEl","widthFn","sumWidth2","list1","list2","genBtn","btn","onClick","Toolbar","undoEl","redoEl","paintformatEl","clearformatEl","formatEl","fontEl","fontSizeEl","FontSize","boldEl","italicEl","underlineEl","strikeEl","textColorEl","fillColorEl","borderEl","mergeEl","alignEl","valignEl","textwrapEl","freezeEl","autofilterEl","formulaEl","Formula","extendToolbar","unshift","reset","getSelectedCellStyle","setState","canUnmerge","canAutofilter","freezeIsActive","Modal","dimmer","xkeydownEsc","FormInput","hint","vchange","FormSelect","getTitle","itemEl","patterns","FormField","rule","labelWidth","pattern","ModalValidation","mf","rf","cf","criteriaSelected","criteriaOperatorSelected","minvf","maxvf","svf","vf","action","attrs","field","isShow","clsName","buildSortItem","buildFilterBody","filterbEl","filterValues","filterClick","resetFilterHeader","filterhEl","checked","SortFilter","sortAscEl","sortDescEl","sortDesc","tindex","xtoast","throttle","func","wait","timeout","that","apply","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","selectorSet","contextMenu","trigger","selectorMove","direction","overlayerMousemove","offsetX","offsetY","rowResizer","colResizer","tableEl","tRect","getCellRectByXY","showUnhide","overlayerMousescroll","deltaY","deltaX","loopValue","vFunc","moveY","tempY","tempX","temp","horizontal","moveX","overlayerTouch","verticalScrollbarSet","erth","horizontalScrollbarSet","sheetFreeze","editor","fwidth","fheight","setFreezeLengths","sheetReset","overlayerEl","overlayerCEl","tOffset","vRect","clearClipboard","copyToSystemClipboard","pasteFromSystemClipboard","msg","cdata","pasteFromText","hideRowsOrCols","unhideRowsOrCols","toolbarChangePaintformatPaste","paintformatActive","paintformatToggle","overlayerMousedown","sortFilter","isAutofillEl","getSort","shiftKey","editorSetOffset","sPosition","editorSet","getSelectedCell","getSelectedValidator","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","rowResizerFinished","colResizerFinished","dataSetCellText","setSelectedCellText","insertDeleteRowColumn","setSelectedCellAttr","toolbarChange","sortFilterChange","setAutoFilter","sheetInitEvents","end","startx","starty","modalValidation","xyInSelectedRect","setPosition","touches","pageX","pageY","changedTouches","itext","addValidation","removeValidation","getSelectedValidation","reload","focusing","which","metaKey","Sheet","targetEl","eventMap","resetData","setFreeze","contentClick","Bottombar","addFunc","swapFunc","deleteFunc","updateFunc","dataNames","activeEl","deleteEl","clickSwap2","menuEl","nindex","renameItem","clickSwap","Spreadsheet","selectors","sheetIndex","datas","querySelector","getRootNode","defaultView","observer","ResizeObserver","contentRect","_resizeefunc","observe","bottombar","addSheet","sheet","rootEl","clearLangList","locale","addItem","deleteItem","oldIndex","ds","nd","getCellStyle","spreadsheet"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","/* global window */\r\nexport const eventEL = {\r\n  current: window,\r\n  window: window,\r\n  document: document,\r\n  resizeFunc: new Set(),\r\n};\r\nexport function bind(target = eventEL.window, name, fn) {\r\n  if (target === window) target = eventEL.window;\r\n  if (name === \"resize\") {\r\n    eventEL.resizeFunc.add(fn);\r\n    return;\r\n  }\r\n  target.addEventListener(name, fn);\r\n}\r\nexport function unbind(target, name, fn) {\r\n  if (target === window) target = eventEL.window;\r\n  if (name === \"resize\") {\r\n    eventEL.resizeFunc.delete(fn);\r\n    return;\r\n  }\r\n  target.removeEventListener(name, fn);\r\n}\r\nexport function unbindClickoutside(el) {\r\n  if (el.xclickoutside) {\r\n    unbind(eventEL.document.body, \"click\", el.xclickoutside);\r\n    delete el.xclickoutside;\r\n  }\r\n}\r\n\r\n// the left mouse button: mousedown → mouseup → click\r\n// the right mouse button: mousedown → contenxtmenu → mouseup\r\n// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window\r\nexport function bindClickoutside(el, cb) {\r\n  el.xclickoutside = (evt) => {\r\n    // ignore double click\r\n    // console.log('evt:', evt);\r\n    if (evt.detail === 2 || el.contains(evt.target)) return;\r\n    if (cb) cb(el);\r\n    else {\r\n      el.hide();\r\n      unbindClickoutside(el);\r\n    }\r\n  };\r\n  bind(eventEL.document.body, \"click\", el.xclickoutside);\r\n}\r\nexport function mouseMoveUp(target, movefunc, upfunc) {\r\n  bind(target, \"mousemove\", movefunc);\r\n  const t = target;\r\n  t.xEvtUp = (evt) => {\r\n    // console.log('mouseup>>>');\r\n    unbind(target, \"mousemove\", movefunc);\r\n    unbind(target, \"mouseup\", target.xEvtUp);\r\n    upfunc(evt);\r\n  };\r\n  bind(target, \"mouseup\", target.xEvtUp);\r\n}\r\n\r\nfunction calTouchDirection(spanx, spany, evt, cb) {\r\n  let direction = \"\";\r\n  // console.log('spanx:', spanx, ', spany:', spany);\r\n  if (Math.abs(spanx) > Math.abs(spany)) {\r\n    // horizontal\r\n    direction = spanx > 0 ? \"right\" : \"left\";\r\n    cb(direction, spanx, evt);\r\n  } else {\r\n    // vertical\r\n    direction = spany > 0 ? \"down\" : \"up\";\r\n    cb(direction, spany, evt);\r\n  }\r\n}\r\n// cb = (direction, distance) => {}\r\nexport function bindTouch(target, { move, end }) {\r\n  let startx = 0;\r\n  let starty = 0;\r\n  bind(target, \"touchstart\", (evt) => {\r\n    const { pageX, pageY } = evt.touches[0];\r\n    startx = pageX;\r\n    starty = pageY;\r\n  });\r\n  bind(target, \"touchmove\", (evt) => {\r\n    if (!move) return;\r\n    const { pageX, pageY } = evt.changedTouches[0];\r\n    const spanx = pageX - startx;\r\n    const spany = pageY - starty;\r\n    if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\r\n      // console.log('spanx:', spanx, ', spany:', spany);\r\n      calTouchDirection(spanx, spany, evt, move);\r\n      startx = pageX;\r\n      starty = pageY;\r\n    }\r\n    evt.preventDefault();\r\n  });\r\n  bind(target, \"touchend\", (evt) => {\r\n    if (!end) return;\r\n    const { pageX, pageY } = evt.changedTouches[0];\r\n    const spanx = pageX - startx;\r\n    const spany = pageY - starty;\r\n    calTouchDirection(spanx, spany, evt, end);\r\n  });\r\n}\r\n\r\n// eventemiter\r\nexport function createEventEmitter() {\r\n  const listeners = new Map();\r\n\r\n  function on(eventName, callback) {\r\n    const push = () => {\r\n      const currentListener = listeners.get(eventName);\r\n      return (\r\n        (Array.isArray(currentListener) && currentListener.push(callback)) ||\r\n        false\r\n      );\r\n    };\r\n\r\n    const create = () => listeners.set(eventName, [].concat(callback));\r\n\r\n    return (listeners.has(eventName) && push()) || create();\r\n  }\r\n\r\n  function fire(eventName, args) {\r\n    const exec = () => {\r\n      const currentListener = listeners.get(eventName);\r\n      for (const callback of currentListener) callback.call(null, ...args);\r\n    };\r\n\r\n    return listeners.has(eventName) && exec();\r\n  }\r\n\r\n  function removeListener(eventName, callback) {\r\n    const remove = () => {\r\n      const currentListener = listeners.get(eventName);\r\n      const idx = currentListener.indexOf(callback);\r\n      return (\r\n        idx >= 0 &&\r\n        currentListener.splice(idx, 1) &&\r\n        listeners.get(eventName).length === 0 &&\r\n        listeners.delete(eventName)\r\n      );\r\n    };\r\n\r\n    return listeners.has(eventName) && remove();\r\n  }\r\n\r\n  function once(eventName, callback) {\r\n    const execCalllback = (...args) => {\r\n      callback.call(null, ...args);\r\n      removeListener(eventName, execCalllback);\r\n    };\r\n\r\n    return on(eventName, execCalllback);\r\n  }\r\n\r\n  function removeAllListeners() {\r\n    listeners.clear();\r\n  }\r\n\r\n  return {\r\n    get current() {\r\n      return listeners;\r\n    },\r\n    on,\r\n    once,\r\n    fire,\r\n    removeListener,\r\n    removeAllListeners,\r\n  };\r\n}\r\n","/* global document */\r\n\r\nimport { eventEL } from \"./event\";\r\n\r\n/* global window */\r\nclass Element {\r\n  constructor(tag, className = \"\") {\r\n    if (typeof tag === \"string\") {\r\n      this.el = eventEL.document.createElement(tag);\r\n      this.el.className = className;\r\n    } else {\r\n      this.el = tag;\r\n    }\r\n    this.data = {};\r\n  }\r\n\r\n  data(key, value) {\r\n    if (value !== undefined) {\r\n      this.data[key] = value;\r\n      return this;\r\n    }\r\n    return this.data[key];\r\n  }\r\n\r\n  on(eventNames, handler) {\r\n    const [fen, ...oen] = eventNames.split(\".\");\r\n    let eventName = fen;\r\n    if (\r\n      eventName === \"mousewheel\" &&\r\n      /Firefox/i.test(eventEL.window.navigator.userAgent)\r\n    ) {\r\n      eventName = \"DOMMouseScroll\";\r\n    }\r\n    this.el.addEventListener(eventName, (evt) => {\r\n      handler(evt);\r\n      for (let i = 0; i < oen.length; i += 1) {\r\n        const k = oen[i];\r\n        if (k === \"left\" && evt.button !== 0) {\r\n          return;\r\n        }\r\n        if (k === \"right\" && evt.button !== 2) {\r\n          return;\r\n        }\r\n        if (k === \"stop\") {\r\n          evt.stopPropagation();\r\n        }\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  offset(value) {\r\n    if (value !== undefined) {\r\n      Object.keys(value).forEach((k) => {\r\n        this.css(k, `${value[k]}px`);\r\n      });\r\n      return this;\r\n    }\r\n    const { offsetTop, offsetLeft, offsetHeight, offsetWidth } = this.el;\r\n    return {\r\n      top: offsetTop,\r\n      left: offsetLeft,\r\n      height: offsetHeight,\r\n      width: offsetWidth,\r\n    };\r\n  }\r\n\r\n  scroll(v) {\r\n    const { el } = this;\r\n    if (v !== undefined) {\r\n      if (v.left !== undefined) {\r\n        el.scrollLeft = v.left;\r\n      }\r\n      if (v.top !== undefined) {\r\n        el.scrollTop = v.top;\r\n      }\r\n    }\r\n    return { left: el.scrollLeft, top: el.scrollTop };\r\n  }\r\n\r\n  box() {\r\n    return this.el.getBoundingClientRect();\r\n  }\r\n\r\n  parent() {\r\n    return new Element(this.el.parentNode);\r\n  }\r\n\r\n  children(...eles) {\r\n    if (arguments.length === 0) {\r\n      return this.el.childNodes;\r\n    }\r\n    eles.forEach((ele) => this.child(ele));\r\n    return this;\r\n  }\r\n\r\n  removeChild(el) {\r\n    this.el.removeChild(el);\r\n  }\r\n\r\n  /*\r\n  first() {\r\n    return this.el.firstChild;\r\n  }\r\n\r\n  last() {\r\n    return this.el.lastChild;\r\n  }\r\n\r\n  remove(ele) {\r\n    return this.el.removeChild(ele);\r\n  }\r\n\r\n  prepend(ele) {\r\n    const { el } = this;\r\n    if (el.children.length > 0) {\r\n      el.insertBefore(ele, el.firstChild);\r\n    } else {\r\n      el.appendChild(ele);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  prev() {\r\n    return this.el.previousSibling;\r\n  }\r\n\r\n  next() {\r\n    return this.el.nextSibling;\r\n  }\r\n  */\r\n\r\n  child(arg) {\r\n    let ele = arg;\r\n    if (typeof arg === \"string\") {\r\n      ele = eventEL.document.createTextNode(arg);\r\n    } else if (arg instanceof Element) {\r\n      ele = arg.el;\r\n    }\r\n    this.el.appendChild(ele);\r\n    return this;\r\n  }\r\n\r\n  contains(ele) {\r\n    return this.el.contains(ele);\r\n  }\r\n\r\n  className(v) {\r\n    if (v !== undefined) {\r\n      this.el.className = v;\r\n      return this;\r\n    }\r\n    return this.el.className;\r\n  }\r\n\r\n  addClass(name) {\r\n    this.el.classList.add(name);\r\n    return this;\r\n  }\r\n\r\n  hasClass(name) {\r\n    return this.el.classList.contains(name);\r\n  }\r\n\r\n  removeClass(name) {\r\n    this.el.classList.remove(name);\r\n    return this;\r\n  }\r\n\r\n  toggle(cls = \"active\") {\r\n    return this.toggleClass(cls);\r\n  }\r\n\r\n  toggleClass(name) {\r\n    return this.el.classList.toggle(name);\r\n  }\r\n\r\n  active(flag = true, cls = \"active\") {\r\n    if (flag) this.addClass(cls);\r\n    else this.removeClass(cls);\r\n    return this;\r\n  }\r\n\r\n  checked(flag = true) {\r\n    this.active(flag, \"checked\");\r\n    return this;\r\n  }\r\n\r\n  disabled(flag = true) {\r\n    if (flag) this.addClass(\"disabled\");\r\n    else this.removeClass(\"disabled\");\r\n    return this;\r\n  }\r\n\r\n  // key, value\r\n  // key\r\n  // {k, v}...\r\n  attr(key, value) {\r\n    if (value !== undefined) {\r\n      this.el.setAttribute(key, value);\r\n    } else {\r\n      if (typeof key === \"string\") {\r\n        return this.el.getAttribute(key);\r\n      }\r\n      Object.keys(key).forEach((k) => {\r\n        this.el.setAttribute(k, key[k]);\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  removeAttr(key) {\r\n    this.el.removeAttribute(key);\r\n    return this;\r\n  }\r\n\r\n  html(content) {\r\n    if (content !== undefined) {\r\n      this.el.innerHTML = content;\r\n      return this;\r\n    }\r\n    return this.el.innerHTML;\r\n  }\r\n\r\n  val(v) {\r\n    if (v !== undefined) {\r\n      this.el.value = v;\r\n      return this;\r\n    }\r\n    return this.el.value;\r\n  }\r\n\r\n  focus() {\r\n    this.el.focus();\r\n  }\r\n\r\n  cssRemoveKeys(...keys) {\r\n    keys.forEach((k) => this.el.style.removeProperty(k));\r\n    return this;\r\n  }\r\n\r\n  // css( propertyName )\r\n  // css( propertyName, value )\r\n  // css( properties )\r\n  css(name, value) {\r\n    if (value === undefined && typeof name !== \"string\") {\r\n      Object.keys(name).forEach((k) => {\r\n        this.el.style[k] = name[k];\r\n      });\r\n      return this;\r\n    }\r\n    if (value !== undefined) {\r\n      this.el.style[name] = value;\r\n      return this;\r\n    }\r\n    return this.el.style[name];\r\n  }\r\n\r\n  computedStyle() {\r\n    return window.getComputedStyle(this.el, null);\r\n  }\r\n\r\n  show() {\r\n    this.css(\"display\", \"block\");\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.css(\"display\", \"none\");\r\n    return this;\r\n  }\r\n}\r\n\r\nconst h = (tag, className = \"\") => new Element(tag, className);\r\n\r\nexport { Element, h };\r\n","import './_.prototypes';\r\n\r\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n\r\n/** index number 2 letters\r\n * @example stringAt(26) ==> 'AA'\r\n * @date 2019-10-10\r\n * @export\r\n * @param {number} index\r\n * @returns {string}\r\n */\r\nexport function stringAt(index) {\r\n  let str = '';\r\n  let cindex = index;\r\n  while (cindex >= alphabets.length) {\r\n    cindex /= alphabets.length;\r\n    cindex -= 1;\r\n    str += alphabets[parseInt(cindex, 10) % alphabets.length];\r\n  }\r\n  const last = index % alphabets.length;\r\n  str += alphabets[last];\r\n  return str;\r\n}\r\n\r\n/** translate letter in A1-tag to number\r\n * @date 2019-10-10\r\n * @export\r\n * @param {string} str \"AA\" in A1-tag \"AA1\"\r\n * @returns {number}\r\n */\r\nexport function indexAt(str) {\r\n  let ret = 0;\r\n  for(let i = 0; i !== str.length; ++i) ret = 26 * ret + str.charCodeAt(i) - 64;\r\n  return ret - 1;\r\n}\r\n\r\n\r\n// B10 => x,y\r\n/** translate A1-tag to XY-tag\r\n * @date 2019-10-10\r\n * @export\r\n * @param {tagA1} src\r\n * @returns {tagXY}\r\n */\r\nexport function expr2xy(src) {\r\n  let x = '';\r\n  let y = '';\r\n  for (let i = 0; i < src.length; i += 1) {\r\n    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\r\n      y += src.charAt(i);\r\n    } else {\r\n      x += src.charAt(i);\r\n    }\r\n  }\r\n  return [indexAt(x), parseInt(y, 10) - 1];\r\n}\r\n\r\n/** translate XY-tag to A1-tag\r\n * @example x,y => B10\r\n * @date 2019-10-10\r\n * @export\r\n * @param {number} x\r\n * @param {number} y\r\n * @returns {tagA1}\r\n */\r\nexport function xy2expr(x, y) {\r\n  return `${stringAt(x)}${y + 1}`;\r\n}\r\n\r\n/** translate A1-tag src by (xn, yn)\r\n * @date 2019-10-10\r\n * @export\r\n * @param {tagA1} src\r\n * @param {number} xn\r\n * @param {number} yn\r\n * @returns {tagA1}\r\n */\r\nexport function expr2expr(src, xn, yn, condition = () => true) {\r\n  if (xn === 0 && yn === 0) return src;\r\n  const [x, y] = expr2xy(src);\r\n  if (!condition(x, y)) return src;\r\n  return xy2expr(x + xn, y + yn);\r\n}\r\n\r\nexport default {\r\n  stringAt,\r\n  indexAt,\r\n  expr2xy,\r\n  xy2expr,\r\n  expr2expr,\r\n};\r\n","import { xy2expr, expr2xy } from './alphabet';\r\n\r\nclass CellRange {\r\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n    this.w = w;\r\n    this.h = h;\r\n  }\r\n\r\n  set(sri, sci, eri, eci) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n  }\r\n\r\n  multiple() {\r\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\r\n  }\r\n\r\n  // cell-index: ri, ci\r\n  // cell-ref: A10\r\n  includes(...args) {\r\n    let [ri, ci] = [0, 0];\r\n    if (args.length === 1) {\r\n      [ci, ri] = expr2xy(args[0]);\r\n    } else if (args.length === 2) {\r\n      [ri, ci] = args;\r\n    }\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\r\n  }\r\n\r\n  each(cb, rowFilter = () => true) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    for (let i = sri; i <= eri; i += 1) {\r\n      if (rowFilter(i)) {\r\n        for (let j = sci; j <= eci; j += 1) {\r\n          cb(i, j);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  contains(other) {\r\n    return this.sri <= other.sri\r\n      && this.sci <= other.sci\r\n      && this.eri >= other.eri\r\n      && this.eci >= other.eci;\r\n  }\r\n\r\n  // within\r\n  within(other) {\r\n    return this.sri >= other.sri\r\n      && this.sci >= other.sci\r\n      && this.eri <= other.eri\r\n      && this.eci <= other.eci;\r\n  }\r\n\r\n  // disjoint\r\n  disjoint(other) {\r\n    return this.sri > other.eri\r\n      || this.sci > other.eci\r\n      || other.sri > this.eri\r\n      || other.sci > this.eci;\r\n  }\r\n\r\n  // intersects\r\n  intersects(other) {\r\n    return this.sri <= other.eri\r\n      && this.sci <= other.eci\r\n      && other.sri <= this.eri\r\n      && other.sci <= this.eci;\r\n  }\r\n\r\n  // union\r\n  union(other) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return new CellRange(\r\n      other.sri < sri ? other.sri : sri,\r\n      other.sci < sci ? other.sci : sci,\r\n      other.eri > eri ? other.eri : eri,\r\n      other.eci > eci ? other.eci : eci,\r\n    );\r\n  }\r\n\r\n  // intersection\r\n  // intersection(other) {}\r\n\r\n  // Returns Array<CellRange> that represents that part of this that does not intersect with other\r\n  // difference\r\n  difference(other) {\r\n    const ret = [];\r\n    const addRet = (sri, sci, eri, eci) => {\r\n      ret.push(new CellRange(sri, sci, eri, eci));\r\n    };\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    const dsr = other.sri - sri;\r\n    const dsc = other.sci - sci;\r\n    const der = eri - other.eri;\r\n    const dec = eci - other.eci;\r\n    if (dsr > 0) {\r\n      addRet(sri, sci, other.sri - 1, eci);\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, eci);\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, other.eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, other.eri, eci);\r\n        }\r\n      } else {\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, eri, eci);\r\n        }\r\n      }\r\n    } else if (der > 0) {\r\n      addRet(other.eri + 1, sci, eri, eci);\r\n      if (dsc > 0) {\r\n        addRet(sri, sci, other.eri, other.sci - 1);\r\n      }\r\n      if (dec > 0) {\r\n        addRet(sri, other.eci + 1, other.eri, eci);\r\n      }\r\n    }\r\n    if (dsc > 0) {\r\n      addRet(sri, sci, eri, other.sci - 1);\r\n      if (dec > 0) {\r\n        addRet(sri, other.eri + 1, eri, eci);\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, other.eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, other.eci);\r\n        }\r\n      } else {\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, eci);\r\n        }\r\n      }\r\n    } else if (dec > 0) {\r\n      addRet(eri, other.eci + 1, eri, eci);\r\n      if (dsr > 0) {\r\n        addRet(sri, sci, other.sri - 1, other.eci);\r\n      }\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, other.eci);\r\n      }\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  size() {\r\n    return [\r\n      this.eri - this.sri + 1,\r\n      this.eci - this.sci + 1,\r\n    ];\r\n  }\r\n\r\n  toString() {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    let ref = xy2expr(sci, sri);\r\n    if (this.multiple()) {\r\n      ref = `${ref}:${xy2expr(eci, eri)}`;\r\n    }\r\n    return ref;\r\n  }\r\n\r\n  clone() {\r\n    const {\r\n      sri, sci, eri, eci, w, h,\r\n    } = this;\r\n    return new CellRange(sri, sci, eri, eci, w, h);\r\n  }\r\n\r\n  /*\r\n  toJSON() {\r\n    return this.toString();\r\n  }\r\n  */\r\n\r\n  equals(other) {\r\n    return this.eri === other.eri\r\n      && this.eci === other.eci\r\n      && this.sri === other.sri\r\n      && this.sci === other.sci;\r\n  }\r\n\r\n  static valueOf(ref) {\r\n    // B1:B8, B1 => 1 x 1 cell range\r\n    const refs = ref.split(':');\r\n    const [sci, sri] = expr2xy(refs[0]);\r\n    let [eri, eci] = [sri, sci];\r\n    if (refs.length > 1) {\r\n      [eci, eri] = expr2xy(refs[1]);\r\n    }\r\n    return new CellRange(sri, sci, eri, eci);\r\n  }\r\n}\r\n\r\nexport default CellRange;\r\n\r\nexport {\r\n  CellRange,\r\n};\r\n","import { CellRange } from './cell_range';\r\n\r\nexport default class Selector {\r\n  constructor() {\r\n    this.range = new CellRange(0, 0, 0, 0);\r\n    this.ri = 0;\r\n    this.ci = 0;\r\n  }\r\n\r\n  multiple() {\r\n    return this.range.multiple();\r\n  }\r\n\r\n  setIndexes(ri, ci) {\r\n    this.ri = ri;\r\n    this.ci = ci;\r\n  }\r\n\r\n  size() {\r\n    return this.range.size();\r\n  }\r\n}\r\n","export default class Scroll {\r\n  constructor() {\r\n    this.x = 0; // left\r\n    this.y = 0; // top\r\n    this.ri = 0; // cell row-index\r\n    this.ci = 0; // cell col-index\r\n  }\r\n}\r\n","// import helper from '../helper';\r\n\r\nexport default class History {\r\n  constructor() {\r\n    this.undoItems = [];\r\n    this.redoItems = [];\r\n  }\r\n\r\n  add(data) {\r\n    this.undoItems.push(JSON.stringify(data));\r\n    this.redoItems = [];\r\n  }\r\n\r\n  canUndo() {\r\n    return this.undoItems.length > 0;\r\n  }\r\n\r\n  canRedo() {\r\n    return this.redoItems.length > 0;\r\n  }\r\n\r\n  undo(currentd, cb) {\r\n    const { undoItems, redoItems } = this;\r\n    if (this.canUndo()) {\r\n      redoItems.push(JSON.stringify(currentd));\r\n      cb(JSON.parse(undoItems.pop()));\r\n    }\r\n  }\r\n\r\n  redo(currentd, cb) {\r\n    const { undoItems, redoItems } = this;\r\n    if (this.canRedo()) {\r\n      undoItems.push(JSON.stringify(currentd));\r\n      cb(JSON.parse(redoItems.pop()));\r\n    }\r\n  }\r\n}\r\n","export default class Clipboard {\r\n  constructor() {\r\n    this.range = null; // CellRange\r\n    this.state = 'clear';\r\n  }\r\n\r\n  copy(cellRange) {\r\n    this.range = cellRange;\r\n    this.state = 'copy';\r\n    return this;\r\n  }\r\n\r\n  cut(cellRange) {\r\n    this.range = cellRange;\r\n    this.state = 'cut';\r\n    return this;\r\n  }\r\n\r\n  isCopy() {\r\n    return this.state === 'copy';\r\n  }\r\n\r\n  isCut() {\r\n    return this.state === 'cut';\r\n  }\r\n\r\n  isClear() {\r\n    return this.state === 'clear';\r\n  }\r\n\r\n  clear() {\r\n    this.range = null;\r\n    this.state = 'clear';\r\n  }\r\n}\r\n","import { CellRange } from './cell_range';\r\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\r\n// value:\r\n//   in => []\r\n//   be => [min, max]\r\nclass Filter {\r\n  constructor(ci, operator, value) {\r\n    this.ci = ci;\r\n    this.operator = operator;\r\n    this.value = value;\r\n  }\r\n\r\n  set(operator, value) {\r\n    this.operator = operator;\r\n    this.value = value;\r\n  }\r\n\r\n  includes(v) {\r\n    const { operator, value } = this;\r\n    if (operator === 'all') {\r\n      return true;\r\n    }\r\n    if (operator === 'in') {\r\n      return value.includes(v);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  vlength() {\r\n    const { operator, value } = this;\r\n    if (operator === 'in') {\r\n      return value.length;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  getData() {\r\n    const { ci, operator, value } = this;\r\n    return { ci, operator, value };\r\n  }\r\n}\r\n\r\nclass Sort {\r\n  constructor(ci, order) {\r\n    this.ci = ci;\r\n    this.order = order;\r\n  }\r\n\r\n  asc() {\r\n    return this.order === 'asc';\r\n  }\r\n\r\n  desc() {\r\n    return this.order === 'desc';\r\n  }\r\n}\r\n\r\nexport default class AutoFilter {\r\n  constructor() {\r\n    this.ref = null;\r\n    this.filters = [];\r\n    this.sort = null;\r\n  }\r\n\r\n  setData({ ref, filters, sort }) {\r\n    if (ref != null) {\r\n      this.ref = ref;\r\n      this.filters = filters.map(it => new Filter(it.ci, it.operator, it.value));\r\n      if (sort) {\r\n        this.sort = new Sort(sort.ci, sort.order);\r\n      }\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    if (this.active()) {\r\n      const { ref, filters, sort } = this;\r\n      return { ref, filters: filters.map(it => it.getData()), sort };\r\n    }\r\n    return {};\r\n  }\r\n\r\n  addFilter(ci, operator, value) {\r\n    const filter = this.getFilter(ci);\r\n    if (filter == null) {\r\n      this.filters.push(new Filter(ci, operator, value));\r\n    } else {\r\n      filter.set(operator, value);\r\n    }\r\n  }\r\n\r\n  setSort(ci, order) {\r\n    this.sort = order ? new Sort(ci, order) : null;\r\n  }\r\n\r\n  includes(ri, ci) {\r\n    if (this.active()) {\r\n      return this.hrange().includes(ri, ci);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getSort(ci) {\r\n    const { sort } = this;\r\n    if (sort && sort.ci === ci) {\r\n      return sort;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getFilter(ci) {\r\n    const { filters } = this;\r\n    for (let i = 0; i < filters.length; i += 1) {\r\n      if (filters[i].ci === ci) {\r\n        return filters[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  filteredRows(getCell) {\r\n    // const ary = [];\r\n    // let lastri = 0;\r\n    const rset = new Set();\r\n    const fset = new Set();\r\n    if (this.active()) {\r\n      const { sri, eri } = this.range();\r\n      const { filters } = this;\r\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\r\n        for (let i = 0; i < filters.length; i += 1) {\r\n          const filter = filters[i];\r\n          const cell = getCell(ri, filter.ci);\r\n          const ctext = cell ? cell.text : '';\r\n          if (!filter.includes(ctext)) {\r\n            rset.add(ri);\r\n            break;\r\n          } else {\r\n            fset.add(ri);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return { rset, fset };\r\n  }\r\n\r\n  items(ci, getCell) {\r\n    const m = {};\r\n    if (this.active()) {\r\n      const { sri, eri } = this.range();\r\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\r\n        const cell = getCell(ri, ci);\r\n        if (cell !== null && !/^\\s*$/.test(cell.text)) {\r\n          const key = cell.text;\r\n          const cnt = (m[key] || 0) + 1;\r\n          m[key] = cnt;\r\n        } else {\r\n          m[''] = (m[''] || 0) + 1;\r\n        }\r\n      }\r\n    }\r\n    return m;\r\n  }\r\n\r\n  range() {\r\n    return CellRange.valueOf(this.ref);\r\n  }\r\n\r\n  hrange() {\r\n    const r = this.range();\r\n    r.eri = r.sri;\r\n    return r;\r\n  }\r\n\r\n  clear() {\r\n    this.ref = null;\r\n    this.filters = [];\r\n    this.sort = null;\r\n  }\r\n\r\n  active() {\r\n    return this.ref !== null;\r\n  }\r\n}\r\n","import { CellRange } from './cell_range';\r\n\r\nclass Merges {\r\n  constructor(d = []) {\r\n    this._ = d;\r\n  }\r\n\r\n  forEach(cb) {\r\n    this._.forEach(cb);\r\n  }\r\n\r\n  deleteWithin(cr) {\r\n    this._ = this._.filter(it => !it.within(cr));\r\n  }\r\n\r\n  getFirstIncludes(ri, ci) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const it = this._[i];\r\n      if (it.includes(ri, ci)) {\r\n        return it;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  filterIntersects(cellRange) {\r\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\r\n  }\r\n\r\n  intersects(cellRange) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const it = this._[i];\r\n      if (it.intersects(cellRange)) {\r\n        // console.log('intersects');\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  union(cellRange) {\r\n    let cr = cellRange;\r\n    this._.forEach((it) => {\r\n      if (it.intersects(cr)) {\r\n        cr = it.union(cr);\r\n      }\r\n    });\r\n    return cr;\r\n  }\r\n\r\n  add(cr) {\r\n    this.deleteWithin(cr);\r\n    this._.push(cr);\r\n  }\r\n\r\n  // type: row | column\r\n  shift(type, index, n, cbWithin) {\r\n    this._.forEach((cellRange) => {\r\n      const {\r\n        sri, sci, eri, eci,\r\n      } = cellRange;\r\n      const range = cellRange;\r\n      if (type === 'row') {\r\n        if (sri >= index) {\r\n          range.sri += n;\r\n          range.eri += n;\r\n        } else if (sri < index && index <= eri) {\r\n          range.eri += n;\r\n          cbWithin(sri, sci, n, 0);\r\n        }\r\n      } else if (type === 'column') {\r\n        if (sci >= index) {\r\n          range.sci += n;\r\n          range.eci += n;\r\n        } else if (sci < index && index <= eci) {\r\n          range.eci += n;\r\n          cbWithin(sri, sci, 0, n);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  move(cellRange, rn, cn) {\r\n    this._.forEach((it1) => {\r\n      const it = it1;\r\n      if (it.within(cellRange)) {\r\n        it.eri += rn;\r\n        it.sri += rn;\r\n        it.sci += cn;\r\n        it.eci += cn;\r\n      }\r\n    });\r\n  }\r\n\r\n  setData(merges) {\r\n    this._ = merges.map(merge => CellRange.valueOf(merge));\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    return this._.map(merge => merge.toString());\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Merges,\r\n};\r\n","/* eslint-disable no-param-reassign */\r\nfunction cloneDeep(obj) {\r\n  return JSON.parse(JSON.stringify(obj));\r\n}\r\n\r\nconst mergeDeep = (object = {}, ...sources) => {\r\n  sources.forEach((source) => {\r\n    Object.keys(source).forEach((key) => {\r\n      const v = source[key];\r\n      // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\r\n      if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\r\n        object[key] = v;\r\n      } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {\r\n        object[key] = object[key] || {};\r\n        mergeDeep(object[key], v);\r\n      } else {\r\n        object[key] = v;\r\n      }\r\n    });\r\n  });\r\n  // console.log('::', object);\r\n  return object;\r\n};\r\n\r\nfunction equals(obj1, obj2) {\r\n  const keys = Object.keys(obj1);\r\n  if (keys.length !== Object.keys(obj2).length) return false;\r\n  for (let i = 0; i < keys.length; i += 1) {\r\n    const k = keys[i];\r\n    const v1 = obj1[k];\r\n    const v2 = obj2[k];\r\n    if (v2 === undefined) return false;\r\n    if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {\r\n      if (v1 !== v2) return false;\r\n    } else if (Array.isArray(v1)) {\r\n      if (v1.length !== v2.length) return false;\r\n      for (let ai = 0; ai < v1.length; ai += 1) {\r\n        if (!equals(v1[ai], v2[ai])) return false;\r\n      }\r\n    } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {\r\n      if (!equals(v1, v2)) return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/*\r\n  objOrAry: obejct or Array\r\n  cb: (value, index | key) => { return value }\r\n*/\r\nconst sum = (objOrAry, cb = value => value) => {\r\n  let total = 0;\r\n  let size = 0;\r\n  Object.keys(objOrAry).forEach((key) => {\r\n    total += cb(objOrAry[key], key);\r\n    size += 1;\r\n  });\r\n  return [total, size];\r\n};\r\n\r\nfunction deleteProperty(obj, property) {\r\n  const oldv = obj[`${property}`];\r\n  delete obj[`${property}`];\r\n  return oldv;\r\n}\r\n\r\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\r\n  let s = inits;\r\n  let v = initv;\r\n  let i = min;\r\n  for (; i < max; i += 1) {\r\n    if (s > ifv) break;\r\n    v = getv(i);\r\n    s += v;\r\n  }\r\n  return [i, s - v, v];\r\n}\r\n\r\nfunction rangeSum(min, max, getv) {\r\n  let s = 0;\r\n  for (let i = min; i < max; i += 1) {\r\n    s += getv(i);\r\n  }\r\n  return s;\r\n}\r\n\r\nfunction rangeEach(min, max, cb) {\r\n  for (let i = min; i < max; i += 1) {\r\n    cb(i);\r\n  }\r\n}\r\n\r\nfunction arrayEquals(a1, a2) {\r\n  if (a1.length === a2.length) {\r\n    for (let i = 0; i < a1.length; i += 1) {\r\n      if (a1[i] !== a2[i]) return false;\r\n    }\r\n  } else return false;\r\n  return true;\r\n}\r\n\r\nfunction digits(a) {\r\n  const v = `${a}`;\r\n  let ret = 0;\r\n  let flag = false;\r\n  for (let i = 0; i < v.length; i += 1) {\r\n    if (flag === true) ret += 1;\r\n    if (v.charAt(i) === '.') flag = true;\r\n  }\r\n  return ret;\r\n}\r\n\r\nexport function numberCalc(type, a1, a2) {\r\n  if (Number.isNaN(a1) || Number.isNaN(a2)) {\r\n    return a1 + type + a2;\r\n  }\r\n  const al1 = digits(a1);\r\n  const al2 = digits(a2);\r\n  const num1 = Number(a1);\r\n  const num2 = Number(a2);\r\n  let ret = 0;\r\n  if (type === '-') {\r\n    ret = num1 - num2;\r\n  } else if (type === '+') {\r\n    ret = num1 + num2;\r\n  } else if (type === '*') {\r\n    ret = num1 * num2;\r\n  } else if (type === '/') {\r\n    ret = num1 / num2;\r\n    if (digits(ret) > 5) return ret.toFixed(2);\r\n    return ret;\r\n  }\r\n  return ret.toFixed(Math.max(al1, al2));\r\n}\r\n\r\nexport default {\r\n  cloneDeep,\r\n  merge: (...sources) => mergeDeep({}, ...sources),\r\n  equals,\r\n  arrayEquals,\r\n  sum,\r\n  rangeEach,\r\n  rangeSum,\r\n  rangeReduceIf,\r\n  deleteProperty,\r\n  numberCalc,\r\n};\r\n","import helper from './helper';\r\nimport { expr2expr } from './alphabet';\r\n\r\nclass Rows {\r\n  constructor({ len, height }) {\r\n    this._ = {};\r\n    this.len = len;\r\n    // default row height\r\n    this.height = height;\r\n  }\r\n\r\n  getHeight(ri) {\r\n    if (this.isHide(ri)) return 0;\r\n    const row = this.get(ri);\r\n    if (row && row.height) {\r\n      return row.height;\r\n    }\r\n    return this.height;\r\n  }\r\n\r\n  setHeight(ri, v) {\r\n    const row = this.getOrNew(ri);\r\n    row.height = v;\r\n  }\r\n\r\n  unhide(idx) {\r\n    let index = idx;\r\n    while (index > 0) {\r\n      index -= 1;\r\n      if (this.isHide(index)) {\r\n        this.setHide(index, false);\r\n      } else break;\r\n    }\r\n  }\r\n\r\n  isHide(ri) {\r\n    const row = this.get(ri);\r\n    return row && row.hide;\r\n  }\r\n\r\n  setHide(ri, v) {\r\n    const row = this.getOrNew(ri);\r\n    if (v === true) row.hide = true;\r\n    else delete row.hide;\r\n  }\r\n\r\n  setStyle(ri, style) {\r\n    const row = this.getOrNew(ri);\r\n    row.style = style;\r\n  }\r\n\r\n  sumHeight(min, max, exceptSet) {\r\n    return helper.rangeSum(min, max, (i) => {\r\n      if (exceptSet && exceptSet.has(i)) return 0;\r\n      return this.getHeight(i);\r\n    });\r\n  }\r\n\r\n  totalHeight() {\r\n    return this.sumHeight(0, this.len);\r\n  }\r\n\r\n  get(ri) {\r\n    return this._[ri];\r\n  }\r\n\r\n  getOrNew(ri) {\r\n    this._[ri] = this._[ri] || { cells: {} };\r\n    return this._[ri];\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    const row = this.get(ri);\r\n    if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined) {\r\n      return row.cells[ci];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getCellMerge(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    if (cell && cell.merge) return cell.merge;\r\n    return [0, 0];\r\n  }\r\n\r\n  getCellOrNew(ri, ci) {\r\n    const row = this.getOrNew(ri);\r\n    row.cells[ci] = row.cells[ci] || {};\r\n    return row.cells[ci];\r\n  }\r\n\r\n  // what: all | text | format\r\n  setCell(ri, ci, cell, what = 'all') {\r\n    const row = this.getOrNew(ri);\r\n    if (what === 'all') {\r\n      row.cells[ci] = cell;\r\n    } else if (what === 'text') {\r\n      row.cells[ci] = row.cells[ci] || {};\r\n      row.cells[ci].text = cell.text;\r\n    } else if (what === 'format') {\r\n      row.cells[ci] = row.cells[ci] || {};\r\n      row.cells[ci].style = cell.style;\r\n      if (cell.merge) row.cells[ci].merge = cell.merge;\r\n    }\r\n  }\r\n\r\n  setCellText(ri, ci, text) {\r\n    const cell = this.getCellOrNew(ri, ci);\r\n    if (cell.editable !== false) cell.text = text;\r\n  }\r\n\r\n  // what: all | format | text\r\n  copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {}) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = srcCellRange;\r\n    const dsri = dstCellRange.sri;\r\n    const dsci = dstCellRange.sci;\r\n    const deri = dstCellRange.eri;\r\n    const deci = dstCellRange.eci;\r\n    const [rn, cn] = srcCellRange.size();\r\n    const [drn, dcn] = dstCellRange.size();\r\n    // console.log(srcIndexes, dstIndexes);\r\n    let isAdd = true;\r\n    let dn = 0;\r\n    if (deri < sri || deci < sci) {\r\n      isAdd = false;\r\n      if (deri < sri) dn = drn;\r\n      else dn = dcn;\r\n    }\r\n    for (let i = sri; i <= eri; i += 1) {\r\n      if (this._[i]) {\r\n        for (let j = sci; j <= eci; j += 1) {\r\n          if (this._[i].cells && this._[i].cells[j]) {\r\n            for (let ii = dsri; ii <= deri; ii += rn) {\r\n              for (let jj = dsci; jj <= deci; jj += cn) {\r\n                const nri = ii + (i - sri);\r\n                const nci = jj + (j - sci);\r\n                const ncell = helper.cloneDeep(this._[i].cells[j]);\r\n                // ncell.text\r\n                if (autofill && ncell && ncell.text && ncell.text.length > 0) {\r\n                  const { text } = ncell;\r\n                  let n = (jj - dsci) + (ii - dsri) + 2;\r\n                  if (!isAdd) {\r\n                    n -= dn + 1;\r\n                  }\r\n                  if (text[0] === '=') {\r\n                    ncell.text = text.replace(/[a-zA-Z]{1,3}\\d+/g, (word) => {\r\n                      let [xn, yn] = [0, 0];\r\n                      if (sri === dsri) {\r\n                        xn = n - 1;\r\n                        // if (isAdd) xn -= 1;\r\n                      } else {\r\n                        yn = n - 1;\r\n                      }\r\n                      if (/^\\d+$/.test(word)) return word;\r\n                      return expr2expr(word, xn, yn);\r\n                    });\r\n                  } else if ((rn <= 1 && cn > 1 && (dsri > eri || deri < sri))\r\n                    || (cn <= 1 && rn > 1 && (dsci > eci || deci < sci))\r\n                    || (rn <= 1 && cn <= 1)) {\r\n                    const result = /[\\\\.\\d]+$/.exec(text);\r\n                    // console.log('result:', result);\r\n                    if (result !== null) {\r\n                      const index = Number(result[0]) + n - 1;\r\n                      ncell.text = text.substring(0, result.index) + index;\r\n                    }\r\n                  }\r\n                }\r\n                this.setCell(nri, nci, ncell, what);\r\n                cb(nri, nci, ncell);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  cutPaste(srcCellRange, dstCellRange) {\r\n    const ncellmm = {};\r\n    this.each((ri) => {\r\n      this.eachCells(ri, (ci) => {\r\n        let nri = parseInt(ri, 10);\r\n        let nci = parseInt(ci, 10);\r\n        if (srcCellRange.includes(ri, ci)) {\r\n          nri = dstCellRange.sri + (nri - srcCellRange.sri);\r\n          nci = dstCellRange.sci + (nci - srcCellRange.sci);\r\n        }\r\n        ncellmm[nri] = ncellmm[nri] || { cells: {} };\r\n        ncellmm[nri].cells[nci] = this._[ri].cells[ci];\r\n      });\r\n    });\r\n    this._ = ncellmm;\r\n  }\r\n\r\n  // src: Array<Array<String>>\r\n  paste(src, dstCellRange) {\r\n    if (src.length <= 0) return;\r\n    const { sri, sci } = dstCellRange;\r\n    src.forEach((row, i) => {\r\n      const ri = sri + i;\r\n      row.forEach((cell, j) => {\r\n        const ci = sci + j;\r\n        this.setCellText(ri, ci, cell);\r\n      });\r\n    });\r\n  }\r\n\r\n  insert(sri, n = 1) {\r\n    const ndata = {};\r\n    this.each((ri, row) => {\r\n      let nri = parseInt(ri, 10);\r\n      if (nri >= sri) {\r\n        nri += n;\r\n        this.eachCells(ri, (ci, cell) => {\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, n, (x, y) => y >= sri));\r\n          }\r\n        });\r\n      }\r\n      ndata[nri] = row;\r\n    });\r\n    this._ = ndata;\r\n    this.len += n;\r\n  }\r\n\r\n  delete(sri, eri) {\r\n    const n = eri - sri + 1;\r\n    const ndata = {};\r\n    this.each((ri, row) => {\r\n      const nri = parseInt(ri, 10);\r\n      if (nri < sri) {\r\n        ndata[nri] = row;\r\n      } else if (ri > eri) {\r\n        ndata[nri - n] = row;\r\n        this.eachCells(ri, (ci, cell) => {\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, -n, (x, y) => y > eri));\r\n          }\r\n        });\r\n      }\r\n    });\r\n    this._ = ndata;\r\n    this.len -= n;\r\n  }\r\n\r\n  insertColumn(sci, n = 1) {\r\n    this.each((ri, row) => {\r\n      const rndata = {};\r\n      this.eachCells(ri, (ci, cell) => {\r\n        let nci = parseInt(ci, 10);\r\n        if (nci >= sci) {\r\n          nci += n;\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, n, 0, x => x >= sci));\r\n          }\r\n        }\r\n        rndata[nci] = cell;\r\n      });\r\n      row.cells = rndata;\r\n    });\r\n  }\r\n\r\n  deleteColumn(sci, eci) {\r\n    const n = eci - sci + 1;\r\n    this.each((ri, row) => {\r\n      const rndata = {};\r\n      this.eachCells(ri, (ci, cell) => {\r\n        const nci = parseInt(ci, 10);\r\n        if (nci < sci) {\r\n          rndata[nci] = cell;\r\n        } else if (nci > eci) {\r\n          rndata[nci - n] = cell;\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, -n, 0, x => x > eci));\r\n          }\r\n        }\r\n      });\r\n      row.cells = rndata;\r\n    });\r\n  }\r\n\r\n  // what: all | text | format | merge\r\n  deleteCells(cellRange, what = 'all') {\r\n    cellRange.each((i, j) => {\r\n      this.deleteCell(i, j, what);\r\n    });\r\n  }\r\n\r\n  // what: all | text | format | merge\r\n  deleteCell(ri, ci, what = 'all') {\r\n    const row = this.get(ri);\r\n    if (row !== null) {\r\n      const cell = this.getCell(ri, ci);\r\n      if (cell !== null && cell.editable !== false) {\r\n        if (what === 'all') {\r\n          delete row.cells[ci];\r\n        } else if (what === 'text') {\r\n          if (cell.text) delete cell.text;\r\n          if (cell.value) delete cell.value;\r\n        } else if (what === 'format') {\r\n          if (cell.style !== undefined) delete cell.style;\r\n          if (cell.merge) delete cell.merge;\r\n        } else if (what === 'merge') {\r\n          if (cell.merge) delete cell.merge;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  maxCell() {\r\n    const keys = Object.keys(this._);\r\n    const ri = keys[keys.length - 1];\r\n    const col = this._[ri];\r\n    if (col) {\r\n      const { cells } = col;\r\n      const ks = Object.keys(cells);\r\n      const ci = ks[ks.length - 1];\r\n      return [parseInt(ri, 10), parseInt(ci, 10)];\r\n    }\r\n    return [0, 0];\r\n  }\r\n\r\n  each(cb) {\r\n    Object.entries(this._).forEach(([ri, row]) => {\r\n      cb(ri, row);\r\n    });\r\n  }\r\n\r\n  eachCells(ri, cb) {\r\n    if (this._[ri] && this._[ri].cells) {\r\n      Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\r\n        cb(ci, cell);\r\n      });\r\n    }\r\n  }\r\n\r\n  setData(d) {\r\n    if (d.len) {\r\n      this.len = d.len;\r\n      delete d.len;\r\n    }\r\n    this._ = d;\r\n  }\r\n\r\n  getData() {\r\n    const { len } = this;\r\n    return Object.assign({ len }, this._);\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Rows,\r\n};\r\n","import helper from './helper';\r\n\r\nclass Cols {\r\n  constructor({\r\n    len, width, indexWidth, minWidth,\r\n  }) {\r\n    this._ = {};\r\n    this.len = len;\r\n    this.width = width;\r\n    this.indexWidth = indexWidth;\r\n    this.minWidth = minWidth;\r\n  }\r\n\r\n  setData(d) {\r\n    if (d.len) {\r\n      this.len = d.len;\r\n      delete d.len;\r\n    }\r\n    this._ = d;\r\n  }\r\n\r\n  getData() {\r\n    const { len } = this;\r\n    return Object.assign({ len }, this._);\r\n  }\r\n\r\n  getWidth(i) {\r\n    if (this.isHide(i)) return 0;\r\n    const col = this._[i];\r\n    if (col && col.width) {\r\n      return col.width;\r\n    }\r\n    return this.width;\r\n  }\r\n\r\n  getOrNew(ci) {\r\n    this._[ci] = this._[ci] || {};\r\n    return this._[ci];\r\n  }\r\n\r\n  setWidth(ci, width) {\r\n    const col = this.getOrNew(ci);\r\n    col.width = width;\r\n  }\r\n\r\n  unhide(idx) {\r\n    let index = idx;\r\n    while (index > 0) {\r\n      index -= 1;\r\n      if (this.isHide(index)) {\r\n        this.setHide(index, false);\r\n      } else break;\r\n    }\r\n  }\r\n\r\n  isHide(ci) {\r\n    const col = this._[ci];\r\n    return col && col.hide;\r\n  }\r\n\r\n  setHide(ci, v) {\r\n    const col = this.getOrNew(ci);\r\n    if (v === true) col.hide = true;\r\n    else delete col.hide;\r\n  }\r\n\r\n  setStyle(ci, style) {\r\n    const col = this.getOrNew(ci);\r\n    col.style = style;\r\n  }\r\n\r\n  sumWidth(min, max) {\r\n    return helper.rangeSum(min, max, i => this.getWidth(i));\r\n  }\r\n\r\n  totalWidth() {\r\n    return this.sumWidth(0, this.len);\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Cols,\r\n};\r\n","/* global window */\r\nimport en from './en';\r\n\r\n// Defines the fallback language as English\r\nlet $languages = ['en'];\r\nconst $messages = {\r\n  en,\r\n};\r\n\r\nfunction translate(key, messages) {\r\n  if (messages) {\r\n    // Return the translation from the first language in the languages array\r\n    // that has a value for the provided key.\r\n    for (const lang of $languages) {\r\n      if (!messages[lang]) break;\r\n\r\n      let message = messages[lang];\r\n\r\n      // Splits the key at '.' except where escaped as '\\.'\r\n      const keys = key.match(/(?:\\\\.|[^.])+/g);\r\n\r\n      for (let i = 0; i < keys.length; i += 1) {\r\n        const property = keys[i];\r\n        const value = message[property];\r\n\r\n        // If value doesn't exist, try next language\r\n        if (!value) break;\r\n\r\n        if (i === keys.length - 1) return value;\r\n\r\n        // Move down to the next level of the messages object\r\n        message = value;\r\n      }\r\n    }\r\n  }\r\n\r\n  return undefined;\r\n}\r\n\r\nfunction t(key) {\r\n  let v = translate(key, $messages);\r\n  if (!v && window && window.x_spreadsheet && window.x_spreadsheet.$messages) {\r\n    v = translate(key, window.x_spreadsheet.$messages);\r\n  }\r\n  return v || '';\r\n}\r\n\r\nfunction tf(key) {\r\n  return () => t(key);\r\n}\r\n\r\n// If clearLangList is set to false, lang will be added to the front of the\r\n// languages array. The languages in the language array are searched in order\r\n// to find a translation. This allows the use of other languages as a fallback\r\n// if lang is missing some keys. The language array is preloaded with English.\r\n// To set the languages array to only include lang, set clearLangList to true.\r\nfunction locale(lang, message, clearLangList = false) {\r\n  if (clearLangList) {\r\n    $languages = [lang];\r\n  } else {\r\n    // Append to front of array.\r\n    // Translation method will use the first language in the list that has a\r\n    // matching key.\r\n    $languages.unshift(lang);\r\n  }\r\n\r\n  if (message) {\r\n    $messages[lang] = message;\r\n  }\r\n}\r\n\r\nexport default {\r\n  t,\r\n};\r\n\r\nexport {\r\n  locale,\r\n  t,\r\n  tf,\r\n};\r\n","export default {\r\n  toolbar: {\r\n    undo: 'Undo',\r\n    redo: 'Redo',\r\n    print: 'Print',\r\n    paintformat: 'Paint format',\r\n    clearformat: 'Clear format',\r\n    format: 'Format',\r\n    fontName: 'Font',\r\n    fontSize: 'Font size',\r\n    fontBold: 'Font bold',\r\n    fontItalic: 'Font italic',\r\n    underline: 'Underline',\r\n    strike: 'Strike',\r\n    color: 'Text color',\r\n    bgcolor: 'Fill color',\r\n    border: 'Borders',\r\n    merge: 'Merge cells',\r\n    align: 'Horizontal align',\r\n    valign: 'Vertical align',\r\n    textwrap: 'Text wrapping',\r\n    freeze: 'Freeze cell',\r\n    autofilter: 'Filter',\r\n    formula: 'Functions',\r\n    more: 'More',\r\n  },\r\n  contextmenu: {\r\n    copy: 'Copy',\r\n    cut: 'Cut',\r\n    paste: 'Paste',\r\n    pasteValue: 'Paste values only',\r\n    pasteFormat: 'Paste format only',\r\n    hide: 'Hide',\r\n    insertRow: 'Insert row',\r\n    insertColumn: 'Insert column',\r\n    deleteSheet: 'Delete',\r\n    deleteRow: 'Delete row',\r\n    deleteColumn: 'Delete column',\r\n    deleteCell: 'Delete cell',\r\n    deleteCellText: 'Delete cell text',\r\n    validation: 'Data validations',\r\n    cellprintable: 'Enable export',\r\n    cellnonprintable: 'Disable export',\r\n    celleditable: 'Enable editing',\r\n    cellnoneditable: 'Disable editing',\r\n  },\r\n  print: {\r\n    size: 'Paper size',\r\n    orientation: 'Page orientation',\r\n    orientations: ['Landscape', 'Portrait'],\r\n  },\r\n  format: {\r\n    normal: 'Normal',\r\n    text: 'Plain Text',\r\n    number: 'Number',\r\n    percent: 'Percent',\r\n    rmb: 'RMB',\r\n    usd: 'USD',\r\n    eur: 'EUR',\r\n    date: 'Date',\r\n    time: 'Time',\r\n    datetime: 'Date time',\r\n    duration: 'Duration',\r\n  },\r\n  formula: {\r\n    sum: 'Sum',\r\n    average: 'Average',\r\n    max: 'Max',\r\n    min: 'Min',\r\n    _if: 'IF',\r\n    and: 'AND',\r\n    or: 'OR',\r\n    concat: 'Concat',\r\n  },\r\n  validation: {\r\n    required: 'it must be required',\r\n    notMatch: 'it not match its validation rule',\r\n    between: 'it is between {} and {}',\r\n    notBetween: 'it is not between {} and {}',\r\n    notIn: 'it is not in list',\r\n    equal: 'it equal to {}',\r\n    notEqual: 'it not equal to {}',\r\n    lessThan: 'it less than {}',\r\n    lessThanEqual: 'it less than or equal to {}',\r\n    greaterThan: 'it greater than {}',\r\n    greaterThanEqual: 'it greater than or equal to {}',\r\n  },\r\n  error: {\r\n    pasteForMergedCell: 'Unable to do this for merged cells',\r\n  },\r\n  calendar: {\r\n    weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\r\n    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\r\n  },\r\n  button: {\r\n    next: 'Next',\r\n    cancel: 'Cancel',\r\n    remove: 'Remove',\r\n    save: 'Save',\r\n    ok: 'OK',\r\n  },\r\n  sort: {\r\n    desc: 'Sort Z -> A',\r\n    asc: 'Sort A -> Z',\r\n  },\r\n  filter: {\r\n    empty: 'empty',\r\n  },\r\n  dataValidation: {\r\n    mode: 'Mode',\r\n    range: 'Cell Range',\r\n    criteria: 'Criteria',\r\n    modeType: {\r\n      cell: 'Cell',\r\n      column: 'Colun',\r\n      row: 'Row',\r\n    },\r\n    type: {\r\n      list: 'List',\r\n      number: 'Number',\r\n      date: 'Date',\r\n      phone: 'Phone',\r\n      email: 'Email',\r\n    },\r\n    operator: {\r\n      be: 'between',\r\n      nbe: 'not betwwen',\r\n      lt: 'less than',\r\n      lte: 'less than or equal to',\r\n      gt: 'greater than',\r\n      gte: 'greater than or equal to',\r\n      eq: 'equal to',\r\n      neq: 'not equal to',\r\n    },\r\n  },\r\n};\r\n","import { t } from '../locale/locale';\r\nimport helper from './helper';\r\n\r\nconst rules = {\r\n  phone: /^[1-9]\\d{10}$/,\r\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\r\n};\r\n\r\nfunction returnMessage(flag, key, ...arg) {\r\n  let message = '';\r\n  if (!flag) {\r\n    message = t(`validation.${key}`, ...arg);\r\n  }\r\n  return [flag, message];\r\n}\r\n\r\nexport default class Validator {\r\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\r\n  // type: date|number|list|phone|email\r\n  constructor(type, required, value, operator) {\r\n    this.required = required;\r\n    this.value = value;\r\n    this.type = type;\r\n    this.operator = operator;\r\n    this.message = '';\r\n  }\r\n\r\n  parseValue(v) {\r\n    const { type } = this;\r\n    if (type === 'date') {\r\n      return new Date(v);\r\n    }\r\n    if (type === 'number') {\r\n      return Number(v);\r\n    }\r\n    return v;\r\n  }\r\n\r\n  equals(other) {\r\n    let flag = this.type === other.type\r\n      && this.required === other.required\r\n      && this.operator === other.operator;\r\n    if (flag) {\r\n      if (Array.isArray(this.value)) {\r\n        flag = helper.arrayEquals(this.value, other.value);\r\n      } else {\r\n        flag = this.value === other.value;\r\n      }\r\n    }\r\n    return flag;\r\n  }\r\n\r\n  values() {\r\n    return this.value.split(',');\r\n  }\r\n\r\n  validate(v) {\r\n    const {\r\n      required, operator, value, type,\r\n    } = this;\r\n    if (required && /^\\s*$/.test(v)) {\r\n      return returnMessage(false, 'required');\r\n    }\r\n    if (/^\\s*$/.test(v)) return [true];\r\n    if (rules[type] && !rules[type].test(v)) {\r\n      return returnMessage(false, 'notMatch');\r\n    }\r\n    if (type === 'list') {\r\n      return returnMessage(this.values().includes(v), 'notIn');\r\n    }\r\n    if (operator) {\r\n      const v1 = this.parseValue(v);\r\n      if (operator === 'be') {\r\n        const [min, max] = value;\r\n        return returnMessage(\r\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\r\n          'between',\r\n          min,\r\n          max,\r\n        );\r\n      }\r\n      if (operator === 'nbe') {\r\n        const [min, max] = value;\r\n        return returnMessage(\r\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\r\n          'notBetween',\r\n          min,\r\n          max,\r\n        );\r\n      }\r\n      if (operator === 'eq') {\r\n        return returnMessage(\r\n          v1 === this.parseValue(value),\r\n          'equal',\r\n          value,\r\n        );\r\n      }\r\n      if (operator === 'neq') {\r\n        return returnMessage(\r\n          v1 !== this.parseValue(value),\r\n          'notEqual',\r\n          value,\r\n        );\r\n      }\r\n      if (operator === 'lt') {\r\n        return returnMessage(\r\n          v1 < this.parseValue(value),\r\n          'lessThan',\r\n          value,\r\n        );\r\n      }\r\n      if (operator === 'lte') {\r\n        return returnMessage(\r\n          v1 <= this.parseValue(value),\r\n          'lessThanEqual',\r\n          value,\r\n        );\r\n      }\r\n      if (operator === 'gt') {\r\n        return returnMessage(\r\n          v1 > this.parseValue(value),\r\n          'greaterThan',\r\n          value,\r\n        );\r\n      }\r\n      if (operator === 'gte') {\r\n        return returnMessage(\r\n          v1 >= this.parseValue(value),\r\n          'greaterThanEqual',\r\n          value,\r\n        );\r\n      }\r\n    }\r\n    return [true];\r\n  }\r\n}\r\n","import Validator from './validator';\r\nimport { CellRange } from './cell_range';\r\n\r\nclass Validation {\r\n  constructor(mode, refs, validator) {\r\n    this.refs = refs;\r\n    this.mode = mode; // cell\r\n    this.validator = validator;\r\n  }\r\n\r\n  includes(ri, ci) {\r\n    const { refs } = this;\r\n    for (let i = 0; i < refs.length; i += 1) {\r\n      const cr = CellRange.valueOf(refs[i]);\r\n      if (cr.includes(ri, ci)) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  addRef(ref) {\r\n    this.remove(CellRange.valueOf(ref));\r\n    this.refs.push(ref);\r\n  }\r\n\r\n  remove(cellRange) {\r\n    const nrefs = [];\r\n    this.refs.forEach((it) => {\r\n      const cr = CellRange.valueOf(it);\r\n      if (cr.intersects(cellRange)) {\r\n        const crs = cr.difference(cellRange);\r\n        crs.forEach(it1 => nrefs.push(it1.toString()));\r\n      } else {\r\n        nrefs.push(it);\r\n      }\r\n    });\r\n    this.refs = nrefs;\r\n  }\r\n\r\n  getData() {\r\n    const { refs, mode, validator } = this;\r\n    const {\r\n      type, required, operator, value,\r\n    } = validator;\r\n    return {\r\n      refs, mode, type, required, operator, value,\r\n    };\r\n  }\r\n\r\n  static valueOf({\r\n    refs, mode, type, required, operator, value,\r\n  }) {\r\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\r\n  }\r\n}\r\nclass Validations {\r\n  constructor() {\r\n    this._ = [];\r\n    // ri_ci: errMessage\r\n    this.errors = new Map();\r\n  }\r\n\r\n  getError(ri, ci) {\r\n    return this.errors.get(`${ri}_${ci}`);\r\n  }\r\n\r\n  validate(ri, ci, text) {\r\n    const v = this.get(ri, ci);\r\n    const key = `${ri}_${ci}`;\r\n    const { errors } = this;\r\n    if (v !== null) {\r\n      const [flag, message] = v.validator.validate(text);\r\n      if (!flag) {\r\n        errors.set(key, message);\r\n      } else {\r\n        errors.delete(key);\r\n      }\r\n    } else {\r\n      errors.delete(key);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  // type: date|number|phone|email|list\r\n  // validator: { required, value, operator }\r\n  add(mode, ref, {\r\n    type, required, value, operator,\r\n  }) {\r\n    const validator = new Validator(\r\n      type, required, value, operator,\r\n    );\r\n    const v = this.getByValidator(validator);\r\n    if (v !== null) {\r\n      v.addRef(ref);\r\n    } else {\r\n      this._.push(new Validation(mode, [ref], validator));\r\n    }\r\n  }\r\n\r\n  getByValidator(validator) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const v = this._[i];\r\n      if (v.validator.equals(validator)) {\r\n        return v;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  get(ri, ci) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const v = this._[i];\r\n      if (v.includes(ri, ci)) return v;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  remove(cellRange) {\r\n    this.each((it) => {\r\n      it.remove(cellRange);\r\n    });\r\n  }\r\n\r\n  each(cb) {\r\n    this._.forEach(it => cb(it));\r\n  }\r\n\r\n  getData() {\r\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\r\n  }\r\n\r\n  setData(d) {\r\n    this._ = d.map(it => Validation.valueOf(it));\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Validations,\r\n};\r\n","/* global document */\r\n\r\nimport Selector from \"./selector\";\r\nimport Scroll from \"./scroll\";\r\nimport History from \"./history\";\r\nimport Clipboard from \"./clipboard\";\r\nimport AutoFilter from \"./auto_filter\";\r\nimport { Merges } from \"./merge\";\r\nimport helper from \"./helper\";\r\nimport { Rows } from \"./row\";\r\nimport { Cols } from \"./col\";\r\nimport { Validations } from \"./validation\";\r\nimport { CellRange } from \"./cell_range\";\r\nimport { expr2xy, xy2expr } from \"./alphabet\";\r\nimport { t } from \"../locale/locale\";\r\nimport { eventEL } from \"../component/event\";\r\n\r\n// private methods\r\n/*\r\n * {\r\n *  name: ''\r\n *  freeze: [0, 0],\r\n *  formats: [],\r\n *  styles: [\r\n *    {\r\n *      bgcolor: '',\r\n *      align: '',\r\n *      valign: '',\r\n *      textwrap: false,\r\n *      strike: false,\r\n *      underline: false,\r\n *      color: '',\r\n *      format: 1,\r\n *      border: {\r\n *        left: [style, color],\r\n *        right: [style, color],\r\n *        top: [style, color],\r\n *        bottom: [style, color],\r\n *      },\r\n *      font: {\r\n *        name: 'Helvetica',\r\n *        size: 10,\r\n *        bold: false,\r\n *        italic: false,\r\n *      }\r\n *    }\r\n *  ],\r\n *  merges: [\r\n *    'A1:F11',\r\n *    ...\r\n *  ],\r\n *  rows: {\r\n *    1: {\r\n *      height: 50,\r\n *      style: 1,\r\n *      cells: {\r\n *        1: {\r\n *          style: 2,\r\n *          type: 'string',\r\n *          text: '',\r\n *          value: '', // cal result\r\n *        }\r\n *      }\r\n *    },\r\n *    ...\r\n *  },\r\n *  cols: {\r\n *    2: { width: 100, style: 1 }\r\n *  }\r\n * }\r\n */\r\nexport const defaultSize = {\r\n  width: eventEL.document.documentElement.clientHeight,\r\n  height: eventEL.document.documentElement.clientWidth,\r\n};\r\nconst defaultSettings = {\r\n  mode: \"edit\", // edit | read\r\n  view: {\r\n    height: () => defaultSize.height,\r\n    width: () => defaultSize.width,\r\n  },\r\n  showGrid: true,\r\n  showToolbar: true,\r\n  showContextmenu: true,\r\n  showBottomBar: true,\r\n  row: {\r\n    len: 100,\r\n    height: 25,\r\n  },\r\n  col: {\r\n    len: 26,\r\n    width: 100,\r\n    indexWidth: 60,\r\n    minWidth: 60,\r\n  },\r\n  style: {\r\n    bgcolor: \"#ffffff\",\r\n    align: \"left\",\r\n    valign: \"middle\",\r\n    textwrap: false,\r\n    strike: false,\r\n    underline: false,\r\n    color: \"#0a0a0a\",\r\n    font: {\r\n      name: \"Arial\",\r\n      size: 10,\r\n      bold: false,\r\n      italic: false,\r\n    },\r\n    format: \"normal\",\r\n  },\r\n};\r\n\r\nconst toolbarHeight = 41;\r\nconst bottombarHeight = 41;\r\n\r\n// src: cellRange\r\n// dst: cellRange\r\nfunction canPaste(src, dst, error = () => {}) {\r\n  const { merges } = this;\r\n  const cellRange = dst.clone();\r\n  const [srn, scn] = src.size();\r\n  const [drn, dcn] = dst.size();\r\n  if (srn > drn) {\r\n    cellRange.eri = dst.sri + srn - 1;\r\n  }\r\n  if (scn > dcn) {\r\n    cellRange.eci = dst.sci + scn - 1;\r\n  }\r\n  if (merges.intersects(cellRange)) {\r\n    error(t(\"error.pasteForMergedCell\"));\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\r\n  const { rows, merges } = this;\r\n  // delete dest merge\r\n  if (what === \"all\" || what === \"format\") {\r\n    rows.deleteCells(dstCellRange, what);\r\n    merges.deleteWithin(dstCellRange);\r\n  }\r\n  rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\r\n    if (cell && cell.merge) {\r\n      // console.log('cell:', ri, ci, cell);\r\n      const [rn, cn] = cell.merge;\r\n      if (rn <= 0 && cn <= 0) return;\r\n      merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\r\n    }\r\n  });\r\n}\r\n\r\nfunction cutPaste(srcCellRange, dstCellRange) {\r\n  const { clipboard, rows, merges } = this;\r\n  rows.cutPaste(srcCellRange, dstCellRange);\r\n  merges.move(\r\n    srcCellRange,\r\n    dstCellRange.sri - srcCellRange.sri,\r\n    dstCellRange.sci - srcCellRange.sci\r\n  );\r\n  clipboard.clear();\r\n}\r\n\r\n// bss: { top, bottom, left, right }\r\nfunction setStyleBorder(ri, ci, bss) {\r\n  const { styles, rows } = this;\r\n  const cell = rows.getCellOrNew(ri, ci);\r\n  let cstyle = {};\r\n  if (cell.style !== undefined) {\r\n    cstyle = helper.cloneDeep(styles[cell.style]);\r\n  }\r\n  cstyle = helper.merge(cstyle, { border: bss });\r\n  cell.style = this.addStyle(cstyle);\r\n}\r\n\r\nfunction setStyleBorders({ mode, style, color }) {\r\n  const { styles, selector, rows } = this;\r\n  const { sri, sci, eri, eci } = selector.range;\r\n  const multiple = !this.isSingleSelected();\r\n  if (!multiple) {\r\n    if (mode === \"inside\" || mode === \"horizontal\" || mode === \"vertical\") {\r\n      return;\r\n    }\r\n  }\r\n  if (mode === \"outside\" && !multiple) {\r\n    setStyleBorder.call(this, sri, sci, {\r\n      top: [style, color],\r\n      bottom: [style, color],\r\n      left: [style, color],\r\n      right: [style, color],\r\n    });\r\n  } else if (mode === \"none\") {\r\n    selector.range.each((ri, ci) => {\r\n      const cell = rows.getCell(ri, ci);\r\n      if (cell && cell.style !== undefined) {\r\n        const ns = helper.cloneDeep(styles[cell.style]);\r\n        delete ns.border;\r\n        // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\r\n        //   if (ns[prop]) delete ns[prop];\r\n        // });\r\n        cell.style = this.addStyle(ns);\r\n      }\r\n    });\r\n  } else if (\r\n    mode === \"all\" ||\r\n    mode === \"inside\" ||\r\n    mode === \"outside\" ||\r\n    mode === \"horizontal\" ||\r\n    mode === \"vertical\"\r\n  ) {\r\n    const merges = [];\r\n    for (let ri = sri; ri <= eri; ri += 1) {\r\n      for (let ci = sci; ci <= eci; ci += 1) {\r\n        // jump merges -- start\r\n        const mergeIndexes = [];\r\n        for (let ii = 0; ii < merges.length; ii += 1) {\r\n          const [mri, mci, rn, cn] = merges[ii];\r\n          if (ri === mri + rn + 1) mergeIndexes.push(ii);\r\n          if (mri <= ri && ri <= mri + rn) {\r\n            if (ci === mci) {\r\n              ci += cn + 1;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        mergeIndexes.forEach((it) => merges.splice(it, 1));\r\n        if (ci > eci) break;\r\n        // jump merges -- end\r\n        const cell = rows.getCell(ri, ci);\r\n        let [rn, cn] = [0, 0];\r\n        if (cell && cell.merge) {\r\n          [rn, cn] = cell.merge;\r\n          merges.push([ri, ci, rn, cn]);\r\n        }\r\n        const mrl = rn > 0 && ri + rn === eri;\r\n        const mcl = cn > 0 && ci + cn === eci;\r\n        let bss = {};\r\n        if (mode === \"all\") {\r\n          bss = {\r\n            bottom: [style, color],\r\n            top: [style, color],\r\n            left: [style, color],\r\n            right: [style, color],\r\n          };\r\n        } else if (mode === \"inside\") {\r\n          if (!mcl && ci < eci) bss.right = [style, color];\r\n          if (!mrl && ri < eri) bss.bottom = [style, color];\r\n        } else if (mode === \"horizontal\") {\r\n          if (!mrl && ri < eri) bss.bottom = [style, color];\r\n        } else if (mode === \"vertical\") {\r\n          if (!mcl && ci < eci) bss.right = [style, color];\r\n        } else if (mode === \"outside\" && multiple) {\r\n          if (sri === ri) bss.top = [style, color];\r\n          if (mrl || eri === ri) bss.bottom = [style, color];\r\n          if (sci === ci) bss.left = [style, color];\r\n          if (mcl || eci === ci) bss.right = [style, color];\r\n        }\r\n        if (Object.keys(bss).length > 0) {\r\n          setStyleBorder.call(this, ri, ci, bss);\r\n        }\r\n        ci += cn;\r\n      }\r\n    }\r\n  } else if (mode === \"top\" || mode === \"bottom\") {\r\n    for (let ci = sci; ci <= eci; ci += 1) {\r\n      if (mode === \"top\") {\r\n        setStyleBorder.call(this, sri, ci, { top: [style, color] });\r\n        ci += rows.getCellMerge(sri, ci)[1];\r\n      }\r\n      if (mode === \"bottom\") {\r\n        setStyleBorder.call(this, eri, ci, { bottom: [style, color] });\r\n        ci += rows.getCellMerge(eri, ci)[1];\r\n      }\r\n    }\r\n  } else if (mode === \"left\" || mode === \"right\") {\r\n    for (let ri = sri; ri <= eri; ri += 1) {\r\n      if (mode === \"left\") {\r\n        setStyleBorder.call(this, ri, sci, { left: [style, color] });\r\n        ri += rows.getCellMerge(ri, sci)[0];\r\n      }\r\n      if (mode === \"right\") {\r\n        setStyleBorder.call(this, ri, eci, { right: [style, color] });\r\n        ri += rows.getCellMerge(ri, eci)[0];\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction getCellRowByY(y, scrollOffsety) {\r\n  const { rows } = this;\r\n  const fsh = this.freezeTotalHeight();\r\n  // console.log('y:', y, ', fsh:', fsh);\r\n  let inits = rows.height;\r\n  if (fsh + rows.height < y) inits -= scrollOffsety;\r\n\r\n  // handle ri in autofilter\r\n  const frset = this.exceptRowSet;\r\n\r\n  let ri = 0;\r\n  let top = inits;\r\n  let { height } = rows;\r\n  for (; ri < rows.len; ri += 1) {\r\n    if (top > y) break;\r\n    if (!frset.has(ri)) {\r\n      height = rows.getHeight(ri);\r\n      top += height;\r\n    }\r\n  }\r\n  top -= height;\r\n  // console.log('ri:', ri, ', top:', top, ', height:', height);\r\n\r\n  if (top <= 0) {\r\n    return { ri: -1, top: 0, height };\r\n  }\r\n\r\n  return { ri: ri - 1, top, height };\r\n}\r\n\r\nfunction getCellColByX(x, scrollOffsetx) {\r\n  const { cols } = this;\r\n  const fsw = this.freezeTotalWidth();\r\n  let inits = cols.indexWidth;\r\n  if (fsw + cols.indexWidth < x) inits -= scrollOffsetx;\r\n  const [ci, left, width] = helper.rangeReduceIf(\r\n    0,\r\n    cols.len,\r\n    inits,\r\n    cols.indexWidth,\r\n    x,\r\n    (i) => cols.getWidth(i)\r\n  );\r\n  if (left <= 0) {\r\n    return { ci: -1, left: 0, width: cols.indexWidth };\r\n  }\r\n  return { ci: ci - 1, left, width };\r\n}\r\n\r\nexport default class DataProxy {\r\n  constructor(name, settings) {\r\n    this.settings = helper.merge(defaultSettings, settings || {});\r\n    // save data begin\r\n    this.name = name || \"sheet\";\r\n    this.freeze = [0, 0];\r\n    this.styles = []; // Array<Style>\r\n    this.merges = new Merges(); // [CellRange, ...]\r\n    this.rows = new Rows(this.settings.row);\r\n    this.cols = new Cols(this.settings.col);\r\n    this.validations = new Validations();\r\n    this.hyperlinks = {};\r\n    this.comments = {};\r\n    // save data end\r\n\r\n    // don't save object\r\n    this.selector = new Selector();\r\n    this.scroll = new Scroll();\r\n    this.history = new History();\r\n    this.clipboard = new Clipboard();\r\n    this.autoFilter = new AutoFilter();\r\n    this.change = () => {};\r\n    this.exceptRowSet = new Set();\r\n    this.sortedRowMap = new Map();\r\n    this.unsortedRowMap = new Map();\r\n  }\r\n\r\n  addValidation(mode, ref, validator) {\r\n    // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\r\n    this.changeData(() => {\r\n      this.validations.add(mode, ref, validator);\r\n    });\r\n  }\r\n\r\n  removeValidation() {\r\n    const { range } = this.selector;\r\n    this.changeData(() => {\r\n      this.validations.remove(range);\r\n    });\r\n  }\r\n\r\n  getSelectedValidator() {\r\n    const { ri, ci } = this.selector;\r\n    const v = this.validations.get(ri, ci);\r\n    return v ? v.validator : null;\r\n  }\r\n\r\n  getSelectedValidation() {\r\n    const { ri, ci, range } = this.selector;\r\n    const v = this.validations.get(ri, ci);\r\n    const ret = { ref: range.toString() };\r\n    if (v !== null) {\r\n      ret.mode = v.mode;\r\n      ret.validator = v.validator;\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  canUndo() {\r\n    return this.history.canUndo();\r\n  }\r\n\r\n  canRedo() {\r\n    return this.history.canRedo();\r\n  }\r\n\r\n  undo() {\r\n    this.history.undo(this.getData(), (d) => {\r\n      this.setData(d);\r\n    });\r\n  }\r\n\r\n  redo() {\r\n    this.history.redo(this.getData(), (d) => {\r\n      this.setData(d);\r\n    });\r\n  }\r\n\r\n  copy() {\r\n    this.clipboard.copy(this.selector.range);\r\n  }\r\n\r\n  copyToSystemClipboard(evt) {\r\n    let copyText = [];\r\n    const { sri, eri, sci, eci } = this.selector.range;\r\n\r\n    for (let ri = sri; ri <= eri; ri += 1) {\r\n      const row = [];\r\n      for (let ci = sci; ci <= eci; ci += 1) {\r\n        const cell = this.getCell(ri, ci);\r\n        row.push((cell && cell.text) || \"\");\r\n      }\r\n      copyText.push(row);\r\n    }\r\n\r\n    // Adding \\n and why not adding \\r\\n is to support online office and client MS office and WPS\r\n    copyText = copyText.map((row) => row.join(\"\\t\")).join(\"\\n\");\r\n\r\n    // why used this\r\n    // cuz http protocol will be blocked request clipboard by browser\r\n    if (evt) {\r\n      evt.clipboardData.clearData();\r\n      evt.clipboardData.setData(\"text/plain\", copyText);\r\n      evt.preventDefault();\r\n    }\r\n\r\n    // this need https protocol\r\n    /* global navigator */\r\n    if (eventEL.window.navigator.clipboard) {\r\n      eventEL.window.navigator.clipboard.writeText(copyText).then(\r\n        () => {},\r\n        (err) => {\r\n          console.log(\r\n            \"text copy to the system clipboard error  \",\r\n            copyText,\r\n            err\r\n          );\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  cut() {\r\n    this.clipboard.cut(this.selector.range);\r\n  }\r\n\r\n  // what: all | text | format\r\n  paste(what = \"all\", error = () => {}) {\r\n    // console.log('sIndexes:', sIndexes);\r\n    const { clipboard, selector } = this;\r\n    if (clipboard.isClear()) return false;\r\n    if (!canPaste.call(this, clipboard.range, selector.range, error))\r\n      return false;\r\n\r\n    this.changeData(() => {\r\n      if (clipboard.isCopy()) {\r\n        copyPaste.call(this, clipboard.range, selector.range, what);\r\n      } else if (clipboard.isCut()) {\r\n        cutPaste.call(this, clipboard.range, selector.range);\r\n      }\r\n    });\r\n    return true;\r\n  }\r\n\r\n  pasteFromSystemClipboard(resetSheet, eventTrigger) {\r\n    const { selector } = this;\r\n    eventEL.window.navigator.clipboard.readText().then((content) => {\r\n      const contentToPaste = this.parseClipboardContent(content);\r\n      let startRow = selector.ri;\r\n      contentToPaste.forEach((row) => {\r\n        let startColumn = selector.ci;\r\n        row.forEach((cellContent) => {\r\n          this.setCellText(startRow, startColumn, cellContent, \"input\");\r\n          startColumn += 1;\r\n        });\r\n        startRow += 1;\r\n      });\r\n      resetSheet();\r\n      eventTrigger(this.rows.getData());\r\n    });\r\n  }\r\n\r\n  parseClipboardContent(clipboardContent) {\r\n    const parsedData = [];\r\n\r\n    // first we need to figure out how many rows we need to paste\r\n    const rows = clipboardContent.split(\"\\n\");\r\n\r\n    // for each row parse cell data\r\n    let i = 0;\r\n    rows.forEach((row) => {\r\n      parsedData[i] = row.split(\"\\t\");\r\n      i += 1;\r\n    });\r\n    return parsedData;\r\n  }\r\n\r\n  pasteFromText(txt) {\r\n    let lines = [];\r\n\r\n    if (/\\r\\n/.test(txt))\r\n      lines = txt.split(\"\\r\\n\").map((it) => it.replace(/\"/g, \"\").split(\"\\t\"));\r\n    else lines = txt.split(\"\\n\").map((it) => it.replace(/\"/g, \"\").split(\"\\t\"));\r\n\r\n    if (lines.length) {\r\n      const { rows, selector } = this;\r\n\r\n      this.changeData(() => {\r\n        rows.paste(lines, selector.range);\r\n      });\r\n    }\r\n  }\r\n\r\n  autofill(cellRange, what, error = () => {}) {\r\n    const srcRange = this.selector.range;\r\n    if (!canPaste.call(this, srcRange, cellRange, error)) return false;\r\n    this.changeData(() => {\r\n      copyPaste.call(this, srcRange, cellRange, what, true);\r\n    });\r\n    return true;\r\n  }\r\n\r\n  clearClipboard() {\r\n    this.clipboard.clear();\r\n  }\r\n\r\n  calSelectedRangeByEnd(ri, ci) {\r\n    const { selector, rows, cols, merges } = this;\r\n    let { sri, sci, eri, eci } = selector.range;\r\n    const cri = selector.ri;\r\n    const cci = selector.ci;\r\n    let [nri, nci] = [ri, ci];\r\n    if (ri < 0) nri = rows.len - 1;\r\n    if (ci < 0) nci = cols.len - 1;\r\n    if (nri > cri) [sri, eri] = [cri, nri];\r\n    else [sri, eri] = [nri, cri];\r\n    if (nci > cci) [sci, eci] = [cci, nci];\r\n    else [sci, eci] = [nci, cci];\r\n    selector.range = merges.union(new CellRange(sri, sci, eri, eci));\r\n    selector.range = merges.union(selector.range);\r\n    // console.log('selector.range:', selector.range);\r\n    return selector.range;\r\n  }\r\n\r\n  calSelectedRangeByStart(ri, ci) {\r\n    const { selector, rows, cols, merges } = this;\r\n    let cellRange = merges.getFirstIncludes(ri, ci);\r\n    // console.log('cellRange:', cellRange, ri, ci, merges);\r\n    if (cellRange === null) {\r\n      cellRange = new CellRange(ri, ci, ri, ci);\r\n      if (ri === -1) {\r\n        cellRange.sri = 0;\r\n        cellRange.eri = rows.len - 1;\r\n      }\r\n      if (ci === -1) {\r\n        cellRange.sci = 0;\r\n        cellRange.eci = cols.len - 1;\r\n      }\r\n    }\r\n    selector.range = cellRange;\r\n    return cellRange;\r\n  }\r\n\r\n  setSelectedCellAttr(property, value) {\r\n    this.changeData(() => {\r\n      const { selector, styles, rows } = this;\r\n      if (property === \"merge\") {\r\n        if (value) this.merge();\r\n        else this.unmerge();\r\n      } else if (property === \"border\") {\r\n        setStyleBorders.call(this, value);\r\n      } else if (property === \"formula\") {\r\n        // console.log('>>>', selector.multiple());\r\n        const { ri, ci, range } = selector;\r\n        if (selector.multiple()) {\r\n          const [rn, cn] = selector.size();\r\n          const { sri, sci, eri, eci } = range;\r\n          if (rn > 1) {\r\n            for (let i = sci; i <= eci; i += 1) {\r\n              const cell = rows.getCellOrNew(eri + 1, i);\r\n              cell.text = `=${value}(${xy2expr(i, sri)}:${xy2expr(i, eri)})`;\r\n            }\r\n          } else if (cn > 1) {\r\n            const cell = rows.getCellOrNew(ri, eci + 1);\r\n            cell.text = `=${value}(${xy2expr(sci, ri)}:${xy2expr(eci, ri)})`;\r\n          }\r\n        } else {\r\n          const cell = rows.getCellOrNew(ri, ci);\r\n          cell.text = `=${value}()`;\r\n        }\r\n      } else {\r\n        selector.range.each((ri, ci) => {\r\n          const cell = rows.getCellOrNew(ri, ci);\r\n          let cstyle = {};\r\n          if (cell.style !== undefined) {\r\n            cstyle = helper.cloneDeep(styles[cell.style]);\r\n          }\r\n          if (property === \"format\") {\r\n            cstyle.format = value;\r\n            cell.style = this.addStyle(cstyle);\r\n          } else if (\r\n            property === \"font-bold\" ||\r\n            property === \"font-italic\" ||\r\n            property === \"font-name\" ||\r\n            property === \"font-size\"\r\n          ) {\r\n            const nfont = {};\r\n            nfont[property.split(\"-\")[1]] = value;\r\n            cstyle.font = Object.assign(cstyle.font || {}, nfont);\r\n            cell.style = this.addStyle(cstyle);\r\n          } else if (\r\n            property === \"strike\" ||\r\n            property === \"textwrap\" ||\r\n            property === \"underline\" ||\r\n            property === \"align\" ||\r\n            property === \"valign\" ||\r\n            property === \"color\" ||\r\n            property === \"bgcolor\"\r\n          ) {\r\n            cstyle[property] = value;\r\n            cell.style = this.addStyle(cstyle);\r\n          } else {\r\n            cell[property] = value;\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  // state: input | finished\r\n  setSelectedCellText(text, state = \"input\") {\r\n    const { autoFilter, selector, rows } = this;\r\n    const { ri, ci } = selector;\r\n    let nri = ri;\r\n    if (this.unsortedRowMap.has(ri)) {\r\n      nri = this.unsortedRowMap.get(ri);\r\n    }\r\n    const oldCell = rows.getCell(nri, ci);\r\n    const oldText = oldCell ? oldCell.text : \"\";\r\n    this.setCellText(nri, ci, text, state);\r\n    // replace filter.value\r\n    if (autoFilter.active()) {\r\n      const filter = autoFilter.getFilter(ci);\r\n      if (filter) {\r\n        const vIndex = filter.value.findIndex((v) => v === oldText);\r\n        if (vIndex >= 0) {\r\n          filter.value.splice(vIndex, 1, text);\r\n        }\r\n        // console.log('filter:', filter, oldCell);\r\n      }\r\n    }\r\n    // this.resetAutoFilter();\r\n  }\r\n\r\n  getSelectedCell() {\r\n    const { ri, ci } = this.selector;\r\n    let nri = ri;\r\n    if (this.unsortedRowMap.has(ri)) {\r\n      nri = this.unsortedRowMap.get(ri);\r\n    }\r\n    return this.rows.getCell(nri, ci);\r\n  }\r\n\r\n  xyInSelectedRect(x, y) {\r\n    const { left, top, width, height } = this.getSelectedRect();\r\n    const x1 = x - this.cols.indexWidth;\r\n    const y1 = y - this.rows.height;\r\n    // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\r\n    return x1 > left && x1 < left + width && y1 > top && y1 < top + height;\r\n  }\r\n\r\n  getSelectedRect() {\r\n    return this.getRect(this.selector.range);\r\n  }\r\n\r\n  getClipboardRect() {\r\n    const { clipboard } = this;\r\n    if (!clipboard.isClear()) {\r\n      return this.getRect(clipboard.range);\r\n    }\r\n    return { left: -100, top: -100 };\r\n  }\r\n\r\n  getRect(cellRange) {\r\n    const { scroll, rows, cols, exceptRowSet } = this;\r\n    const { sri, sci, eri, eci } = cellRange;\r\n    // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\r\n    // no selector\r\n    if (sri < 0 && sci < 0) {\r\n      return {\r\n        left: 0,\r\n        l: 0,\r\n        top: 0,\r\n        t: 0,\r\n        scroll,\r\n      };\r\n    }\r\n    const left = cols.sumWidth(0, sci);\r\n    const top = rows.sumHeight(0, sri, exceptRowSet);\r\n    const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\r\n    const width = cols.sumWidth(sci, eci + 1);\r\n    // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\r\n    let left0 = left - scroll.x;\r\n    let top0 = top - scroll.y;\r\n    const fsh = this.freezeTotalHeight();\r\n    const fsw = this.freezeTotalWidth();\r\n    if (fsw > 0 && fsw > left) {\r\n      left0 = left;\r\n    }\r\n    if (fsh > 0 && fsh > top) {\r\n      top0 = top;\r\n    }\r\n    return {\r\n      l: left,\r\n      t: top,\r\n      left: left0,\r\n      top: top0,\r\n      height,\r\n      width,\r\n      scroll,\r\n    };\r\n  }\r\n\r\n  getCellRectByXY(x, y) {\r\n    const { scroll, merges, rows, cols } = this;\r\n    let { ri, top, height } = getCellRowByY.call(this, y, scroll.y);\r\n    let { ci, left, width } = getCellColByX.call(this, x, scroll.x);\r\n    if (ci === -1) {\r\n      width = cols.totalWidth();\r\n    }\r\n    if (ri === -1) {\r\n      height = rows.totalHeight();\r\n    }\r\n    if (ri >= 0 || ci >= 0) {\r\n      const merge = merges.getFirstIncludes(ri, ci);\r\n      if (merge) {\r\n        ri = merge.sri;\r\n        ci = merge.sci;\r\n        ({ left, top, width, height } = this.cellRect(ri, ci));\r\n      }\r\n    }\r\n    return {\r\n      ri,\r\n      ci,\r\n      left,\r\n      top,\r\n      width,\r\n      height,\r\n    };\r\n  }\r\n\r\n  isSingleSelected() {\r\n    const { sri, sci, eri, eci } = this.selector.range;\r\n    const cell = this.getCell(sri, sci);\r\n    if (cell && cell.merge) {\r\n      const [rn, cn] = cell.merge;\r\n      if (sri + rn === eri && sci + cn === eci) return true;\r\n    }\r\n    return !this.selector.multiple();\r\n  }\r\n\r\n  canUnmerge() {\r\n    const { sri, sci, eri, eci } = this.selector.range;\r\n    const cell = this.getCell(sri, sci);\r\n    if (cell && cell.merge) {\r\n      const [rn, cn] = cell.merge;\r\n      if (sri + rn === eri && sci + cn === eci) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  merge() {\r\n    const { selector, rows } = this;\r\n    if (this.isSingleSelected()) return;\r\n    const [rn, cn] = selector.size();\r\n    // console.log('merge:', rn, cn);\r\n    if (rn > 1 || cn > 1) {\r\n      const { sri, sci } = selector.range;\r\n      this.changeData(() => {\r\n        const cell = rows.getCellOrNew(sri, sci);\r\n        cell.merge = [rn - 1, cn - 1];\r\n        this.merges.add(selector.range);\r\n        // delete merge cells\r\n        this.rows.deleteCells(selector.range);\r\n        // console.log('cell:', cell, this.d);\r\n        this.rows.setCell(sri, sci, cell);\r\n      });\r\n    }\r\n  }\r\n\r\n  unmerge() {\r\n    const { selector } = this;\r\n    if (!this.isSingleSelected()) return;\r\n    const { sri, sci } = selector.range;\r\n    this.changeData(() => {\r\n      this.rows.deleteCell(sri, sci, \"merge\");\r\n      this.merges.deleteWithin(selector.range);\r\n    });\r\n  }\r\n\r\n  canAutofilter() {\r\n    return !this.autoFilter.active();\r\n  }\r\n\r\n  autofilter() {\r\n    const { autoFilter, selector } = this;\r\n    this.changeData(() => {\r\n      if (autoFilter.active()) {\r\n        autoFilter.clear();\r\n        this.exceptRowSet = new Set();\r\n        this.sortedRowMap = new Map();\r\n        this.unsortedRowMap = new Map();\r\n      } else {\r\n        autoFilter.ref = selector.range.toString();\r\n      }\r\n    });\r\n  }\r\n\r\n  setAutoFilter(ci, order, operator, value) {\r\n    const { autoFilter } = this;\r\n    autoFilter.addFilter(ci, operator, value);\r\n    autoFilter.setSort(ci, order);\r\n    this.resetAutoFilter();\r\n  }\r\n\r\n  resetAutoFilter() {\r\n    const { autoFilter, rows } = this;\r\n    if (!autoFilter.active()) return;\r\n    const { sort } = autoFilter;\r\n    const { rset, fset } = autoFilter.filteredRows((r, c) =>\r\n      rows.getCell(r, c)\r\n    );\r\n    const fary = Array.from(fset);\r\n    const oldAry = Array.from(fset);\r\n    if (sort) {\r\n      fary.sort((a, b) => {\r\n        if (sort.order === \"asc\") return a - b;\r\n        if (sort.order === \"desc\") return b - a;\r\n        return 0;\r\n      });\r\n    }\r\n    this.exceptRowSet = rset;\r\n    this.sortedRowMap = new Map();\r\n    this.unsortedRowMap = new Map();\r\n    fary.forEach((it, index) => {\r\n      this.sortedRowMap.set(oldAry[index], it);\r\n      this.unsortedRowMap.set(it, oldAry[index]);\r\n    });\r\n  }\r\n\r\n  deleteCell(what = \"all\") {\r\n    const { selector } = this;\r\n    this.changeData(() => {\r\n      this.rows.deleteCells(selector.range, what);\r\n      if (what === \"all\" || what === \"format\") {\r\n        this.merges.deleteWithin(selector.range);\r\n      }\r\n    });\r\n  }\r\n\r\n  // type: row | column\r\n  insert(type, n = 1) {\r\n    this.changeData(() => {\r\n      const { sri, sci } = this.selector.range;\r\n      const { rows, merges, cols } = this;\r\n      let si = sri;\r\n      if (type === \"row\") {\r\n        rows.insert(sri, n);\r\n      } else if (type === \"column\") {\r\n        rows.insertColumn(sci, n);\r\n        si = sci;\r\n        cols.len += 1;\r\n      }\r\n      merges.shift(type, si, n, (ri, ci, rn, cn) => {\r\n        const cell = rows.getCell(ri, ci);\r\n        cell.merge[0] += rn;\r\n        cell.merge[1] += cn;\r\n      });\r\n    });\r\n  }\r\n\r\n  // type: row | column\r\n  delete(type) {\r\n    this.changeData(() => {\r\n      const { rows, merges, selector, cols } = this;\r\n      const { range } = selector;\r\n      const { sri, sci, eri, eci } = selector.range;\r\n      const [rsize, csize] = selector.range.size();\r\n      let si = sri;\r\n      let size = rsize;\r\n      if (type === \"row\") {\r\n        rows.delete(sri, eri);\r\n      } else if (type === \"column\") {\r\n        rows.deleteColumn(sci, eci);\r\n        si = range.sci;\r\n        size = csize;\r\n        cols.len -= eci - sci + 1;\r\n      }\r\n      // console.log('type:', type, ', si:', si, ', size:', size);\r\n      merges.shift(type, si, -size, (ri, ci, rn, cn) => {\r\n        // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\r\n        const cell = rows.getCell(ri, ci);\r\n        cell.merge[0] += rn;\r\n        cell.merge[1] += cn;\r\n        if (cell.merge[0] === 0 && cell.merge[1] === 0) {\r\n          delete cell.merge;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  scrollx(x, cb) {\r\n    const { scroll, freeze, cols } = this;\r\n    const [, fci] = freeze;\r\n    const [ci, left, width] = helper.rangeReduceIf(\r\n      fci,\r\n      cols.len,\r\n      0,\r\n      0,\r\n      x,\r\n      (i) => cols.getWidth(i)\r\n    );\r\n    // console.log('fci:', fci, ', ci:', ci);\r\n    let x1 = left;\r\n    if (x > 0) x1 += width;\r\n    if (scroll.x !== x1) {\r\n      scroll.ci = x > 0 ? ci : 0;\r\n      scroll.x = x1;\r\n      cb();\r\n    }\r\n  }\r\n\r\n  scrolly(y, cb) {\r\n    const { scroll, freeze, rows } = this;\r\n    const [fri] = freeze;\r\n    const [ri, top, height] = helper.rangeReduceIf(\r\n      fri,\r\n      rows.len,\r\n      0,\r\n      0,\r\n      y,\r\n      (i) => rows.getHeight(i)\r\n    );\r\n    let y1 = top;\r\n    if (y > 0) y1 += height;\r\n    // console.log('ri:', ri, ' ,y:', y1);\r\n    if (scroll.y !== y1) {\r\n      scroll.ri = y > 0 ? ri : 0;\r\n      scroll.y = y1;\r\n      cb();\r\n    }\r\n  }\r\n\r\n  cellRect(ri, ci) {\r\n    const { rows, cols } = this;\r\n    const left = cols.sumWidth(0, ci);\r\n    const top = rows.sumHeight(0, ri);\r\n    const cell = rows.getCell(ri, ci);\r\n    let width = cols.getWidth(ci);\r\n    let height = rows.getHeight(ri);\r\n    if (cell !== null) {\r\n      if (cell.merge) {\r\n        const [rn, cn] = cell.merge;\r\n        // console.log('cell.merge:', cell.merge);\r\n        if (rn > 0) {\r\n          for (let i = 1; i <= rn; i += 1) {\r\n            height += rows.getHeight(ri + i);\r\n          }\r\n        }\r\n        if (cn > 0) {\r\n          for (let i = 1; i <= cn; i += 1) {\r\n            width += cols.getWidth(ci + i);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // console.log('data:', this.d);\r\n    return {\r\n      left,\r\n      top,\r\n      width,\r\n      height,\r\n      cell,\r\n    };\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    return this.rows.getCell(ri, ci);\r\n  }\r\n\r\n  getCellTextOrDefault(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    return cell && cell.text ? cell.text : \"\";\r\n  }\r\n\r\n  getCellStyle(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    if (cell && cell.style !== undefined) {\r\n      return this.styles[cell.style];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getCellStyleOrDefault(ri, ci) {\r\n    const { styles, rows } = this;\r\n    const cell = rows.getCell(ri, ci);\r\n    const cellStyle =\r\n      cell && cell.style !== undefined ? styles[cell.style] : {};\r\n    return helper.merge(this.defaultStyle(), cellStyle);\r\n  }\r\n\r\n  getSelectedCellStyle() {\r\n    const { ri, ci } = this.selector;\r\n    return this.getCellStyleOrDefault(ri, ci);\r\n  }\r\n\r\n  // state: input | finished\r\n  setCellText(ri, ci, text, state) {\r\n    const { rows, history, validations } = this;\r\n    if (state === \"finished\") {\r\n      rows.setCellText(ri, ci, \"\");\r\n      history.add(this.getData());\r\n      rows.setCellText(ri, ci, text);\r\n    } else {\r\n      rows.setCellText(ri, ci, text);\r\n      this.change(this.getData());\r\n    }\r\n    // validator\r\n    validations.validate(ri, ci, text);\r\n  }\r\n\r\n  freezeIsActive() {\r\n    const [ri, ci] = this.freeze;\r\n    return ri > 0 || ci > 0;\r\n  }\r\n\r\n  setFreeze(ri, ci) {\r\n    this.changeData(() => {\r\n      this.freeze = [ri, ci];\r\n    });\r\n  }\r\n\r\n  freezeTotalWidth() {\r\n    return this.cols.sumWidth(0, this.freeze[1]);\r\n  }\r\n\r\n  freezeTotalHeight() {\r\n    return this.rows.sumHeight(0, this.freeze[0]);\r\n  }\r\n\r\n  setRowHeight(ri, height) {\r\n    this.changeData(() => {\r\n      this.rows.setHeight(ri, height);\r\n    });\r\n  }\r\n\r\n  setColWidth(ci, width) {\r\n    this.changeData(() => {\r\n      this.cols.setWidth(ci, width);\r\n    });\r\n  }\r\n\r\n  viewHeight() {\r\n    const { view, showToolbar, showBottomBar } = this.settings;\r\n    let h = view.height();\r\n    if (showBottomBar) {\r\n      h -= bottombarHeight;\r\n    }\r\n    if (showToolbar) {\r\n      h -= toolbarHeight;\r\n    }\r\n    return h;\r\n  }\r\n\r\n  viewWidth() {\r\n    return this.settings.view.width();\r\n  }\r\n\r\n  freezeViewRange() {\r\n    const [ri, ci] = this.freeze;\r\n    return new CellRange(\r\n      0,\r\n      0,\r\n      ri - 1,\r\n      ci - 1,\r\n      this.freezeTotalWidth(),\r\n      this.freezeTotalHeight()\r\n    );\r\n  }\r\n\r\n  contentRange() {\r\n    const { rows, cols } = this;\r\n    const [ri, ci] = rows.maxCell();\r\n    const h = rows.sumHeight(0, ri + 1);\r\n    const w = cols.sumWidth(0, ci + 1);\r\n    return new CellRange(0, 0, ri, ci, w, h);\r\n  }\r\n\r\n  exceptRowTotalHeight(sri, eri) {\r\n    const { exceptRowSet, rows } = this;\r\n    const exceptRows = Array.from(exceptRowSet);\r\n    let exceptRowTH = 0;\r\n    exceptRows.forEach((ri) => {\r\n      if (ri < sri || ri > eri) {\r\n        const height = rows.getHeight(ri);\r\n        exceptRowTH += height;\r\n      }\r\n    });\r\n    return exceptRowTH;\r\n  }\r\n\r\n  viewRange() {\r\n    const { scroll, rows, cols, freeze, exceptRowSet } = this;\r\n    // console.log('scroll:', scroll, ', freeze:', freeze)\r\n    let { ri, ci } = scroll;\r\n    if (ri <= 0) [ri] = freeze;\r\n    if (ci <= 0) [, ci] = freeze;\r\n\r\n    let [x, y] = [0, 0];\r\n    let [eri, eci] = [rows.len, cols.len];\r\n    for (let i = ri; i < rows.len; i += 1) {\r\n      if (!exceptRowSet.has(i)) {\r\n        y += rows.getHeight(i);\r\n        eri = i;\r\n      }\r\n      if (y > this.viewHeight()) break;\r\n    }\r\n    for (let j = ci; j < cols.len; j += 1) {\r\n      x += cols.getWidth(j);\r\n      eci = j;\r\n      if (x > this.viewWidth()) break;\r\n    }\r\n    // console.log(ri, ci, eri, eci, x, y);\r\n    return new CellRange(ri, ci, eri, eci, x, y);\r\n  }\r\n\r\n  eachMergesInView(viewRange, cb) {\r\n    this.merges.filterIntersects(viewRange).forEach((it) => cb(it));\r\n  }\r\n\r\n  hideRowsOrCols() {\r\n    const { rows, cols, selector } = this;\r\n    const [rlen, clen] = selector.size();\r\n    const { sri, sci, eri, eci } = selector.range;\r\n    if (rlen === rows.len) {\r\n      for (let ci = sci; ci <= eci; ci += 1) {\r\n        cols.setHide(ci, true);\r\n      }\r\n    } else if (clen === cols.len) {\r\n      for (let ri = sri; ri <= eri; ri += 1) {\r\n        rows.setHide(ri, true);\r\n      }\r\n    }\r\n  }\r\n\r\n  // type: row | col\r\n  // index row-index | col-index\r\n  unhideRowsOrCols(type, index) {\r\n    this[`${type}s`].unhide(index);\r\n  }\r\n\r\n  rowEach(min, max, cb) {\r\n    let y = 0;\r\n    const { rows } = this;\r\n    const frset = this.exceptRowSet;\r\n    const frary = [...frset];\r\n    let offset = 0;\r\n    for (let i = 0; i < frary.length; i += 1) {\r\n      if (frary[i] < min) {\r\n        offset += 1;\r\n      }\r\n    }\r\n    // console.log('min:', min, ', max:', max, ', scroll:', scroll);\r\n    for (let i = min + offset; i <= max + offset; i += 1) {\r\n      if (frset.has(i)) {\r\n        offset += 1;\r\n      } else {\r\n        const rowHeight = rows.getHeight(i);\r\n        if (rowHeight > 0) {\r\n          cb(i, y, rowHeight);\r\n          y += rowHeight;\r\n          if (y > this.viewHeight()) break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  colEach(min, max, cb) {\r\n    let x = 0;\r\n    const { cols } = this;\r\n    for (let i = min; i <= max; i += 1) {\r\n      const colWidth = cols.getWidth(i);\r\n      if (colWidth > 0) {\r\n        cb(i, x, colWidth);\r\n        x += colWidth;\r\n        if (x > this.viewWidth()) break;\r\n      }\r\n    }\r\n  }\r\n\r\n  defaultStyle() {\r\n    return this.settings.style;\r\n  }\r\n\r\n  addStyle(nstyle) {\r\n    const { styles } = this;\r\n    // console.log('old.styles:', styles, nstyle);\r\n    for (let i = 0; i < styles.length; i += 1) {\r\n      const style = styles[i];\r\n      if (helper.equals(style, nstyle)) return i;\r\n    }\r\n    styles.push(nstyle);\r\n    return styles.length - 1;\r\n  }\r\n\r\n  changeData(cb) {\r\n    this.history.add(this.getData());\r\n    cb();\r\n    this.change(this.getData());\r\n  }\r\n\r\n  setData(d) {\r\n    Object.keys(d).forEach((property) => {\r\n      if (\r\n        property === \"merges\" ||\r\n        property === \"rows\" ||\r\n        property === \"cols\" ||\r\n        property === \"validations\"\r\n      ) {\r\n        this[property].setData(d[property]);\r\n      } else if (property === \"freeze\") {\r\n        const [x, y] = expr2xy(d[property]);\r\n        this.freeze = [y, x];\r\n      } else if (property === \"autofilter\") {\r\n        this.autoFilter.setData(d[property]);\r\n      } else if (d[property] !== undefined) {\r\n        this[property] = d[property];\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    const {\r\n      name,\r\n      freeze,\r\n      styles,\r\n      merges,\r\n      rows,\r\n      cols,\r\n      validations,\r\n      autoFilter,\r\n    } = this;\r\n    return {\r\n      name,\r\n      freeze: xy2expr(freeze[1], freeze[0]),\r\n      styles,\r\n      merges: merges.getData(),\r\n      rows: rows.getData(),\r\n      cols: cols.getData(),\r\n      validations: validations.getData(),\r\n      autofilter: autoFilter.getData(),\r\n    };\r\n  }\r\n}\r\n","/* global window */\r\nexport const cssPrefix = 'x-spreadsheet';\r\nexport const dpr = window.devicePixelRatio || 1;\r\nexport default {\r\n  cssPrefix,\r\n  dpr,\r\n};\r\n","/* global window */\r\nimport { h } from './element';\r\nimport { mouseMoveUp } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Resizer {\r\n  constructor(vertical = false, minDistance) {\r\n    this.moving = false;\r\n    this.vertical = vertical;\r\n    this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\r\n      this.unhideHoverEl = h('div', `${cssPrefix}-resizer-hover`)\r\n        .on('dblclick.stop', evt => this.mousedblclickHandler(evt))\r\n        .css('position', 'absolute').hide(),\r\n      this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\r\n        .on('mousedown.stop', evt => this.mousedownHandler(evt)),\r\n      this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\r\n    ).hide();\r\n    // cell rect\r\n    this.cRect = null;\r\n    this.finishedFn = null;\r\n    this.minDistance = minDistance;\r\n    this.unhideFn = () => {};\r\n  }\r\n\r\n  showUnhide(index) {\r\n    this.unhideIndex = index;\r\n    this.unhideHoverEl.show();\r\n  }\r\n\r\n  hideUnhide() {\r\n    this.unhideHoverEl.hide();\r\n  }\r\n\r\n  // rect : {top, left, width, height}\r\n  // line : {width, height}\r\n  show(rect, line) {\r\n    const {\r\n      moving, vertical, hoverEl, lineEl, el,\r\n      unhideHoverEl,\r\n    } = this;\r\n    if (moving) return;\r\n    this.cRect = rect;\r\n    const {\r\n      left, top, width, height,\r\n    } = rect;\r\n    el.offset({\r\n      left: vertical ? left + width - 5 : left,\r\n      top: vertical ? top : top + height - 5,\r\n    }).show();\r\n    hoverEl.offset({\r\n      width: vertical ? 5 : width,\r\n      height: vertical ? height : 5,\r\n    });\r\n    lineEl.offset({\r\n      width: vertical ? 0 : line.width,\r\n      height: vertical ? line.height : 0,\r\n    });\r\n    unhideHoverEl.offset({\r\n      left: vertical ? 5 - width : left,\r\n      top: vertical ? top : 5 - height,\r\n      width: vertical ? 5 : width,\r\n      height: vertical ? height : 5,\r\n    });\r\n  }\r\n\r\n  hide() {\r\n    this.el.offset({\r\n      left: 0,\r\n      top: 0,\r\n    }).hide();\r\n    this.hideUnhide();\r\n  }\r\n\r\n  mousedblclickHandler() {\r\n    if (this.unhideIndex) this.unhideFn(this.unhideIndex);\r\n  }\r\n\r\n  mousedownHandler(evt) {\r\n    let startEvt = evt;\r\n    const {\r\n      el, lineEl, cRect, vertical, minDistance,\r\n    } = this;\r\n    let distance = vertical ? cRect.width : cRect.height;\r\n    // console.log('distance:', distance);\r\n    lineEl.show();\r\n    mouseMoveUp(window, (e) => {\r\n      this.moving = true;\r\n      if (startEvt !== null && e.buttons === 1) {\r\n        // console.log('top:', top, ', left:', top, ', cRect:', cRect);\r\n        if (vertical) {\r\n          distance += e.movementX;\r\n          if (distance > minDistance) {\r\n            el.css('left', `${cRect.left + distance}px`);\r\n          }\r\n        } else {\r\n          distance += e.movementY;\r\n          if (distance > minDistance) {\r\n            el.css('top', `${cRect.top + distance}px`);\r\n          }\r\n        }\r\n        startEvt = e;\r\n      }\r\n    }, () => {\r\n      startEvt = null;\r\n      lineEl.hide();\r\n      this.moving = false;\r\n      this.hide();\r\n      if (this.finishedFn) {\r\n        if (distance < minDistance) distance = minDistance;\r\n        this.finishedFn(cRect, distance);\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Scrollbar {\r\n  constructor(vertical) {\r\n    this.vertical = vertical;\r\n    this.moveFn = null;\r\n    this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\r\n      .child(this.contentEl = h('div', ''))\r\n      .on('mousemove.stop', () => {})\r\n      .on('scroll.stop', (evt) => {\r\n        const { scrollTop, scrollLeft } = evt.target;\r\n        // console.log('scrollTop:', scrollTop);\r\n        if (this.moveFn) {\r\n          this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\r\n        }\r\n        // console.log('evt:::', evt);\r\n      });\r\n  }\r\n\r\n  move(v) {\r\n    this.el.scroll(v);\r\n    return this;\r\n  }\r\n\r\n  scroll() {\r\n    return this.el.scroll();\r\n  }\r\n\r\n  set(distance, contentDistance) {\r\n    const d = distance - 1;\r\n    // console.log('distance:', distance, ', contentDistance:', contentDistance);\r\n    if (contentDistance > d) {\r\n      const cssKey = this.vertical ? 'height' : 'width';\r\n      // console.log('d:', d);\r\n      this.el.css(cssKey, `${d - 15}px`).show();\r\n      this.contentEl\r\n        .css(this.vertical ? 'width' : 'height', '1px')\r\n        .css(cssKey, `${contentDistance}px`);\r\n    } else {\r\n      this.el.hide();\r\n    }\r\n    return this;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { CellRange } from '../core/cell_range';\r\n\r\nconst selectorHeightBorderWidth = 2 * 2 - 1;\r\nlet startZIndex = 10;\r\n\r\nclass SelectorElement {\r\n  constructor(useHideInput = false, autoFocus = true) {\r\n    this.useHideInput = useHideInput;\r\n    this.autoFocus = autoFocus;\r\n    this.inputChange = () => {};\r\n    this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\r\n    this.areaEl = h('div', `${cssPrefix}-selector-area`)\r\n      .child(this.cornerEl).hide();\r\n    this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\r\n    this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\r\n    this.el = h('div', `${cssPrefix}-selector`)\r\n      .css('z-index', `${startZIndex}`)\r\n      .children(this.areaEl, this.clipboardEl, this.autofillEl)\r\n      .hide();\r\n    if (useHideInput) {\r\n      this.hideInput = h('input', '')\r\n        .on('compositionend', (evt) => {\r\n          this.inputChange(evt.target.value);\r\n        });\r\n      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));\r\n      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));\r\n    }\r\n    startZIndex += 1;\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.offset(v).show();\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    return this;\r\n  }\r\n\r\n  setAreaOffset(v) {\r\n    const {\r\n      left, top, width, height,\r\n    } = v;\r\n    const of = {\r\n      width: width - selectorHeightBorderWidth + 0.8,\r\n      height: height - selectorHeightBorderWidth + 0.8,\r\n      left: left - 0.8,\r\n      top: top - 0.8,\r\n    };\r\n    this.areaEl.offset(of).show();\r\n    if (this.useHideInput) {\r\n      this.hideInputDiv.offset(of);\r\n      if (this.autoFocus) {\r\n        this.hideInput.val('').focus();\r\n      } else {\r\n        this.hideInput.val('');\r\n      }\r\n    }\r\n  }\r\n\r\n  setClipboardOffset(v) {\r\n    const {\r\n      left, top, width, height,\r\n    } = v;\r\n    this.clipboardEl.offset({\r\n      left,\r\n      top,\r\n      width: width - 5,\r\n      height: height - 5,\r\n    });\r\n  }\r\n\r\n  showAutofill(v) {\r\n    const {\r\n      left, top, width, height,\r\n    } = v;\r\n    this.autofillEl.offset({\r\n      width: width - selectorHeightBorderWidth,\r\n      height: height - selectorHeightBorderWidth,\r\n      left,\r\n      top,\r\n    }).show();\r\n  }\r\n\r\n  hideAutofill() {\r\n    this.autofillEl.hide();\r\n  }\r\n\r\n  showClipboard() {\r\n    this.clipboardEl.show();\r\n  }\r\n\r\n  hideClipboard() {\r\n    this.clipboardEl.hide();\r\n  }\r\n}\r\n\r\nfunction calBRAreaOffset(offset) {\r\n  const { data } = this;\r\n  const {\r\n    left, top, width, height, scroll, l, t,\r\n  } = offset;\r\n  const ftwidth = data.freezeTotalWidth();\r\n  const ftheight = data.freezeTotalHeight();\r\n  let left0 = left - ftwidth;\r\n  if (ftwidth > l) left0 -= scroll.x;\r\n  let top0 = top - ftheight;\r\n  if (ftheight > t) top0 -= scroll.y;\r\n  return {\r\n    left: left0,\r\n    top: top0,\r\n    width,\r\n    height,\r\n  };\r\n}\r\n\r\nfunction calTAreaOffset(offset) {\r\n  const { data } = this;\r\n  const {\r\n    left, width, height, l, t, scroll,\r\n  } = offset;\r\n  const ftwidth = data.freezeTotalWidth();\r\n  let left0 = left - ftwidth;\r\n  if (ftwidth > l) left0 -= scroll.x;\r\n  return {\r\n    left: left0, top: t, width, height,\r\n  };\r\n}\r\n\r\nfunction calLAreaOffset(offset) {\r\n  const { data } = this;\r\n  const {\r\n    top, width, height, l, t, scroll,\r\n  } = offset;\r\n  const ftheight = data.freezeTotalHeight();\r\n  let top0 = top - ftheight;\r\n  // console.log('ftheight:', ftheight, ', t:', t);\r\n  if (ftheight > t) top0 -= scroll.y;\r\n  return {\r\n    left: l, top: top0, width, height,\r\n  };\r\n}\r\n\r\nfunction setBRAreaOffset(offset) {\r\n  const { br } = this;\r\n  br.setAreaOffset(calBRAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setTLAreaOffset(offset) {\r\n  const { tl } = this;\r\n  tl.setAreaOffset(offset);\r\n}\r\n\r\nfunction setTAreaOffset(offset) {\r\n  const { t } = this;\r\n  t.setAreaOffset(calTAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setLAreaOffset(offset) {\r\n  const { l } = this;\r\n  l.setAreaOffset(calLAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setLClipboardOffset(offset) {\r\n  const { l } = this;\r\n  l.setClipboardOffset(calLAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setBRClipboardOffset(offset) {\r\n  const { br } = this;\r\n  br.setClipboardOffset(calBRAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setTLClipboardOffset(offset) {\r\n  const { tl } = this;\r\n  tl.setClipboardOffset(offset);\r\n}\r\n\r\nfunction setTClipboardOffset(offset) {\r\n  const { t } = this;\r\n  t.setClipboardOffset(calTAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setAllAreaOffset(offset) {\r\n  setBRAreaOffset.call(this, offset);\r\n  setTLAreaOffset.call(this, offset);\r\n  setTAreaOffset.call(this, offset);\r\n  setLAreaOffset.call(this, offset);\r\n}\r\n\r\nfunction setAllClipboardOffset(offset) {\r\n  setBRClipboardOffset.call(this, offset);\r\n  setTLClipboardOffset.call(this, offset);\r\n  setTClipboardOffset.call(this, offset);\r\n  setLClipboardOffset.call(this, offset);\r\n}\r\n\r\nexport default class Selector {\r\n  constructor(data) {\r\n    const { autoFocus } = data.settings;\r\n    this.inputChange = () => {};\r\n    this.data = data;\r\n    this.br = new SelectorElement(true, autoFocus);\r\n    this.t = new SelectorElement();\r\n    this.l = new SelectorElement();\r\n    this.tl = new SelectorElement();\r\n    this.br.inputChange = (v) => {\r\n      this.inputChange(v);\r\n    };\r\n    this.br.el.show();\r\n    this.offset = null;\r\n    this.areaOffset = null;\r\n    this.indexes = null;\r\n    this.range = null;\r\n    this.arange = null;\r\n    this.el = h('div', `${cssPrefix}-selectors`)\r\n      .children(\r\n        this.tl.el,\r\n        this.t.el,\r\n        this.l.el,\r\n        this.br.el,\r\n      ).hide();\r\n\r\n    // for performance\r\n    this.lastri = -1;\r\n    this.lastci = -1;\r\n\r\n    startZIndex += 1;\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n    this.range = data.selector.range;\r\n    this.resetAreaOffset();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n\r\n  resetOffset() {\r\n    const {\r\n      data, tl, t, l, br,\r\n    } = this;\r\n    const freezeHeight = data.freezeTotalHeight();\r\n    const freezeWidth = data.freezeTotalWidth();\r\n    if (freezeHeight > 0 || freezeWidth > 0) {\r\n      tl.setOffset({ width: freezeWidth, height: freezeHeight });\r\n      t.setOffset({ left: freezeWidth, height: freezeHeight });\r\n      l.setOffset({ top: freezeHeight, width: freezeWidth });\r\n      br.setOffset({ left: freezeWidth, top: freezeHeight });\r\n    } else {\r\n      tl.hide();\r\n      t.hide();\r\n      l.hide();\r\n      br.setOffset({ left: 0, top: 0 });\r\n    }\r\n  }\r\n\r\n  resetAreaOffset() {\r\n    // console.log('offset:', offset);\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setAllAreaOffset.call(this, offset);\r\n    setAllClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  resetBRTAreaOffset() {\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setBRAreaOffset.call(this, offset);\r\n    setTAreaOffset.call(this, offset);\r\n    setBRClipboardOffset.call(this, coffset);\r\n    setTClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  resetBRLAreaOffset() {\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setBRAreaOffset.call(this, offset);\r\n    setLAreaOffset.call(this, offset);\r\n    setBRClipboardOffset.call(this, coffset);\r\n    setLClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  set(ri, ci, indexesUpdated = true) {\r\n    const { data } = this;\r\n    const cellRange = data.calSelectedRangeByStart(ri, ci);\r\n    const { sri, sci } = cellRange;\r\n    if (indexesUpdated) {\r\n      let [cri, cci] = [ri, ci];\r\n      if (ri < 0) cri = 0;\r\n      if (ci < 0) cci = 0;\r\n      data.selector.setIndexes(cri, cci);\r\n      this.indexes = [cri, cci];\r\n    }\r\n\r\n    this.moveIndexes = [sri, sci];\r\n    // this.sIndexes = sIndexes;\r\n    // this.eIndexes = eIndexes;\r\n    this.range = cellRange;\r\n    this.resetAreaOffset();\r\n    this.el.show();\r\n  }\r\n\r\n  setEnd(ri, ci, moving = true) {\r\n    const { data, lastri, lastci } = this;\r\n    if (moving) {\r\n      if (ri === lastri && ci === lastci) return;\r\n      this.lastri = ri;\r\n      this.lastci = ci;\r\n    }\r\n    this.range = data.calSelectedRangeByEnd(ri, ci);\r\n    setAllAreaOffset.call(this, this.data.getSelectedRect());\r\n  }\r\n\r\n  reset() {\r\n    // console.log('::::', this.data);\r\n    const { eri, eci } = this.data.selector.range;\r\n    this.setEnd(eri, eci);\r\n  }\r\n\r\n  showAutofill(ri, ci) {\r\n    if (ri === -1 && ci === -1) return;\r\n    // console.log('ri:', ri, ', ci:', ci);\r\n    // const [sri, sci] = this.sIndexes;\r\n    // const [eri, eci] = this.eIndexes;\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this.range;\r\n    const [nri, nci] = [ri, ci];\r\n    // const rn = eri - sri;\r\n    // const cn = eci - sci;\r\n    const srn = sri - ri;\r\n    const scn = sci - ci;\r\n    const ern = eri - ri;\r\n    const ecn = eci - ci;\r\n    if (scn > 0) {\r\n      // left\r\n      // console.log('left');\r\n      this.arange = new CellRange(sri, nci, eri, sci - 1);\r\n      // this.saIndexes = [sri, nci];\r\n      // this.eaIndexes = [eri, sci - 1];\r\n      // data.calRangeIndexes2(\r\n    } else if (srn > 0) {\r\n      // top\r\n      // console.log('top');\r\n      // nri = sri;\r\n      this.arange = new CellRange(nri, sci, sri - 1, eci);\r\n      // this.saIndexes = [nri, sci];\r\n      // this.eaIndexes = [sri - 1, eci];\r\n    } else if (ecn < 0) {\r\n      // right\r\n      // console.log('right');\r\n      // nci = eci;\r\n      this.arange = new CellRange(sri, eci + 1, eri, nci);\r\n      // this.saIndexes = [sri, eci + 1];\r\n      // this.eaIndexes = [eri, nci];\r\n    } else if (ern < 0) {\r\n      // bottom\r\n      // console.log('bottom');\r\n      // nri = eri;\r\n      this.arange = new CellRange(eri + 1, sci, nri, eci);\r\n      // this.saIndexes = [eri + 1, sci];\r\n      // this.eaIndexes = [nri, eci];\r\n    } else {\r\n      // console.log('else:');\r\n      this.arange = null;\r\n      // this.saIndexes = null;\r\n      // this.eaIndexes = null;\r\n      return;\r\n    }\r\n    if (this.arange !== null) {\r\n      // console.log(this.saIndexes, ':', this.eaIndexes);\r\n      const offset = this.data.getRect(this.arange);\r\n      offset.width += 2;\r\n      offset.height += 2;\r\n      const {\r\n        br, l, t, tl,\r\n      } = this;\r\n      br.showAutofill(calBRAreaOffset.call(this, offset));\r\n      l.showAutofill(calLAreaOffset.call(this, offset));\r\n      t.showAutofill(calTAreaOffset.call(this, offset));\r\n      tl.showAutofill(offset);\r\n    }\r\n  }\r\n\r\n  hideAutofill() {\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].hideAutofill();\r\n    });\r\n  }\r\n\r\n  showClipboard() {\r\n    const coffset = this.data.getClipboardRect();\r\n    setAllClipboardOffset.call(this, coffset);\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].showClipboard();\r\n    });\r\n  }\r\n\r\n  hideClipboard() {\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].hideClipboard();\r\n    });\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction inputMovePrev(evt) {\r\n  evt.preventDefault();\r\n  evt.stopPropagation();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\r\n  this.itemIndex -= 1;\r\n  if (this.itemIndex < 0) {\r\n    this.itemIndex = filterItems.length - 1;\r\n  }\r\n  filterItems[this.itemIndex].toggle();\r\n}\r\n\r\nfunction inputMoveNext(evt) {\r\n  evt.stopPropagation();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\r\n  this.itemIndex += 1;\r\n  if (this.itemIndex > filterItems.length - 1) {\r\n    this.itemIndex = 0;\r\n  }\r\n  filterItems[this.itemIndex].toggle();\r\n}\r\n\r\nfunction inputEnter(evt) {\r\n  evt.preventDefault();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  evt.stopPropagation();\r\n  if (this.itemIndex < 0) this.itemIndex = 0;\r\n  filterItems[this.itemIndex].el.click();\r\n  this.hide();\r\n}\r\n\r\nfunction inputKeydownHandler(evt) {\r\n  const { keyCode } = evt;\r\n  if (evt.ctrlKey) {\r\n    evt.stopPropagation();\r\n  }\r\n  switch (keyCode) {\r\n    case 37: // left\r\n      evt.stopPropagation();\r\n      break;\r\n    case 38: // up\r\n      inputMovePrev.call(this, evt);\r\n      break;\r\n    case 39: // right\r\n      evt.stopPropagation();\r\n      break;\r\n    case 40: // down\r\n      inputMoveNext.call(this, evt);\r\n      break;\r\n    case 13: // enter\r\n      inputEnter.call(this, evt);\r\n      break;\r\n    case 9:\r\n      inputEnter.call(this, evt);\r\n      break;\r\n    default:\r\n      evt.stopPropagation();\r\n      break;\r\n  }\r\n}\r\n\r\nexport default class Suggest {\r\n  constructor(items, itemClick, width = '200px') {\r\n    this.filterItems = [];\r\n    this.items = items;\r\n    this.el = h('div', `${cssPrefix}-suggest`).css('width', width).hide();\r\n    this.itemClick = itemClick;\r\n    this.itemIndex = -1;\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.cssRemoveKeys('top', 'bottom')\r\n      .offset(v);\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    this.filterItems = [];\r\n    this.itemIndex = -1;\r\n    el.hide();\r\n    unbindClickoutside(this.el.parent());\r\n  }\r\n\r\n  setItems(items) {\r\n    this.items = items;\r\n    // this.search('');\r\n  }\r\n\r\n  search(word) {\r\n    let { items } = this;\r\n    if (!/^\\s*$/.test(word)) {\r\n      items = items.filter(it => (it.key || it).startsWith(word.toUpperCase()));\r\n    }\r\n    items = items.map((it) => {\r\n      let { title } = it;\r\n      if (title) {\r\n        if (typeof title === 'function') {\r\n          title = title();\r\n        }\r\n      } else {\r\n        title = it;\r\n      }\r\n      const item = h('div', `${cssPrefix}-item`)\r\n        .child(title)\r\n        .on('click.stop', () => {\r\n          this.itemClick(it);\r\n          this.hide();\r\n        });\r\n      if (it.label) {\r\n        item.child(h('div', 'label').html(it.label));\r\n      }\r\n      return item;\r\n    });\r\n    this.filterItems = items;\r\n    if (items.length <= 0) {\r\n      return;\r\n    }\r\n    const { el } = this;\r\n    // items[0].toggle();\r\n    el.html('').children(...items).show();\r\n    bindClickoutside(el.parent(), () => { this.hide(); });\r\n  }\r\n\r\n  bindInputEvents(input) {\r\n    input.on('keydown', evt => inputKeydownHandler.call(this, evt));\r\n  }\r\n}\r\n","import { Element, h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Icon extends Element {\r\n  constructor(name) {\r\n    super('div', `${cssPrefix}-icon`);\r\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\r\n    this.child(this.iconNameEl);\r\n  }\r\n\r\n  setName(name) {\r\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Icon from './icon';\r\nimport { t } from '../locale/locale';\r\n\r\nfunction addMonth(date, step) {\r\n  date.setMonth(date.getMonth() + step);\r\n}\r\n\r\nfunction weekday(date, index) {\r\n  const d = new Date(date);\r\n  d.setDate(index - date.getDay() + 1);\r\n  return d;\r\n}\r\n\r\nfunction monthDays(year, month, cdate) {\r\n  // the first day of month\r\n  const startDate = new Date(year, month, 1, 23, 59, 59);\r\n  const datess = [[], [], [], [], [], []];\r\n  for (let i = 0; i < 6; i += 1) {\r\n    for (let j = 0; j < 7; j += 1) {\r\n      const index = i * 7 + j;\r\n      const d = weekday(startDate, index);\r\n      const disabled = d.getMonth() !== month;\r\n      // console.log('d:', d, ', cdate:', cdate);\r\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\r\n      datess[i][j] = { d, disabled, active };\r\n    }\r\n  }\r\n  return datess;\r\n}\r\n\r\nexport default class Calendar {\r\n  constructor(value) {\r\n    this.value = value;\r\n    this.cvalue = new Date(value);\r\n\r\n    this.headerLeftEl = h('div', 'calendar-header-left');\r\n    this.bodyEl = h('tbody', '');\r\n    this.buildAll();\r\n    this.el = h('div', 'x-spreadsheet-calendar')\r\n      .children(\r\n        h('div', 'calendar-header').children(\r\n          this.headerLeftEl,\r\n          h('div', 'calendar-header-right').children(\r\n            h('a', 'calendar-prev')\r\n              .on('click.stop', () => this.prev())\r\n              .child(new Icon('chevron-left')),\r\n            h('a', 'calendar-next')\r\n              .on('click.stop', () => this.next())\r\n              .child(new Icon('chevron-right')),\r\n          ),\r\n        ),\r\n        h('table', 'calendar-body').children(\r\n          h('thead', '').child(\r\n            h('tr', '').children(\r\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\r\n            ),\r\n          ),\r\n          this.bodyEl,\r\n        ),\r\n      );\r\n    this.selectChange = () => {};\r\n  }\r\n\r\n  setValue(value) {\r\n    this.value = value;\r\n    this.cvalue = new Date(value);\r\n    this.buildAll();\r\n  }\r\n\r\n  prev() {\r\n    const { value } = this;\r\n    addMonth(value, -1);\r\n    this.buildAll();\r\n  }\r\n\r\n  next() {\r\n    const { value } = this;\r\n    addMonth(value, 1);\r\n    this.buildAll();\r\n  }\r\n\r\n  buildAll() {\r\n    this.buildHeaderLeft();\r\n    this.buildBody();\r\n  }\r\n\r\n  buildHeaderLeft() {\r\n    const { value } = this;\r\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\r\n  }\r\n\r\n  buildBody() {\r\n    const { value, cvalue, bodyEl } = this;\r\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\r\n    const trs = mDays.map((it) => {\r\n      const tds = it.map((it1) => {\r\n        let cls = 'cell';\r\n        if (it1.disabled) cls += ' disabled';\r\n        if (it1.active) cls += ' active';\r\n        return h('td', '').child(\r\n          h('div', cls)\r\n            .on('click.stop', () => {\r\n              this.selectChange(it1.d);\r\n            })\r\n            .child(it1.d.getDate().toString()),\r\n        );\r\n      });\r\n      return h('tr', '').children(...tds);\r\n    });\r\n    bodyEl.html('').children(...trs);\r\n  }\r\n}\r\n","import Calendar from './calendar';\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Datepicker {\r\n  constructor() {\r\n    this.calendar = new Calendar(new Date());\r\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\r\n      this.calendar.el,\r\n    ).hide();\r\n  }\r\n\r\n  setValue(date) {\r\n    // console.log(':::::::', date, typeof date, date instanceof string);\r\n    const { calendar } = this;\r\n    if (typeof date === 'string') {\r\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\r\n      if (/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date)) {\r\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\r\n      }\r\n    } else if (date instanceof Date) {\r\n      calendar.setValue(date);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  change(cb) {\r\n    this.calendar.selectChange = (d) => {\r\n      cb(d);\r\n      this.hide();\r\n    };\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n}\r\n","//* global window */\r\nimport { h } from './element';\r\nimport Suggest from './suggest';\r\nimport Datepicker from './datepicker';\r\nimport { cssPrefix } from '../config';\r\n// import { mouseMoveUp } from '../event';\r\n\r\nfunction resetTextareaSize() {\r\n  const { inputText } = this;\r\n  if (!/^\\s*$/.test(inputText)) {\r\n    const {\r\n      textlineEl, textEl, areaOffset,\r\n    } = this;\r\n    const txts = inputText.split('\\n');\r\n    const maxTxtSize = Math.max(...txts.map(it => it.length));\r\n    const tlOffset = textlineEl.offset();\r\n    const fontWidth = tlOffset.width / inputText.length;\r\n    const tlineWidth = (maxTxtSize + 1) * fontWidth + 5;\r\n    const maxWidth = this.viewFn().width - areaOffset.left - fontWidth;\r\n    let h1 = txts.length;\r\n    if (tlineWidth > areaOffset.width) {\r\n      let twidth = tlineWidth;\r\n      if (tlineWidth > maxWidth) {\r\n        twidth = maxWidth;\r\n        h1 += parseInt(tlineWidth / maxWidth, 10);\r\n        h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\r\n      }\r\n      textEl.css('width', `${twidth}px`);\r\n    }\r\n    h1 *= this.rowHeight;\r\n    if (h1 > areaOffset.height) {\r\n      textEl.css('height', `${h1}px`);\r\n    }\r\n  }\r\n}\r\n\r\nfunction insertText({ target }, itxt) {\r\n  const { value, selectionEnd } = target;\r\n  const ntxt = `${value.slice(0, selectionEnd)}${itxt}${value.slice(selectionEnd)}`;\r\n  target.value = ntxt;\r\n  target.setSelectionRange(selectionEnd + 1, selectionEnd + 1);\r\n\r\n  this.inputText = ntxt;\r\n  this.textlineEl.html(ntxt);\r\n  resetTextareaSize.call(this);\r\n}\r\n\r\nfunction keydownEventHandler(evt) {\r\n  const { keyCode, altKey } = evt;\r\n  if (keyCode !== 13 && keyCode !== 9) evt.stopPropagation();\r\n  if (keyCode === 13 && altKey) {\r\n    insertText.call(this, evt, '\\n');\r\n    evt.stopPropagation();\r\n  }\r\n  if (keyCode === 13 && !altKey) evt.preventDefault();\r\n}\r\n\r\nfunction inputEventHandler(evt) {\r\n  const v = evt.target.value;\r\n  // console.log(evt, 'v:', v);\r\n  const { suggest, textlineEl, validator } = this;\r\n  const { cell } = this;\r\n  if (cell !== null) {\r\n    if (('editable' in cell && cell.editable === true) || (cell.editable === undefined)) {\r\n      this.inputText = v;\r\n      if (validator) {\r\n        if (validator.type === 'list') {\r\n          suggest.search(v);\r\n        } else {\r\n          suggest.hide();\r\n        }\r\n      } else {\r\n        const start = v.lastIndexOf('=');\r\n        if (start !== -1) {\r\n          suggest.search(v.substring(start + 1));\r\n        } else {\r\n          suggest.hide();\r\n        }\r\n      }\r\n      textlineEl.html(v);\r\n      resetTextareaSize.call(this);\r\n      this.change('input', v);\r\n    } else {\r\n      evt.target.value = cell.text || '';\r\n    }\r\n  } else {\r\n    this.inputText = v;\r\n    if (validator) {\r\n      if (validator.type === 'list') {\r\n        suggest.search(v);\r\n      } else {\r\n        suggest.hide();\r\n      }\r\n    } else {\r\n      const start = v.lastIndexOf('=');\r\n      if (start !== -1) {\r\n        suggest.search(v.substring(start + 1));\r\n      } else {\r\n        suggest.hide();\r\n      }\r\n    }\r\n    textlineEl.html(v);\r\n    resetTextareaSize.call(this);\r\n    this.change('input', v);\r\n  }\r\n}\r\n\r\nfunction setTextareaRange(position) {\r\n  const { el } = this.textEl;\r\n  setTimeout(() => {\r\n    el.focus();\r\n    el.setSelectionRange(position, position);\r\n  }, 0);\r\n}\r\n\r\nfunction setText(text, position) {\r\n  const { textEl, textlineEl } = this;\r\n  // firefox bug\r\n  textEl.el.blur();\r\n\r\n  textEl.val(text);\r\n  textlineEl.html(text);\r\n  setTextareaRange.call(this, position);\r\n}\r\n\r\nfunction suggestItemClick(it) {\r\n  const { inputText, validator } = this;\r\n  let position = 0;\r\n  if (validator && validator.type === 'list') {\r\n    this.inputText = it;\r\n    position = this.inputText.length;\r\n  } else {\r\n    const start = inputText.lastIndexOf('=');\r\n    const sit = inputText.substring(0, start + 1);\r\n    let eit = inputText.substring(start + 1);\r\n    if (eit.indexOf(')') !== -1) {\r\n      eit = eit.substring(eit.indexOf(')'));\r\n    } else {\r\n      eit = '';\r\n    }\r\n    this.inputText = `${sit + it.key}(`;\r\n    // console.log('inputText:', this.inputText);\r\n    position = this.inputText.length;\r\n    this.inputText += `)${eit}`;\r\n  }\r\n  setText.call(this, this.inputText, position);\r\n}\r\n\r\nfunction resetSuggestItems() {\r\n  this.suggest.setItems(this.formulas);\r\n}\r\n\r\nfunction dateFormat(d) {\r\n  let month = d.getMonth() + 1;\r\n  let date = d.getDate();\r\n  if (month < 10) month = `0${month}`;\r\n  if (date < 10) date = `0${date}`;\r\n  return `${d.getFullYear()}-${month}-${date}`;\r\n}\r\n\r\nexport default class Editor {\r\n  constructor(formulas, viewFn, rowHeight) {\r\n    this.viewFn = viewFn;\r\n    this.rowHeight = rowHeight;\r\n    this.formulas = formulas;\r\n    this.suggest = new Suggest(formulas, (it) => {\r\n      suggestItemClick.call(this, it);\r\n    });\r\n    this.datepicker = new Datepicker();\r\n    this.datepicker.change((d) => {\r\n      // console.log('d:', d);\r\n      this.setText(dateFormat(d));\r\n      this.clear();\r\n    });\r\n    this.areaEl = h('div', `${cssPrefix}-editor-area`)\r\n      .children(\r\n        this.textEl = h('textarea', '')\r\n          .on('input', evt => inputEventHandler.call(this, evt))\r\n          .on('paste.stop', () => {})\r\n          .on('keydown', evt => keydownEventHandler.call(this, evt)),\r\n        this.textlineEl = h('div', 'textline'),\r\n        this.suggest.el,\r\n        this.datepicker.el,\r\n      )\r\n      .on('mousemove.stop', () => {})\r\n      .on('mousedown.stop', () => {});\r\n    this.el = h('div', `${cssPrefix}-editor`)\r\n      .child(this.areaEl).hide();\r\n    this.suggest.bindInputEvents(this.textEl);\r\n\r\n    this.areaOffset = null;\r\n    this.freeze = { w: 0, h: 0 };\r\n    this.cell = null;\r\n    this.inputText = '';\r\n    this.change = () => {};\r\n  }\r\n\r\n  setFreezeLengths(width, height) {\r\n    this.freeze.w = width;\r\n    this.freeze.h = height;\r\n  }\r\n\r\n  clear() {\r\n    // const { cell } = this;\r\n    // const cellText = (cell && cell.text) || '';\r\n    if (this.inputText !== '') {\r\n      this.change('finished', this.inputText);\r\n    }\r\n    this.cell = null;\r\n    this.areaOffset = null;\r\n    this.inputText = '';\r\n    this.el.hide();\r\n    this.textEl.val('');\r\n    this.textlineEl.html('');\r\n    resetSuggestItems.call(this);\r\n    this.datepicker.hide();\r\n  }\r\n\r\n  setOffset(offset, suggestPosition = 'top') {\r\n    const {\r\n      textEl, areaEl, suggest, freeze, el,\r\n    } = this;\r\n    if (offset) {\r\n      this.areaOffset = offset;\r\n      const {\r\n        left, top, width, height, l, t,\r\n      } = offset;\r\n      // console.log('left:', left, ',top:', top, ', freeze:', freeze);\r\n      const elOffset = { left: 0, top: 0 };\r\n      // top left\r\n      if (freeze.w > l && freeze.h > t) {\r\n        //\r\n      } else if (freeze.w < l && freeze.h < t) {\r\n        elOffset.left = freeze.w;\r\n        elOffset.top = freeze.h;\r\n      } else if (freeze.w > l) {\r\n        elOffset.top = freeze.h;\r\n      } else if (freeze.h > t) {\r\n        elOffset.left = freeze.w;\r\n      }\r\n      el.offset(elOffset);\r\n      areaEl.offset({ left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8 });\r\n      textEl.offset({ width: width - 9 + 0.8, height: height - 3 + 0.8 });\r\n      const sOffset = { left: 0 };\r\n      sOffset[suggestPosition] = height;\r\n      suggest.setOffset(sOffset);\r\n      suggest.hide();\r\n    }\r\n  }\r\n\r\n  setCell(cell, validator) {\r\n    if (cell && cell.editable === false) return;\r\n\r\n    // console.log('::', validator);\r\n    const { el, datepicker, suggest } = this;\r\n    el.show();\r\n    this.cell = cell;\r\n    const text = (cell && cell.text) || '';\r\n    this.setText(text);\r\n\r\n    this.validator = validator;\r\n    if (validator) {\r\n      const { type } = validator;\r\n      if (type === 'date') {\r\n        datepicker.show();\r\n        if (!/^\\s*$/.test(text)) {\r\n          datepicker.setValue(text);\r\n        }\r\n      }\r\n      if (type === 'list') {\r\n        suggest.setItems(validator.values());\r\n        suggest.search('');\r\n      }\r\n    }\r\n  }\r\n\r\n  setText(text) {\r\n    this.inputText = text;\r\n    // console.log('text>>:', text);\r\n    setText.call(this, text, text.length);\r\n    resetTextareaSize.call(this);\r\n  }\r\n}\r\n","import { Element } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nexport default class Button extends Element {\r\n  // type: primary\r\n  constructor(title, type = '') {\r\n    super('div', `${cssPrefix}-button ${type}`);\r\n    this.child(t(`button.${title}`));\r\n  }\r\n}\r\n","/* global window */\r\nfunction dpr() {\r\n  return window.devicePixelRatio || 1;\r\n}\r\n\r\nfunction thinLineWidth() {\r\n  return dpr() - 0.5;\r\n}\r\n\r\nfunction npx(px) {\r\n  return parseInt(px * dpr(), 10);\r\n}\r\n\r\nfunction npxLine(px) {\r\n  const n = npx(px);\r\n  return n > 0 ? n - 0.5 : 0.5;\r\n}\r\n\r\nclass DrawBox {\r\n  constructor(x, y, w, h, padding = 0) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = w;\r\n    this.height = h;\r\n    this.padding = padding;\r\n    this.bgcolor = '#ffffff';\r\n    // border: [width, style, color]\r\n    this.borderTop = null;\r\n    this.borderRight = null;\r\n    this.borderBottom = null;\r\n    this.borderLeft = null;\r\n  }\r\n\r\n  setBorders({\r\n    top, bottom, left, right,\r\n  }) {\r\n    if (top) this.borderTop = top;\r\n    if (right) this.borderRight = right;\r\n    if (bottom) this.borderBottom = bottom;\r\n    if (left) this.borderLeft = left;\r\n  }\r\n\r\n  innerWidth() {\r\n    return this.width - (this.padding * 2) - 2;\r\n  }\r\n\r\n  innerHeight() {\r\n    return this.height - (this.padding * 2) - 2;\r\n  }\r\n\r\n  textx(align) {\r\n    const { width, padding } = this;\r\n    let { x } = this;\r\n    if (align === 'left') {\r\n      x += padding;\r\n    } else if (align === 'center') {\r\n      x += width / 2;\r\n    } else if (align === 'right') {\r\n      x += width - padding;\r\n    }\r\n    return x;\r\n  }\r\n\r\n  texty(align, h) {\r\n    const { height, padding } = this;\r\n    let { y } = this;\r\n    if (align === 'top') {\r\n      y += padding;\r\n    } else if (align === 'middle') {\r\n      y += height / 2 - h / 2;\r\n    } else if (align === 'bottom') {\r\n      y += height - padding - h;\r\n    }\r\n    return y;\r\n  }\r\n\r\n  topxys() {\r\n    const { x, y, width } = this;\r\n    return [[x, y], [x + width, y]];\r\n  }\r\n\r\n  rightxys() {\r\n    const {\r\n      x, y, width, height,\r\n    } = this;\r\n    return [[x + width, y], [x + width, y + height]];\r\n  }\r\n\r\n  bottomxys() {\r\n    const {\r\n      x, y, width, height,\r\n    } = this;\r\n    return [[x, y + height], [x + width, y + height]];\r\n  }\r\n\r\n  leftxys() {\r\n    const {\r\n      x, y, height,\r\n    } = this;\r\n    return [[x, y], [x, y + height]];\r\n  }\r\n}\r\n\r\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\r\n  const floffset = { x: 0, y: 0 };\r\n  if (type === 'underline') {\r\n    if (valign === 'bottom') {\r\n      floffset.y = 0;\r\n    } else if (valign === 'top') {\r\n      floffset.y = -(blheight + 2);\r\n    } else {\r\n      floffset.y = -blheight / 2;\r\n    }\r\n  } else if (type === 'strike') {\r\n    if (valign === 'bottom') {\r\n      floffset.y = blheight / 2;\r\n    } else if (valign === 'top') {\r\n      floffset.y = -((blheight / 2) + 2);\r\n    }\r\n  }\r\n\r\n  if (align === 'center') {\r\n    floffset.x = blwidth / 2;\r\n  } else if (align === 'right') {\r\n    floffset.x = blwidth;\r\n  }\r\n  this.line(\r\n    [tx - floffset.x, ty - floffset.y],\r\n    [tx - floffset.x + blwidth, ty - floffset.y],\r\n  );\r\n}\r\n\r\nclass Draw {\r\n  constructor(el, width, height) {\r\n    this.el = el;\r\n    this.ctx = el.getContext('2d');\r\n    this.resize(width, height);\r\n    this.ctx.scale(dpr(), dpr());\r\n  }\r\n\r\n  resize(width, height) {\r\n    // console.log('dpr:', dpr);\r\n    this.el.style.width = `${width}px`;\r\n    this.el.style.height = `${height}px`;\r\n    this.el.width = npx(width);\r\n    this.el.height = npx(height);\r\n  }\r\n\r\n  clear() {\r\n    const { width, height } = this.el;\r\n    this.ctx.clearRect(0, 0, width, height);\r\n    return this;\r\n  }\r\n\r\n  attr(options) {\r\n    Object.assign(this.ctx, options);\r\n    return this;\r\n  }\r\n\r\n  save() {\r\n    this.ctx.save();\r\n    this.ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  restore() {\r\n    this.ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  beginPath() {\r\n    this.ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  translate(x, y) {\r\n    this.ctx.translate(npx(x), npx(y));\r\n    return this;\r\n  }\r\n\r\n  scale(x, y) {\r\n    this.ctx.scale(x, y);\r\n    return this;\r\n  }\r\n\r\n  clearRect(x, y, w, h) {\r\n    this.ctx.clearRect(x, y, w, h);\r\n    return this;\r\n  }\r\n\r\n  fillRect(x, y, w, h) {\r\n    this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\r\n    return this;\r\n  }\r\n\r\n  fillText(text, x, y) {\r\n    this.ctx.fillText(text, npx(x), npx(y));\r\n    return this;\r\n  }\r\n\r\n  /*\r\n    txt: render text\r\n    box: DrawBox\r\n    attr: {\r\n      align: left | center | right\r\n      valign: top | middle | bottom\r\n      color: '#333333',\r\n      strike: false,\r\n      font: {\r\n        name: 'Arial',\r\n        size: 14,\r\n        bold: false,\r\n        italic: false,\r\n      }\r\n    }\r\n    textWrap: text wrapping\r\n  */\r\n  text(mtxt, box, attr = {}, textWrap = true) {\r\n    const { ctx } = this;\r\n    const {\r\n      align, valign, font, color, strike, underline,\r\n    } = attr;\r\n    const tx = box.textx(align);\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    this.attr({\r\n      textAlign: align,\r\n      textBaseline: valign,\r\n      font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\r\n      fillStyle: color,\r\n      strokeStyle: color,\r\n    });\r\n    const txts = `${mtxt}`.split('\\n');\r\n    const biw = box.innerWidth();\r\n    const ntxts = [];\r\n    txts.forEach((it) => {\r\n      const txtWidth = ctx.measureText(it).width;\r\n      if (textWrap && txtWidth > npx(biw)) {\r\n        let textLine = { w: 0, len: 0, start: 0 };\r\n        for (let i = 0; i < it.length; i += 1) {\r\n          if (textLine.w >= npx(biw)) {\r\n            ntxts.push(it.substr(textLine.start, textLine.len));\r\n            textLine = { w: 0, len: 0, start: i };\r\n          }\r\n          textLine.len += 1;\r\n          textLine.w += ctx.measureText(it[i]).width + 1;\r\n        }\r\n        if (textLine.len > 0) {\r\n          ntxts.push(it.substr(textLine.start, textLine.len));\r\n        }\r\n      } else {\r\n        ntxts.push(it);\r\n      }\r\n    });\r\n    const txtHeight = (ntxts.length - 1) * (font.size + 2);\r\n    let ty = box.texty(valign, txtHeight);\r\n    ntxts.forEach((txt) => {\r\n      const txtWidth = ctx.measureText(txt).width;\r\n      this.fillText(txt, tx, ty);\r\n      if (strike) {\r\n        drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, txtWidth);\r\n      }\r\n      if (underline) {\r\n        drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\r\n      }\r\n      ty += font.size + 2;\r\n    });\r\n    ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  border(style, color) {\r\n    const { ctx } = this;\r\n    ctx.lineWidth = thinLineWidth;\r\n    ctx.strokeStyle = color;\r\n    // console.log('style:', style);\r\n    if (style === 'medium') {\r\n      ctx.lineWidth = npx(2) - 0.5;\r\n    } else if (style === 'thick') {\r\n      ctx.lineWidth = npx(3);\r\n    } else if (style === 'dashed') {\r\n      ctx.setLineDash([npx(3), npx(2)]);\r\n    } else if (style === 'dotted') {\r\n      ctx.setLineDash([npx(1), npx(1)]);\r\n    } else if (style === 'double') {\r\n      ctx.setLineDash([npx(2), 0]);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  line(...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      ctx.beginPath();\r\n      const [x, y] = xys[0];\r\n      ctx.moveTo(npxLine(x), npxLine(y));\r\n      for (let i = 1; i < xys.length; i += 1) {\r\n        const [x1, y1] = xys[i];\r\n        ctx.lineTo(npxLine(x1), npxLine(y1));\r\n      }\r\n      ctx.stroke();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  strokeBorders(box) {\r\n    const { ctx } = this;\r\n    ctx.save();\r\n    // border\r\n    const {\r\n      borderTop, borderRight, borderBottom, borderLeft,\r\n    } = box;\r\n    if (borderTop) {\r\n      this.border(...borderTop);\r\n      // console.log('box.topxys:', box.topxys());\r\n      this.line(...box.topxys());\r\n    }\r\n    if (borderRight) {\r\n      this.border(...borderRight);\r\n      this.line(...box.rightxys());\r\n    }\r\n    if (borderBottom) {\r\n      this.border(...borderBottom);\r\n      this.line(...box.bottomxys());\r\n    }\r\n    if (borderLeft) {\r\n      this.border(...borderLeft);\r\n      this.line(...box.leftxys());\r\n    }\r\n    ctx.restore();\r\n  }\r\n\r\n  dropdown(box) {\r\n    const { ctx } = this;\r\n    const {\r\n      x, y, width, height,\r\n    } = box;\r\n    const sx = x + width - 15;\r\n    const sy = y + height - 15;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.moveTo(npx(sx), npx(sy));\r\n    ctx.lineTo(npx(sx + 8), npx(sy));\r\n    ctx.lineTo(npx(sx + 4), npx(sy + 6));\r\n    ctx.closePath();\r\n    ctx.fillStyle = 'rgba(0, 0, 0, .45)';\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n\r\n  error(box) {\r\n    const { ctx } = this;\r\n    const { x, y, width } = box;\r\n    const sx = x + width - 1;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.moveTo(npx(sx - 8), npx(y - 1));\r\n    ctx.lineTo(npx(sx), npx(y - 1));\r\n    ctx.lineTo(npx(sx), npx(y + 8));\r\n    ctx.closePath();\r\n    ctx.fillStyle = 'rgba(255, 0, 0, .65)';\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n\r\n  frozen(box) {\r\n    const { ctx } = this;\r\n    const { x, y, width } = box;\r\n    const sx = x + width - 1;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.moveTo(npx(sx - 8), npx(y - 1));\r\n    ctx.lineTo(npx(sx), npx(y - 1));\r\n    ctx.lineTo(npx(sx), npx(y + 8));\r\n    ctx.closePath();\r\n    ctx.fillStyle = 'rgba(0, 255, 0, .85)';\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n\r\n  rect(box, dtextcb) {\r\n    const { ctx } = this;\r\n    const {\r\n      x, y, width, height, bgcolor,\r\n    } = box;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.fillStyle = bgcolor || '#fff';\r\n    ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\r\n    ctx.clip();\r\n    ctx.fill();\r\n    dtextcb();\r\n    ctx.restore();\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Draw,\r\n  DrawBox,\r\n  thinLineWidth,\r\n  npx,\r\n};\r\n","// docs\r\nimport './_.prototypes';\r\n\r\n/** default font list\r\n * @type {BaseFont[]}\r\n */\r\nconst baseFonts = [\r\n  { key: 'Arial', title: 'Arial' },\r\n  { key: 'Helvetica', title: 'Helvetica' },\r\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\r\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\r\n  { key: 'Courier New', title: 'Courier New' },\r\n  { key: 'Verdana', title: 'Verdana' },\r\n  { key: 'Lato', title: 'Lato' },\r\n];\r\n\r\n/** default fontSize list\r\n * @type {FontSize[]}\r\n */\r\nconst fontSizes = [\r\n  { pt: 7.5, px: 10 },\r\n  { pt: 8, px: 11 },\r\n  { pt: 9, px: 12 },\r\n  { pt: 10, px: 13 },\r\n  { pt: 10.5, px: 14 },\r\n  { pt: 11, px: 15 },\r\n  { pt: 12, px: 16 },\r\n  { pt: 14, px: 18.7 },\r\n  { pt: 15, px: 20 },\r\n  { pt: 16, px: 21.3 },\r\n  { pt: 18, px: 24 },\r\n  { pt: 22, px: 29.3 },\r\n  { pt: 24, px: 32 },\r\n  { pt: 26, px: 34.7 },\r\n  { pt: 36, px: 48 },\r\n  { pt: 42, px: 56 },\r\n  // { pt: 54, px: 71.7 },\r\n  // { pt: 63, px: 83.7 },\r\n  // { pt: 72, px: 95.6 },\r\n];\r\n\r\n/** map pt to px\r\n * @date 2019-10-10\r\n * @param {fontsizePT} pt\r\n * @returns {fontsizePX}\r\n */\r\nfunction getFontSizePxByPt(pt) {\r\n  for (let i = 0; i < fontSizes.length; i += 1) {\r\n    const fontSize = fontSizes[i];\r\n    if (fontSize.pt === pt) {\r\n      return fontSize.px;\r\n    }\r\n  }\r\n  return pt;\r\n}\r\n\r\n/** transform baseFonts to map\r\n * @date 2019-10-10\r\n * @param {BaseFont[]} [ary=[]]\r\n * @returns {object}\r\n */\r\nfunction fonts(ary = []) {\r\n  const map = {};\r\n  baseFonts.concat(ary).forEach((f) => {\r\n    map[f.key] = f;\r\n  });\r\n  return map;\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  fontSizes,\r\n  fonts,\r\n  baseFonts,\r\n  getFontSizePxByPt,\r\n};\r\n","import { expr2xy, xy2expr } from './alphabet';\r\nimport { numberCalc } from './helper';\r\n\r\n// Converting infix expression to a suffix expression\r\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\r\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\r\nconst infixExprToSuffixExpr = (src) => {\r\n  const operatorStack = [];\r\n  const stack = [];\r\n  let subStrs = []; // SUM, A1, B2, 50 ...\r\n  let fnArgType = 0; // 1 => , 2 => :\r\n  let fnArgOperator = '';\r\n  let fnArgsLen = 1; // A1,A2,A3...\r\n  let oldc = '';\r\n  for (let i = 0; i < src.length; i += 1) {\r\n    const c = src.charAt(i);\r\n    if (c !== ' ') {\r\n      if (c >= 'a' && c <= 'z') {\r\n        subStrs.push(c.toUpperCase());\r\n      } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\r\n        subStrs.push(c);\r\n      } else if (c === '\"') {\r\n        i += 1;\r\n        while (src.charAt(i) !== '\"') {\r\n          subStrs.push(src.charAt(i));\r\n          i += 1;\r\n        }\r\n        stack.push(`\"${subStrs.join('')}`);\r\n        subStrs = [];\r\n      } else if (c === '-' && /[+\\-*/,(]/.test(oldc)) {\r\n        subStrs.push(c);\r\n      } else {\r\n        // console.log('subStrs:', subStrs.join(''), stack);\r\n        if (c !== '(' && subStrs.length > 0) {\r\n          stack.push(subStrs.join(''));\r\n        }\r\n        if (c === ')') {\r\n          let c1 = operatorStack.pop();\r\n          if (fnArgType === 2) {\r\n            // fn argument range => A1:B5\r\n            try {\r\n              const [ex, ey] = expr2xy(stack.pop());\r\n              const [sx, sy] = expr2xy(stack.pop());\r\n              // console.log('::', sx, sy, ex, ey);\r\n              let rangelen = 0;\r\n              for (let x = sx; x <= ex; x += 1) {\r\n                for (let y = sy; y <= ey; y += 1) {\r\n                  stack.push(xy2expr(x, y));\r\n                  rangelen += 1;\r\n                }\r\n              }\r\n              stack.push([c1, rangelen]);\r\n            } catch (e) {\r\n              // console.log(e);\r\n            }\r\n          } else if (fnArgType === 1 || fnArgType === 3) {\r\n            if (fnArgType === 3) stack.push(fnArgOperator);\r\n            // fn argument => A1,A2,B5\r\n            stack.push([c1, fnArgsLen]);\r\n            fnArgsLen = 1;\r\n          } else {\r\n            // console.log('c1:', c1, fnArgType, stack, operatorStack);\r\n            while (c1 !== '(') {\r\n              stack.push(c1);\r\n              if (operatorStack.length <= 0) break;\r\n              c1 = operatorStack.pop();\r\n            }\r\n          }\r\n          fnArgType = 0;\r\n        } else if (c === '=' || c === '>' || c === '<') {\r\n          const nc = src.charAt(i + 1);\r\n          fnArgOperator = c;\r\n          if (nc === '=' || nc === '-') {\r\n            fnArgOperator += nc;\r\n            i += 1;\r\n          }\r\n          fnArgType = 3;\r\n        } else if (c === ':') {\r\n          fnArgType = 2;\r\n        } else if (c === ',') {\r\n          if (fnArgType === 3) {\r\n            stack.push(fnArgOperator);\r\n          }\r\n          fnArgType = 1;\r\n          fnArgsLen += 1;\r\n        } else if (c === '(' && subStrs.length > 0) {\r\n          // function\r\n          operatorStack.push(subStrs.join(''));\r\n        } else {\r\n          // priority: */ > +-\r\n          // console.log('xxxx:', operatorStack, c, stack);\r\n          if (operatorStack.length > 0 && (c === '+' || c === '-')) {\r\n            let top = operatorStack[operatorStack.length - 1];\r\n            if (top !== '(') stack.push(operatorStack.pop());\r\n            if (top === '*' || top === '/') {\r\n              while (operatorStack.length > 0) {\r\n                top = operatorStack[operatorStack.length - 1];\r\n                if (top !== '(') stack.push(operatorStack.pop());\r\n                else break;\r\n              }\r\n            }\r\n          } else if (operatorStack.length > 0) {\r\n            const top = operatorStack[operatorStack.length - 1];\r\n            if (top === '*' || top === '/') stack.push(operatorStack.pop());\r\n          }\r\n          operatorStack.push(c);\r\n        }\r\n        subStrs = [];\r\n      }\r\n      oldc = c;\r\n    }\r\n  }\r\n  if (subStrs.length > 0) {\r\n    stack.push(subStrs.join(''));\r\n  }\r\n  while (operatorStack.length > 0) {\r\n    stack.push(operatorStack.pop());\r\n  }\r\n  return stack;\r\n};\r\n\r\nconst evalSubExpr = (subExpr, cellRender) => {\r\n  const [fl] = subExpr;\r\n  let expr = subExpr;\r\n  if (fl === '\"') {\r\n    return subExpr.substring(1);\r\n  }\r\n  let ret = 1;\r\n  if (fl === '-') {\r\n    expr = subExpr.substring(1);\r\n    ret = -1;\r\n  }\r\n  if (expr[0] >= '0' && expr[0] <= '9') {\r\n    return ret * Number(expr);\r\n  }\r\n  const [x, y] = expr2xy(expr);\r\n  return ret * cellRender(x, y);\r\n};\r\n\r\n// evaluate the suffix expression\r\n// srcStack: <= infixExprToSufixExpr\r\n// formulaMap: {'SUM': {}, ...}\r\n// cellRender: (x, y) => {}\r\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\r\n  const stack = [];\r\n  // console.log(':::::formulaMap:', formulaMap);\r\n  for (let i = 0; i < srcStack.length; i += 1) {\r\n    // console.log(':::>>>', srcStack[i]);\r\n    const expr = srcStack[i];\r\n    const fc = expr[0];\r\n    if (expr === '+') {\r\n      const top = stack.pop();\r\n      stack.push(numberCalc('+', stack.pop(), top));\r\n    } else if (expr === '-') {\r\n      if (stack.length === 1) {\r\n        const top = stack.pop();\r\n        stack.push(numberCalc('*', top, -1));\r\n      } else {\r\n        const top = stack.pop();\r\n        stack.push(numberCalc('-', stack.pop(), top));\r\n      }\r\n    } else if (expr === '*') {\r\n      stack.push(numberCalc('*', stack.pop(), stack.pop()));\r\n    } else if (expr === '/') {\r\n      const top = stack.pop();\r\n      stack.push(numberCalc('/', stack.pop(), top));\r\n    } else if (fc === '=' || fc === '>' || fc === '<') {\r\n      let top = stack.pop();\r\n      if (!Number.isNaN(top)) top = Number(top);\r\n      let left = stack.pop();\r\n      if (!Number.isNaN(left)) left = Number(left);\r\n      let ret = false;\r\n      if (fc === '=') {\r\n        ret = (left === top);\r\n      } else if (expr === '>') {\r\n        ret = (left > top);\r\n      } else if (expr === '>=') {\r\n        ret = (left >= top);\r\n      } else if (expr === '<') {\r\n        ret = (left < top);\r\n      } else if (expr === '<=') {\r\n        ret = (left <= top);\r\n      }\r\n      stack.push(ret);\r\n    } else if (Array.isArray(expr)) {\r\n      const [formula, len] = expr;\r\n      const params = [];\r\n      for (let j = 0; j < len; j += 1) {\r\n        params.push(stack.pop());\r\n      }\r\n      stack.push(formulaMap[formula].render(params.reverse()));\r\n    } else {\r\n      if (cellList.includes(expr)) {\r\n        return 0;\r\n      }\r\n      if ((fc >= 'a' && fc <= 'z') || (fc >= 'A' && fc <= 'Z')) {\r\n        cellList.push(expr);\r\n      }\r\n      stack.push(evalSubExpr(expr, cellRender));\r\n      cellList.pop();\r\n    }\r\n    // console.log('stack:', stack);\r\n  }\r\n  return stack[0];\r\n};\r\n\r\nconst cellRender = (src, formulaMap, getCellText, cellList = []) => {\r\n  if (src[0] === '=') {\r\n    const stack = infixExprToSuffixExpr(src.substring(1));\r\n    if (stack.length <= 0) return src;\r\n    return evalSuffixExpr(\r\n      stack,\r\n      formulaMap,\r\n      (x, y) => cellRender(getCellText(x, y), formulaMap, getCellText, cellList),\r\n      cellList,\r\n    );\r\n  }\r\n  return src;\r\n};\r\n\r\nexport default {\r\n  render: cellRender,\r\n};\r\nexport {\r\n  infixExprToSuffixExpr,\r\n};\r\n","/**\r\n  formula:\r\n    key\r\n    title\r\n    render\r\n*/\r\n/**\r\n * @typedef {object} Formula\r\n * @property {string} key\r\n * @property {function} title\r\n * @property {function} render\r\n */\r\nimport { tf } from '../locale/locale';\r\nimport { numberCalc } from './helper';\r\n\r\n/** @type {Formula[]} */\r\nconst baseFormulas = [\r\n  {\r\n    key: 'SUM',\r\n    title: tf('formula.sum'),\r\n    render: ary => ary.reduce((a, b) => numberCalc('+', a, b), 0),\r\n  },\r\n  {\r\n    key: 'AVERAGE',\r\n    title: tf('formula.average'),\r\n    render: ary => ary.reduce((a, b) => Number(a) + Number(b), 0) / ary.length,\r\n  },\r\n  {\r\n    key: 'MAX',\r\n    title: tf('formula.max'),\r\n    render: ary => Math.max(...ary.map(v => Number(v))),\r\n  },\r\n  {\r\n    key: 'MIN',\r\n    title: tf('formula.min'),\r\n    render: ary => Math.min(...ary.map(v => Number(v))),\r\n  },\r\n  {\r\n    key: 'IF',\r\n    title: tf('formula._if'),\r\n    render: ([b, t, f]) => (b ? t : f),\r\n  },\r\n  {\r\n    key: 'AND',\r\n    title: tf('formula.and'),\r\n    render: ary => ary.every(it => it),\r\n  },\r\n  {\r\n    key: 'OR',\r\n    title: tf('formula.or'),\r\n    render: ary => ary.some(it => it),\r\n  },\r\n  {\r\n    key: 'CONCAT',\r\n    title: tf('formula.concat'),\r\n    render: ary => ary.join(''),\r\n  },\r\n  /* support:  1 + A1 + B2 * 3\r\n  {\r\n    key: 'DIVIDE',\r\n    title: tf('formula.divide'),\r\n    render: ary => ary.reduce((a, b) => Number(a) / Number(b)),\r\n  },\r\n  {\r\n    key: 'PRODUCT',\r\n    title: tf('formula.product'),\r\n    render: ary => ary.reduce((a, b) => Number(a) * Number(b),1),\r\n  },\r\n  {\r\n    key: 'SUBTRACT',\r\n    title: tf('formula.subtract'),\r\n    render: ary => ary.reduce((a, b) => Number(a) - Number(b)),\r\n  },\r\n  */\r\n];\r\n\r\nconst formulas = baseFormulas;\r\n\r\n// const formulas = (formulaAry = []) => {\r\n//   const formulaMap = {};\r\n//   baseFormulas.concat(formulaAry).forEach((f) => {\r\n//     formulaMap[f.key] = f;\r\n//   });\r\n//   return formulaMap;\r\n// };\r\nconst formulam = {};\r\nbaseFormulas.forEach((f) => {\r\n  formulam[f.key] = f;\r\n});\r\n\r\nexport default {\r\n};\r\n\r\nexport {\r\n  formulam,\r\n  formulas,\r\n  baseFormulas,\r\n};\r\n","import { tf } from '../locale/locale';\r\n\r\nconst formatStringRender = v => v;\r\n\r\nconst formatNumberRender = (v) => {\r\n  // match \"-12.1\" or \"12\" or \"12.1\"\r\n  if (/^(-?\\d*.?\\d*)$/.test(v)) {\r\n    const v1 = Number(v).toFixed(2).toString();\r\n    const [first, ...parts] = v1.split('\\\\.');\r\n    return [first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,'), ...parts];\r\n  }\r\n  return v;\r\n};\r\n\r\nconst baseFormats = [\r\n  {\r\n    key: 'normal',\r\n    title: tf('format.normal'),\r\n    type: 'string',\r\n    render: formatStringRender,\r\n  },\r\n  {\r\n    key: 'text',\r\n    title: tf('format.text'),\r\n    type: 'string',\r\n    render: formatStringRender,\r\n  },\r\n  {\r\n    key: 'number',\r\n    title: tf('format.number'),\r\n    type: 'number',\r\n    label: '1,000.12',\r\n    render: formatNumberRender,\r\n  },\r\n  {\r\n    key: 'percent',\r\n    title: tf('format.percent'),\r\n    type: 'number',\r\n    label: '10.12%',\r\n    render: v => `${v}%`,\r\n  },\r\n  {\r\n    key: 'rmb',\r\n    title: tf('format.rmb'),\r\n    type: 'number',\r\n    label: '￥10.00',\r\n    render: v => `￥${formatNumberRender(v)}`,\r\n  },\r\n  {\r\n    key: 'usd',\r\n    title: tf('format.usd'),\r\n    type: 'number',\r\n    label: '$10.00',\r\n    render: v => `$${formatNumberRender(v)}`,\r\n  },\r\n  {\r\n    key: 'eur',\r\n    title: tf('format.eur'),\r\n    type: 'number',\r\n    label: '€10.00',\r\n    render: v => `€${formatNumberRender(v)}`,\r\n  },\r\n  {\r\n    key: 'date',\r\n    title: tf('format.date'),\r\n    type: 'date',\r\n    label: '26/09/2008',\r\n    render: formatStringRender,\r\n  },\r\n  {\r\n    key: 'time',\r\n    title: tf('format.time'),\r\n    type: 'date',\r\n    label: '15:59:00',\r\n    render: formatStringRender,\r\n  },\r\n  {\r\n    key: 'datetime',\r\n    title: tf('format.datetime'),\r\n    type: 'date',\r\n    label: '26/09/2008 15:59:00',\r\n    render: formatStringRender,\r\n  },\r\n  {\r\n    key: 'duration',\r\n    title: tf('format.duration'),\r\n    type: 'date',\r\n    label: '24:01:00',\r\n    render: formatStringRender,\r\n  },\r\n];\r\n\r\n// const formats = (ary = []) => {\r\n//   const map = {};\r\n//   baseFormats.concat(ary).forEach((f) => {\r\n//     map[f.key] = f;\r\n//   });\r\n//   return map;\r\n// };\r\nconst formatm = {};\r\nbaseFormats.forEach((f) => {\r\n  formatm[f.key] = f;\r\n});\r\n\r\nexport default {\r\n};\r\nexport {\r\n  formatm,\r\n  baseFormats,\r\n};\r\n","import { stringAt } from '../core/alphabet';\r\nimport { getFontSizePxByPt } from '../core/font';\r\nimport _cell from '../core/cell';\r\nimport { formulam } from '../core/formula';\r\nimport { formatm } from '../core/format';\r\n\r\nimport {\r\n  Draw, DrawBox, thinLineWidth, npx,\r\n} from '../canvas/draw';\r\n// gobal var\r\nconst cellPaddingWidth = 5;\r\nconst tableFixedHeaderCleanStyle = { fillStyle: '#f4f5f8' };\r\nconst tableGridStyle = {\r\n  fillStyle: '#fff',\r\n  lineWidth: thinLineWidth,\r\n  strokeStyle: '#e6e6e6',\r\n};\r\nfunction tableFixedHeaderStyle() {\r\n  return {\r\n    textAlign: 'center',\r\n    textBaseline: 'middle',\r\n    font: `500 ${npx(12)}px Source Sans Pro`,\r\n    fillStyle: '#585757',\r\n    lineWidth: thinLineWidth(),\r\n    strokeStyle: '#e6e6e6',\r\n  };\r\n}\r\n\r\nfunction getDrawBox(data, rindex, cindex, yoffset = 0) {\r\n  const {\r\n    left, top, width, height,\r\n  } = data.cellRect(rindex, cindex);\r\n  return new DrawBox(left, top + yoffset, width, height, cellPaddingWidth);\r\n}\r\n/*\r\nfunction renderCellBorders(bboxes, translateFunc) {\r\n  const { draw } = this;\r\n  if (bboxes) {\r\n    const rset = new Set();\r\n    // console.log('bboxes:', bboxes);\r\n    bboxes.forEach(({ ri, ci, box }) => {\r\n      if (!rset.has(ri)) {\r\n        rset.add(ri);\r\n        translateFunc(ri);\r\n      }\r\n      draw.strokeBorders(box);\r\n    });\r\n  }\r\n}\r\n*/\r\n\r\nexport function renderCell(draw, data, rindex, cindex, yoffset = 0) {\r\n  const { sortedRowMap, rows, cols } = data;\r\n  if (rows.isHide(rindex) || cols.isHide(cindex)) return;\r\n  let nrindex = rindex;\r\n  if (sortedRowMap.has(rindex)) {\r\n    nrindex = sortedRowMap.get(rindex);\r\n  }\r\n\r\n  const cell = data.getCell(nrindex, cindex);\r\n  if (cell === null) return;\r\n  let frozen = false;\r\n  if ('editable' in cell && cell.editable === false) {\r\n    frozen = true;\r\n  }\r\n\r\n  const style = data.getCellStyleOrDefault(nrindex, cindex);\r\n  const dbox = getDrawBox(data, rindex, cindex, yoffset);\r\n  dbox.bgcolor = style.bgcolor;\r\n  if (style.border !== undefined) {\r\n    dbox.setBorders(style.border);\r\n    // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\r\n    draw.strokeBorders(dbox);\r\n  }\r\n  draw.rect(dbox, () => {\r\n    // render text\r\n    let cellText = '';\r\n    if (!data.settings.evalPaused) {\r\n      cellText = _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\r\n    } else {\r\n      cellText = cell.text || '';\r\n    }\r\n    if (style.format) {\r\n      // console.log(data.formatm, '>>', cell.format);\r\n      cellText = formatm[style.format].render(cellText);\r\n    }\r\n    const font = Object.assign({}, style.font);\r\n    font.size = getFontSizePxByPt(font.size);\r\n    // console.log('style:', style);\r\n    draw.text(cellText, dbox, {\r\n      align: style.align,\r\n      valign: style.valign,\r\n      font,\r\n      color: style.color,\r\n      strike: style.strike,\r\n      underline: style.underline,\r\n    }, style.textwrap);\r\n    // error\r\n    const error = data.validations.getError(rindex, cindex);\r\n    if (error) {\r\n      // console.log('error:', rindex, cindex, error);\r\n      draw.error(dbox);\r\n    }\r\n    if (frozen) {\r\n      draw.frozen(dbox);\r\n    }\r\n  });\r\n}\r\n\r\nfunction renderAutofilter(viewRange) {\r\n  const { data, draw } = this;\r\n  if (viewRange) {\r\n    const { autoFilter } = data;\r\n    if (!autoFilter.active()) return;\r\n    const afRange = autoFilter.hrange();\r\n    if (viewRange.intersects(afRange)) {\r\n      afRange.each((ri, ci) => {\r\n        const dbox = getDrawBox(data, ri, ci);\r\n        draw.dropdown(dbox);\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction renderContent(viewRange, fw, fh, tx, ty) {\r\n  const { draw, data } = this;\r\n  draw.save();\r\n  draw.translate(fw, fh)\r\n    .translate(tx, ty);\r\n\r\n  const { exceptRowSet } = data;\r\n  // const exceptRows = Array.from(exceptRowSet);\r\n  const filteredTranslateFunc = (ri) => {\r\n    const ret = exceptRowSet.has(ri);\r\n    if (ret) {\r\n      const height = data.rows.getHeight(ri);\r\n      draw.translate(0, -height);\r\n    }\r\n    return !ret;\r\n  };\r\n\r\n  const exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri);\r\n  // 1 render cell\r\n  draw.save();\r\n  draw.translate(0, -exceptRowTotalHeight);\r\n  viewRange.each((ri, ci) => {\r\n    renderCell(draw, data, ri, ci);\r\n  }, ri => filteredTranslateFunc(ri));\r\n  draw.restore();\r\n\r\n\r\n  // 2 render mergeCell\r\n  const rset = new Set();\r\n  draw.save();\r\n  draw.translate(0, -exceptRowTotalHeight);\r\n  data.eachMergesInView(viewRange, ({ sri, sci, eri }) => {\r\n    if (!exceptRowSet.has(sri)) {\r\n      renderCell(draw, data, sri, sci);\r\n    } else if (!rset.has(sri)) {\r\n      rset.add(sri);\r\n      const height = data.rows.sumHeight(sri, eri + 1);\r\n      draw.translate(0, -height);\r\n    }\r\n  });\r\n  draw.restore();\r\n\r\n  // 3 render autofilter\r\n  renderAutofilter.call(this, viewRange);\r\n\r\n  draw.restore();\r\n}\r\n\r\nfunction renderSelectedHeaderCell(x, y, w, h) {\r\n  const { draw } = this;\r\n  draw.save();\r\n  draw.attr({ fillStyle: 'rgba(75, 137, 255, 0.08)' })\r\n    .fillRect(x, y, w, h);\r\n  draw.restore();\r\n}\r\n\r\n// viewRange\r\n// type: all | left | top\r\n// w: the fixed width of header\r\n// h: the fixed height of header\r\n// tx: moving distance on x-axis\r\n// ty: moving distance on y-axis\r\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\r\n  const { draw, data } = this;\r\n  const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\r\n  const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\r\n  const nty = ty + h;\r\n  const ntx = tx + w;\r\n\r\n  draw.save();\r\n  // draw rect background\r\n  draw.attr(tableFixedHeaderCleanStyle);\r\n  if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\r\n  if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\r\n\r\n  const {\r\n    sri, sci, eri, eci,\r\n  } = data.selector.range;\r\n  // console.log(data.selectIndexes);\r\n  // draw text\r\n  // text font, align...\r\n  draw.attr(tableFixedHeaderStyle());\r\n  // y-header-text\r\n  if (type === 'all' || type === 'left') {\r\n    data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\r\n      const y = nty + y1;\r\n      const ii = i;\r\n      draw.line([0, y], [w, y]);\r\n      if (sri <= ii && ii < eri + 1) {\r\n        renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\r\n      }\r\n      draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\r\n      if (i > 0 && data.rows.isHide(i - 1)) {\r\n        draw.save();\r\n        draw.attr({ strokeStyle: '#c6c6c6' });\r\n        draw.line([5, y + 5], [w - 5, y + 5]);\r\n        draw.restore();\r\n      }\r\n    });\r\n    draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\r\n    draw.line([w, nty], [w, sumHeight + nty]);\r\n  }\r\n  // x-header-text\r\n  if (type === 'all' || type === 'top') {\r\n    data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\r\n      const x = ntx + x1;\r\n      const ii = i;\r\n      draw.line([x, 0], [x, h]);\r\n      if (sci <= ii && ii < eci + 1) {\r\n        renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\r\n      }\r\n      draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\r\n      if (i > 0 && data.cols.isHide(i - 1)) {\r\n        draw.save();\r\n        draw.attr({ strokeStyle: '#c6c6c6' });\r\n        draw.line([x + 5, 5], [x + 5, h - 5]);\r\n        draw.restore();\r\n      }\r\n    });\r\n    draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\r\n    draw.line([0, h], [sumWidth + ntx, h]);\r\n  }\r\n  draw.restore();\r\n}\r\n\r\nfunction renderFixedLeftTopCell(fw, fh) {\r\n  const { draw } = this;\r\n  draw.save();\r\n  // left-top-cell\r\n  draw.attr({ fillStyle: '#f4f5f8' })\r\n    .fillRect(0, 0, fw, fh);\r\n  draw.restore();\r\n}\r\n\r\nfunction renderContentGrid({\r\n  sri, sci, eri, eci, w, h,\r\n}, fw, fh, tx, ty) {\r\n  const { draw, data } = this;\r\n  const { settings } = data;\r\n\r\n  draw.save();\r\n  draw.attr(tableGridStyle)\r\n    .translate(fw + tx, fh + ty);\r\n  // const sumWidth = cols.sumWidth(sci, eci + 1);\r\n  // const sumHeight = rows.sumHeight(sri, eri + 1);\r\n  // console.log('sumWidth:', sumWidth);\r\n  // draw.clearRect(0, 0, w, h);\r\n  if (!settings.showGrid) {\r\n    draw.restore();\r\n    return;\r\n  }\r\n  // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\r\n  data.rowEach(sri, eri, (i, y, ch) => {\r\n    // console.log('y:', y);\r\n    if (i !== sri) draw.line([0, y], [w, y]);\r\n    if (i === eri) draw.line([0, y + ch], [w, y + ch]);\r\n  });\r\n  data.colEach(sci, eci, (i, x, cw) => {\r\n    if (i !== sci) draw.line([x, 0], [x, h]);\r\n    if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\r\n  });\r\n  draw.restore();\r\n}\r\n\r\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\r\n  const { draw, data } = this;\r\n  const twidth = data.viewWidth() - fw;\r\n  const theight = data.viewHeight() - fh;\r\n  draw.save()\r\n    .translate(fw, fh)\r\n    .attr({ strokeStyle: 'rgba(75, 137, 255, .6)' });\r\n  draw.line([0, fth], [twidth, fth]);\r\n  draw.line([ftw, 0], [ftw, theight]);\r\n  draw.restore();\r\n}\r\n\r\n/** end */\r\nclass Table {\r\n  constructor(el, data) {\r\n    this.el = el;\r\n    this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\r\n    this.data = data;\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    // resize canvas\r\n    const { data } = this;\r\n    const { rows, cols } = data;\r\n    // fixed width of header\r\n    const fw = cols.indexWidth;\r\n    // fixed height of header\r\n    const fh = rows.height;\r\n\r\n    this.draw.resize(data.viewWidth(), data.viewHeight());\r\n    this.clear();\r\n\r\n    const viewRange = data.viewRange();\r\n    // renderAll.call(this, viewRange, data.scroll);\r\n    const tx = data.freezeTotalWidth();\r\n    const ty = data.freezeTotalHeight();\r\n    const { x, y } = data.scroll;\r\n    // 1\r\n    renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\r\n    renderContent.call(this, viewRange, fw, fh, -x, -y);\r\n    renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\r\n    renderFixedLeftTopCell.call(this, fw, fh);\r\n    const [fri, fci] = data.freeze;\r\n    if (fri > 0 || fci > 0) {\r\n      // 2\r\n      if (fri > 0) {\r\n        const vr = viewRange.clone();\r\n        vr.sri = 0;\r\n        vr.eri = fri - 1;\r\n        vr.h = ty;\r\n        renderContentGrid.call(this, vr, fw, fh, tx, 0);\r\n        renderContent.call(this, vr, fw, fh, -x, 0);\r\n        renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\r\n      }\r\n      // 3\r\n      if (fci > 0) {\r\n        const vr = viewRange.clone();\r\n        vr.sci = 0;\r\n        vr.eci = fci - 1;\r\n        vr.w = tx;\r\n        renderContentGrid.call(this, vr, fw, fh, 0, ty);\r\n        renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\r\n        renderContent.call(this, vr, fw, fh, 0, -y);\r\n      }\r\n      // 4\r\n      const freezeViewRange = data.freezeViewRange();\r\n      renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\r\n      renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\r\n      renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\r\n      // 5\r\n      renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.draw.clear();\r\n  }\r\n}\r\n\r\nexport default Table;\r\n","/* global window document */\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport Button from './button';\r\nimport { Draw } from '../canvas/draw';\r\nimport { renderCell } from './table';\r\nimport { t } from '../locale/locale';\r\nimport { eventEL } from './event';\r\n\r\n// resolution: 72 => 595 x 842\r\n// 150 => 1240 x 1754\r\n// 200 => 1654 x 2339\r\n// 300 => 2479 x 3508\r\n// 96 * cm / 2.54 , 96 * cm / 2.54\r\n\r\nconst PAGER_SIZES = [\r\n  ['A3', 11.69, 16.54],\r\n  ['A4', 8.27, 11.69],\r\n  ['A5', 5.83, 8.27],\r\n  ['B4', 9.84, 13.90],\r\n  ['B5', 6.93, 9.84],\r\n];\r\n\r\nconst PAGER_ORIENTATIONS = ['landscape', 'portrait'];\r\n\r\nfunction inches2px(inc) {\r\n  return parseInt(96 * inc, 10);\r\n}\r\n\r\nfunction btnClick(type) {\r\n  if (type === 'cancel') {\r\n    this.el.hide();\r\n  } else {\r\n    this.toPrint();\r\n  }\r\n}\r\n\r\nfunction pagerSizeChange(evt) {\r\n  const { paper } = this;\r\n  const { value } = evt.target;\r\n  const ps = PAGER_SIZES[value];\r\n  paper.w = inches2px(ps[1]);\r\n  paper.h = inches2px(ps[2]);\r\n  // console.log('paper:', ps, paper);\r\n  this.preview();\r\n}\r\nfunction pagerOrientationChange(evt) {\r\n  const { paper } = this;\r\n  const { value } = evt.target;\r\n  const v = PAGER_ORIENTATIONS[value];\r\n  paper.orientation = v;\r\n  this.preview();\r\n}\r\n\r\nexport default class Print {\r\n  constructor(data) {\r\n    this.paper = {\r\n      w: inches2px(PAGER_SIZES[0][1]),\r\n      h: inches2px(PAGER_SIZES[0][2]),\r\n      padding: 50,\r\n      orientation: PAGER_ORIENTATIONS[0],\r\n      get width() {\r\n        return this.orientation === 'landscape' ? this.h : this.w;\r\n      },\r\n      get height() {\r\n        return this.orientation === 'landscape' ? this.w : this.h;\r\n      },\r\n    };\r\n    this.data = data;\r\n    this.el = h('div', `${cssPrefix}-print`)\r\n      .children(\r\n        h('div', `${cssPrefix}-print-bar`)\r\n          .children(\r\n            h('div', '-title').child('Print settings'),\r\n            h('div', '-right').children(\r\n              h('div', `${cssPrefix}-buttons`).children(\r\n                new Button('cancel').on('click', btnClick.bind(this, 'cancel')),\r\n                new Button('next', 'primary').on('click', btnClick.bind(this, 'next')),\r\n              ),\r\n            ),\r\n          ),\r\n        h('div', `${cssPrefix}-print-content`)\r\n          .children(\r\n            this.contentEl = h('div', '-content'),\r\n            h('div', '-sider').child(\r\n              h('form', '').children(\r\n                h('fieldset', '').children(\r\n                  h('label', '').child(`${t('print.size')}`),\r\n                  h('select', '').children(\r\n                    ...PAGER_SIZES.map((it, index) => h('option', '').attr('value', index).child(`${it[0]} ( ${it[1]}''x${it[2]}'' )`)),\r\n                  ).on('change', pagerSizeChange.bind(this)),\r\n                ),\r\n                h('fieldset', '').children(\r\n                  h('label', '').child(`${t('print.orientation')}`),\r\n                  h('select', '').children(\r\n                    ...PAGER_ORIENTATIONS.map((it, index) => h('option', '').attr('value', index).child(`${t('print.orientations')[index]}`)),\r\n                  ).on('change', pagerOrientationChange.bind(this)),\r\n                ),\r\n              ),\r\n            ),\r\n          ),\r\n      ).hide();\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  preview() {\r\n    const { data, paper } = this;\r\n    const { width, height, padding } = paper;\r\n    const iwidth = width - padding * 2;\r\n    const iheight = height - padding * 2;\r\n    const cr = data.contentRange();\r\n    const pages = parseInt(cr.h / iheight, 10) + 1;\r\n    const scale = iwidth / cr.w;\r\n    let left = padding;\r\n    const top = padding;\r\n    if (scale > 1) {\r\n      left += (iwidth - cr.w) / 2;\r\n    }\r\n    let ri = 0;\r\n    let yoffset = 0;\r\n    this.contentEl.html('');\r\n    this.canvases = [];\r\n    const mViewRange = {\r\n      sri: 0,\r\n      sci: 0,\r\n      eri: 0,\r\n      eci: 0,\r\n    };\r\n    for (let i = 0; i < pages; i += 1) {\r\n      let th = 0;\r\n      let yo = 0;\r\n      const wrap = h('div', `${cssPrefix}-canvas-card`);\r\n      const canvas = h('canvas', `${cssPrefix}-canvas`);\r\n      this.canvases.push(canvas.el);\r\n      const draw = new Draw(canvas.el, width, height);\r\n      // cell-content\r\n      draw.save();\r\n      draw.translate(left, top);\r\n      if (scale < 1) draw.scale(scale, scale);\r\n      // console.log('ri:', ri, cr.eri, yoffset);\r\n      for (; ri <= cr.eri; ri += 1) {\r\n        const rh = data.rows.getHeight(ri);\r\n        th += rh;\r\n        if (th < iheight) {\r\n          for (let ci = 0; ci <= cr.eci; ci += 1) {\r\n            renderCell(draw, data, ri, ci, yoffset);\r\n            mViewRange.eci = ci;\r\n          }\r\n        } else {\r\n          yo = -(th - rh);\r\n          break;\r\n        }\r\n      }\r\n      mViewRange.eri = ri;\r\n      draw.restore();\r\n      // merge-cell\r\n      draw.save();\r\n      draw.translate(left, top);\r\n      if (scale < 1) draw.scale(scale, scale);\r\n      const yof = yoffset;\r\n      data.eachMergesInView(mViewRange, ({ sri, sci }) => {\r\n        renderCell(draw, data, sri, sci, yof);\r\n      });\r\n      draw.restore();\r\n\r\n      mViewRange.sri = mViewRange.eri;\r\n      mViewRange.sci = mViewRange.eci;\r\n      yoffset += yo;\r\n      this.contentEl.child(h('div', `${cssPrefix}-canvas-card-wraper`).child(wrap.child(canvas)));\r\n    }\r\n    this.el.show();\r\n  }\r\n\r\n  toPrint() {\r\n    this.el.hide();\r\n    const { paper } = this;\r\n    const iframe = h('iframe', '').hide();\r\n    const { el } = iframe;\r\n    eventEL.document.body.appendChild(el);\r\n    const { contentWindow } = el;\r\n    const idoc = contentWindow.document;\r\n    const style = eventEL.document.createElement('style');\r\n    style.innerHTML = `\r\n      @page { size: ${paper.width}px ${paper.height}px; };\r\n      canvas {\r\n        page-break-before: auto;        \r\n        page-break-after: always;\r\n        image-rendering: pixelated;\r\n      };\r\n    `;\r\n    idoc.head.appendChild(style);\r\n    this.canvases.forEach((it) => {\r\n      const cn = it.cloneNode(false);\r\n      const ctx = cn.getContext('2d');\r\n      // ctx.imageSmoothingEnabled = true;\r\n      ctx.drawImage(it, 0, 0);\r\n      idoc.body.appendChild(cn);\r\n    });\r\n    contentWindow.print();\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport { tf } from '../locale/locale';\r\n\r\nconst menuItems = [\r\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\r\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\r\n  { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\r\n  { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\r\n  { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\r\n  { key: 'divider' },\r\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\r\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\r\n  { key: 'divider' },\r\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\r\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\r\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\r\n  { key: 'hide', title: tf('contextmenu.hide') },\r\n  { key: 'divider' },\r\n  { key: 'validation', title: tf('contextmenu.validation') },\r\n  { key: 'divider' },\r\n  { key: 'cell-printable', title: tf('contextmenu.cellprintable') },\r\n  { key: 'cell-non-printable', title: tf('contextmenu.cellnonprintable') },\r\n  { key: 'divider' },\r\n  { key: 'cell-editable', title: tf('contextmenu.celleditable') },\r\n  { key: 'cell-non-editable', title: tf('contextmenu.cellnoneditable') },\r\n];\r\n\r\nfunction buildMenuItem(item) {\r\n  if (item.key === 'divider') {\r\n    return h('div', `${cssPrefix}-item divider`);\r\n  }\r\n  return h('div', `${cssPrefix}-item`)\r\n    .on('click', () => {\r\n      this.itemClick(item.key);\r\n      this.hide();\r\n    })\r\n    .children(\r\n      item.title(),\r\n      h('div', 'label').child(item.label || ''),\r\n    );\r\n}\r\n\r\nfunction buildMenu() {\r\n  return menuItems.map(it => buildMenuItem.call(this, it));\r\n}\r\n\r\nexport default class ContextMenu {\r\n  constructor(viewFn, isHide = false) {\r\n    this.menuItems = buildMenu.call(this);\r\n    this.el = h('div', `${cssPrefix}-contextmenu`)\r\n      .children(...this.menuItems)\r\n      .hide();\r\n    this.viewFn = viewFn;\r\n    this.itemClick = () => {};\r\n    this.isHide = isHide;\r\n    this.setMode('range');\r\n  }\r\n\r\n  // row-col: the whole rows or the whole cols\r\n  // range: select range\r\n  setMode(mode) {\r\n    const hideEl = this.menuItems[12];\r\n    if (mode === 'row-col') {\r\n      hideEl.show();\r\n    } else {\r\n      hideEl.hide();\r\n    }\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    el.hide();\r\n    unbindClickoutside(el);\r\n  }\r\n\r\n  setPosition(x, y) {\r\n    if (this.isHide) return;\r\n    const { el } = this;\r\n    const { width } = el.show().offset();\r\n    const view = this.viewFn();\r\n    const vhf = view.height / 2;\r\n    let left = x;\r\n    if (view.width - x <= width) {\r\n      left -= width;\r\n    }\r\n    el.css('left', `${left}px`);\r\n    if (y > vhf) {\r\n      el.css('bottom', `${view.height - y}px`)\r\n        .css('max-height', `${y}px`)\r\n        .css('top', 'auto');\r\n    } else {\r\n      el.css('top', `${y}px`)\r\n        .css('max-height', `${view.height - y}px`)\r\n        .css('bottom', 'auto');\r\n    }\r\n    bindClickoutside(el);\r\n  }\r\n}\r\n","import { cssPrefix } from '../../config';\r\nimport tooltip from '../tooltip';\r\nimport { h } from '../element';\r\nimport { t } from '../../locale/locale';\r\n\r\nexport default class Item {\r\n  // tooltip\r\n  // tag: the subclass type\r\n  // shortcut: shortcut key\r\n  constructor(tag, shortcut, value) {\r\n    this.tip = '';\r\n    if (tag) this.tip = t(`toolbar.${tag.replace(/-[a-z]/g, c => c[1].toUpperCase())}`);\r\n    if (shortcut) this.tip += ` (${shortcut})`;\r\n    this.tag = tag;\r\n    this.shortcut = shortcut;\r\n    this.value = value;\r\n    this.el = this.element();\r\n    this.change = () => {};\r\n  }\r\n\r\n  element() {\r\n    const { tip } = this;\r\n    return h('div', `${cssPrefix}-toolbar-btn`)\r\n      .on('mouseenter', (evt) => {\r\n        if (this.tip) tooltip(this.tip, evt.target);\r\n      })\r\n      .attr('data-tooltip', tip);\r\n  }\r\n\r\n  setState() {}\r\n}\r\n","/* global document */\r\nimport { h } from './element';\r\nimport { bind, eventEL } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default function tooltip(html, target) {\r\n  if (target.classList.contains('active')) {\r\n    return;\r\n  }\r\n  const {\r\n    left, top, width, height,\r\n  } = target.getBoundingClientRect();\r\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\r\n  eventEL.document.body.appendChild(el.el);\r\n  const elBox = el.box();\r\n  // console.log('elBox:', elBox);\r\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\r\n    .css('top', `${top + height + 2}px`);\r\n\r\n  bind(target, 'mouseleave', () => {\r\n    if (eventEL.document.body.contains(el.el)) {\r\n      eventEL.document.body.removeChild(el.el);\r\n    }\r\n  });\r\n\r\n  bind(target, 'click', () => {\r\n    if (eventEL.document.body.contains(el.el)) {\r\n      eventEL.document.body.removeChild(el.el);\r\n    }\r\n  });\r\n}\r\n","import Item from './item';\r\n\r\nexport default class DropdownItem extends Item {\r\n  dropdown() {}\r\n\r\n  getValue(v) {\r\n    return v;\r\n  }\r\n\r\n  element() {\r\n    const { tag } = this;\r\n    this.dd = this.dropdown();\r\n    this.dd.change = it => this.change(tag, this.getValue(it));\r\n    return super.element().child(\r\n      this.dd,\r\n    );\r\n  }\r\n\r\n  setState(v) {\r\n    if (v) {\r\n      this.value = v;\r\n      this.dd.setTitle(v);\r\n    }\r\n  }\r\n}\r\n","import { Element, h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Dropdown extends Element {\r\n  constructor(title, width, showArrow, placement, ...children) {\r\n    super('div', `${cssPrefix}-dropdown ${placement}`);\r\n    this.title = title;\r\n    this.change = () => {};\r\n    this.headerClick = () => {};\r\n    if (typeof title === 'string') {\r\n      this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\r\n    } else if (showArrow) {\r\n      this.title.addClass('arrow-left');\r\n    }\r\n    this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\r\n      .css('width', width)\r\n      .hide();\r\n\r\n    this.setContentChildren(...children);\r\n\r\n    this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\r\n    this.headerEl.on('click', () => {\r\n      if (this.contentEl.css('display') !== 'block') {\r\n        this.show();\r\n      } else {\r\n        this.hide();\r\n      }\r\n    }).children(\r\n      this.title,\r\n      showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\r\n        h('div', `${cssPrefix}-icon-img arrow-down`),\r\n      ) : '',\r\n    );\r\n    this.children(this.headerEl, this.contentEl);\r\n  }\r\n\r\n  setContentChildren(...children) {\r\n    this.contentEl.html('');\r\n    if (children.length > 0) {\r\n      this.contentEl.children(...children);\r\n    }\r\n  }\r\n\r\n  setTitle(title) {\r\n    this.title.html(title);\r\n    this.hide();\r\n  }\r\n\r\n  show() {\r\n    const { contentEl } = this;\r\n    contentEl.show();\r\n    this.parent().active();\r\n    bindClickoutside(this.parent(), () => {\r\n      this.hide();\r\n    });\r\n  }\r\n\r\n  hide() {\r\n    this.parent().active(false);\r\n    this.contentEl.hide();\r\n    unbindClickoutside(this.parent());\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction buildItemWithIcon(iconName) {\r\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\r\n}\r\n\r\nexport default class DropdownAlign extends Dropdown {\r\n  constructor(aligns, align) {\r\n    const icon = new Icon(`align-${align}`);\r\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\r\n      .on('click', () => {\r\n        this.setTitle(it);\r\n        this.change(it);\r\n      }));\r\n    super(icon, 'auto', true, 'bottom-left', ...naligns);\r\n  }\r\n\r\n  setTitle(align) {\r\n    this.title.setName(`align-${align}`);\r\n    this.hide();\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownAlign from '../dropdown_align';\r\n\r\nexport default class Align extends DropdownItem {\r\n  constructor(value) {\r\n    super('align', '', value);\r\n  }\r\n\r\n  dropdown() {\r\n    const { value } = this;\r\n    return new DropdownAlign(['left', 'center', 'right'], value);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownAlign from '../dropdown_align';\r\n\r\nexport default class Valign extends DropdownItem {\r\n  constructor(value) {\r\n    super('valign', '', value);\r\n  }\r\n\r\n  dropdown() {\r\n    const { value } = this;\r\n    return new DropdownAlign(['top', 'middle', 'bottom'], value);\r\n  }\r\n}\r\n","import Item from './item';\r\nimport Icon from '../icon';\r\n\r\nexport default class ToggleItem extends Item {\r\n  element() {\r\n    const { tag } = this;\r\n    return super.element()\r\n      .child(new Icon(tag))\r\n      .on('click', () => this.click());\r\n  }\r\n\r\n  click() {\r\n    this.change(this.tag, this.toggle());\r\n  }\r\n\r\n  setState(active) {\r\n    this.el.active(active);\r\n  }\r\n\r\n  toggle() {\r\n    return this.el.toggle();\r\n  }\r\n\r\n  active() {\r\n    return this.el.hasClass('active');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Autofilter extends ToggleItem {\r\n  constructor() {\r\n    super('autofilter');\r\n  }\r\n\r\n  setState() {}\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Bold extends ToggleItem {\r\n  constructor() {\r\n    super('font-bold', 'Ctrl+B');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Italic extends ToggleItem {\r\n  constructor() {\r\n    super('font-italic', 'Ctrl+I');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Strike extends ToggleItem {\r\n  constructor() {\r\n    super('strike', 'Ctrl+U');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Underline extends ToggleItem {\r\n  constructor() {\r\n    super('underline', 'Ctrl+U');\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\r\n\r\nconst themeColors = [\r\n  ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\r\n  ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\r\n  ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\r\n  ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\r\n  ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\r\n];\r\n\r\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\r\n\r\nfunction buildTd(bgcolor) {\r\n  return h('td', '').child(\r\n    h('div', `${cssPrefix}-color-palette-cell`)\r\n      .on('click.stop', () => this.change(bgcolor))\r\n      .css('background-color', bgcolor),\r\n  );\r\n}\r\n\r\nexport default class ColorPalette {\r\n  constructor() {\r\n    this.el = h('div', `${cssPrefix}-color-palette`);\r\n    this.change = () => {};\r\n    const table = h('table', '').children(\r\n      h('tbody', '').children(\r\n        h('tr', `${cssPrefix}-theme-color-placeholders`).children(\r\n          ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\r\n        ),\r\n        ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\r\n          ...it.map(color => buildTd.call(this, color)),\r\n        )),\r\n        h('tr', `${cssPrefix}-standard-colors`).children(\r\n          ...standardColors.map(color => buildTd.call(this, color)),\r\n        ),\r\n      ),\r\n    );\r\n    this.el.child(table);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport ColorPalette from './color_palette';\r\n\r\nexport default class DropdownColor extends Dropdown {\r\n  constructor(iconName, color) {\r\n    const icon = new Icon(iconName)\r\n      .css('height', '16px')\r\n      .css('border-bottom', `3px solid ${color}`);\r\n    const colorPalette = new ColorPalette();\r\n    colorPalette.change = (v) => {\r\n      this.setTitle(v);\r\n      this.change(v);\r\n    };\r\n    super(icon, 'auto', false, 'bottom-left', colorPalette.el);\r\n  }\r\n\r\n  setTitle(color) {\r\n    this.title.css('border-color', color);\r\n    this.hide();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst lineTypes = [\r\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\r\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\r\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n];\r\n\r\nexport default class DropdownLineType extends Dropdown {\r\n  constructor(type) {\r\n    const icon = new Icon('line-type');\r\n    let beforei = 0;\r\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\r\n      .on('click', () => {\r\n        lineTypeEls[beforei].toggle('checked');\r\n        lineTypeEls[iti].toggle('checked');\r\n        beforei = iti;\r\n        this.hide();\r\n        this.change(it);\r\n      })\r\n      .child(\r\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\r\n      ));\r\n\r\n    super(icon, 'auto', false, 'bottom-left', ...lineTypeEls);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Icon from './icon';\r\nimport DropdownColor from './dropdown_color';\r\nimport DropdownLineType from './dropdown_linetype';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction buildTable(...trs) {\r\n  return h('table', '').child(\r\n    h('tbody', '').children(...trs),\r\n  );\r\n}\r\n\r\nfunction buildTd(iconName) {\r\n  return h('td', '').child(\r\n    h('div', `${cssPrefix}-border-palette-cell`).child(\r\n      new Icon(`border-${iconName}`),\r\n    ).on('click', () => {\r\n      this.mode = iconName;\r\n      const { mode, style, color } = this;\r\n      this.change({ mode, style, color });\r\n    }),\r\n  );\r\n}\r\n\r\nexport default class BorderPalette {\r\n  constructor() {\r\n    this.color = '#000';\r\n    this.style = 'thin';\r\n    this.mode = 'all';\r\n    this.change = () => {};\r\n    this.ddColor = new DropdownColor('line-color', this.color);\r\n    this.ddColor.change = (color) => {\r\n      this.color = color;\r\n    };\r\n    this.ddType = new DropdownLineType(this.style);\r\n    this.ddType.change = ([s]) => {\r\n      this.style = s;\r\n    };\r\n    this.el = h('div', `${cssPrefix}-border-palette`);\r\n    const table = buildTable(\r\n      h('tr', '').children(\r\n        h('td', `${cssPrefix}-border-palette-left`).child(\r\n          buildTable(\r\n            h('tr', '').children(\r\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\r\n            ),\r\n            h('tr', '').children(\r\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\r\n            ),\r\n          ),\r\n        ),\r\n        h('td', `${cssPrefix}-border-palette-right`).children(\r\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\r\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\r\n        ),\r\n      ),\r\n    );\r\n    this.el.child(table);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport BorderPalette from './border_palette';\r\n\r\nexport default class DropdownBorder extends Dropdown {\r\n  constructor() {\r\n    const icon = new Icon('border-all');\r\n    const borderPalette = new BorderPalette();\r\n    borderPalette.change = (v) => {\r\n      this.change(v);\r\n      this.hide();\r\n    };\r\n    super(icon, 'auto', false, 'bottom-left', borderPalette.el);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownBorder from '../dropdown_border';\r\n\r\nexport default class Border extends DropdownItem {\r\n  constructor() {\r\n    super('border');\r\n  }\r\n\r\n  dropdown() {\r\n    return new DropdownBorder();\r\n  }\r\n}\r\n","import Item from './item';\r\nimport Icon from '../icon';\r\n\r\nexport default class IconItem extends Item {\r\n  element() {\r\n    return super.element()\r\n      .child(new Icon(this.tag))\r\n      .on('click', () => this.change(this.tag));\r\n  }\r\n\r\n  setState(disabled) {\r\n    this.el.disabled(disabled);\r\n  }\r\n}\r\n","import IconItem from './icon_item';\r\n\r\nexport default class Clearformat extends IconItem {\r\n  constructor() {\r\n    super('clearformat');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Paintformat extends ToggleItem {\r\n  constructor() {\r\n    super('paintformat');\r\n  }\r\n\r\n  setState() {}\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownColor from '../dropdown_color';\r\n\r\nexport default class TextColor extends DropdownItem {\r\n  constructor(color) {\r\n    super('color', undefined, color);\r\n  }\r\n\r\n  dropdown() {\r\n    const { tag, value } = this;\r\n    return new DropdownColor(tag, value);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownColor from '../dropdown_color';\r\n\r\nexport default class FillColor extends DropdownItem {\r\n  constructor(color) {\r\n    super('bgcolor', undefined, color);\r\n  }\r\n\r\n  dropdown() {\r\n    const { tag, value } = this;\r\n    return new DropdownColor(tag, value);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { fontSizes } from '../core/font';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFontSize extends Dropdown {\r\n  constructor() {\r\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\r\n      .on('click', () => {\r\n        this.setTitle(`${it.pt}`);\r\n        this.change(it);\r\n      })\r\n      .child(`${it.pt}`));\r\n    super('10', '60px', true, 'bottom-left', ...nfontSizes);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownFontsize from '../dropdown_fontsize';\r\n\r\nexport default class Format extends DropdownItem {\r\n  constructor() {\r\n    super('font-size');\r\n  }\r\n\r\n  getValue(it) {\r\n    return it.pt;\r\n  }\r\n\r\n  dropdown() {\r\n    return new DropdownFontsize();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { baseFonts } from '../core/font';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFont extends Dropdown {\r\n  constructor() {\r\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\r\n      .on('click', () => {\r\n        this.setTitle(it.title);\r\n        this.change(it);\r\n      })\r\n      .child(it.title));\r\n    super(baseFonts[0].title, '160px', true, 'bottom-left', ...nfonts);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownFont from '../dropdown_font';\r\n\r\nexport default class Font extends DropdownItem {\r\n  constructor() {\r\n    super('font-name');\r\n  }\r\n\r\n  getValue(it) {\r\n    return it.key;\r\n  }\r\n\r\n  dropdown() {\r\n    return new DropdownFont();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { baseFormats } from '../core/format';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFormat extends Dropdown {\r\n  constructor() {\r\n    let nformats = baseFormats.slice(0);\r\n    nformats.splice(2, 0, { key: 'divider' });\r\n    nformats.splice(8, 0, { key: 'divider' });\r\n    nformats = nformats.map((it) => {\r\n      const item = h('div', `${cssPrefix}-item`);\r\n      if (it.key === 'divider') {\r\n        item.addClass('divider');\r\n      } else {\r\n        item.child(it.title())\r\n          .on('click', () => {\r\n            this.setTitle(it.title());\r\n            this.change(it);\r\n          });\r\n        if (it.label) item.child(h('div', 'label').html(it.label));\r\n      }\r\n      return item;\r\n    });\r\n    super('Normal', '220px', true, 'bottom-left', ...nformats);\r\n  }\r\n\r\n  setTitle(key) {\r\n    for (let i = 0; i < baseFormats.length; i += 1) {\r\n      if (baseFormats[i].key === key) {\r\n        this.title.html(baseFormats[i].title());\r\n      }\r\n    }\r\n    this.hide();\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownFormat from '../dropdown_format';\r\n\r\nexport default class Format extends DropdownItem {\r\n  constructor() {\r\n    super('format');\r\n  }\r\n\r\n  getValue(it) {\r\n    return it.key;\r\n  }\r\n\r\n  dropdown() {\r\n    return new DropdownFormat();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport { h } from './element';\r\nimport { baseFormulas } from '../core/formula';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFormula extends Dropdown {\r\n  constructor() {\r\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\r\n      .on('click', () => {\r\n        this.hide();\r\n        this.change(it);\r\n      })\r\n      .child(it.key));\r\n    super(new Icon('formula'), '180px', true, 'bottom-left', ...nformulas);\r\n  }\r\n}\r\n","import DropdownItem from './dropdown_item';\r\nimport DropdownFormula from '../dropdown_formula';\r\n\r\nexport default class Format extends DropdownItem {\r\n  constructor() {\r\n    super('formula');\r\n  }\r\n\r\n  getValue(it) {\r\n    return it.key;\r\n  }\r\n\r\n  dropdown() {\r\n    return new DropdownFormula();\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Freeze extends ToggleItem {\r\n  constructor() {\r\n    super('freeze');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Merge extends ToggleItem {\r\n  constructor() {\r\n    super('merge');\r\n  }\r\n\r\n  setState(active, disabled) {\r\n    this.el.active(active).disabled(disabled);\r\n  }\r\n}\r\n","import IconItem from './icon_item';\r\n\r\nexport default class Redo extends IconItem {\r\n  constructor() {\r\n    super('redo', 'Ctrl+Y');\r\n  }\r\n}\r\n","import IconItem from './icon_item';\r\n\r\nexport default class Undo extends IconItem {\r\n  constructor() {\r\n    super('undo', 'Ctrl+Z');\r\n  }\r\n}\r\n","import IconItem from './icon_item';\r\n\r\nexport default class Print extends IconItem {\r\n  constructor() {\r\n    super('print', 'Ctrl+P');\r\n  }\r\n}\r\n","import ToggleItem from './toggle_item';\r\n\r\nexport default class Textwrap extends ToggleItem {\r\n  constructor() {\r\n    super('textwrap');\r\n  }\r\n}\r\n","import Dropdown from '../dropdown';\r\nimport DropdownItem from './dropdown_item';\r\n\r\nimport { cssPrefix } from '../../config';\r\nimport { h } from '../element';\r\nimport Icon from '../icon';\r\n\r\nclass DropdownMore extends Dropdown {\r\n  constructor() {\r\n    const icon = new Icon('ellipsis');\r\n    const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\r\n    super(icon, 'auto', false, 'bottom-right', moreBtns);\r\n    this.moreBtns = moreBtns;\r\n    this.contentEl.css('max-width', '420px');\r\n  }\r\n}\r\n\r\nexport default class More extends DropdownItem {\r\n  constructor() {\r\n    super('more');\r\n    this.el.hide();\r\n  }\r\n\r\n  dropdown() {\r\n    return new DropdownMore();\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n}\r\n","/* global window */\r\n\r\nimport Align from './align';\r\nimport Valign from './valign';\r\nimport Autofilter from './autofilter';\r\nimport Bold from './bold';\r\nimport Italic from './italic';\r\nimport Strike from './strike';\r\nimport Underline from './underline';\r\nimport Border from './border';\r\nimport Clearformat from './clearformat';\r\nimport Paintformat from './paintformat';\r\nimport TextColor from './text_color';\r\nimport FillColor from './fill_color';\r\nimport FontSize from './font_size';\r\nimport Font from './font';\r\nimport Format from './format';\r\nimport Formula from './formula';\r\nimport Freeze from './freeze';\r\nimport Merge from './merge';\r\nimport Redo from './redo';\r\nimport Undo from './undo';\r\nimport Print from './print';\r\nimport Textwrap from './textwrap';\r\nimport More from './more';\r\nimport Item from './item';\r\n\r\nimport { h } from '../element';\r\nimport { cssPrefix } from '../../config';\r\nimport { bind } from '../event';\r\n\r\nfunction buildDivider() {\r\n  return h('div', `${cssPrefix}-toolbar-divider`);\r\n}\r\n\r\nfunction initBtns2() {\r\n  this.btns2 = [];\r\n  this.items.forEach((it) => {\r\n    if (Array.isArray(it)) {\r\n      it.forEach(({ el }) => {\r\n        const rect = el.box();\r\n        const { marginLeft, marginRight } = el.computedStyle();\r\n        this.btns2.push([el, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\r\n      });\r\n    } else {\r\n      const rect = it.box();\r\n      const { marginLeft, marginRight } = it.computedStyle();\r\n      this.btns2.push([it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\r\n    }\r\n  });\r\n}\r\n\r\nfunction moreResize() {\r\n  const {\r\n    el, btns, moreEl, btns2,\r\n  } = this;\r\n  const { moreBtns, contentEl } = moreEl.dd;\r\n  el.css('width', `${this.widthFn()}px`);\r\n  const elBox = el.box();\r\n\r\n  let sumWidth = 160;\r\n  let sumWidth2 = 12;\r\n  const list1 = [];\r\n  const list2 = [];\r\n  btns2.forEach(([it, w], index) => {\r\n    sumWidth += w;\r\n    if (index === btns2.length - 1 || sumWidth < elBox.width) {\r\n      list1.push(it);\r\n    } else {\r\n      sumWidth2 += w;\r\n      list2.push(it);\r\n    }\r\n  });\r\n  btns.html('').children(...list1);\r\n  moreBtns.html('').children(...list2);\r\n  contentEl.css('width', `${sumWidth2}px`);\r\n  if (list2.length > 0) {\r\n    moreEl.show();\r\n  } else {\r\n    moreEl.hide();\r\n  }\r\n}\r\n\r\nfunction genBtn(it) {\r\n  const btn = new Item();\r\n  btn.el.on('click', () => {\r\n    if (it.onClick) it.onClick(this.data.getData(), this.data);\r\n  });\r\n  btn.tip = it.tip || '';\r\n\r\n  let { el } = it;\r\n\r\n  if (it.icon) {\r\n    el = h('img').attr('src', it.icon);\r\n  }\r\n\r\n  if (el) {\r\n    const icon = h('div', `${cssPrefix}-icon`);\r\n    icon.child(el);\r\n    btn.el.child(icon);\r\n  }\r\n\r\n  return btn;\r\n}\r\n\r\nexport default class Toolbar {\r\n  constructor(data, widthFn, isHide = false) {\r\n    this.data = data;\r\n    this.change = () => {};\r\n    this.widthFn = widthFn;\r\n    this.isHide = isHide;\r\n    const style = data.defaultStyle();\r\n    this.items = [\r\n      [\r\n        this.undoEl = new Undo(),\r\n        this.redoEl = new Redo(),\r\n        new Print(),\r\n        this.paintformatEl = new Paintformat(),\r\n        this.clearformatEl = new Clearformat(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.formatEl = new Format(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.fontEl = new Font(),\r\n        this.fontSizeEl = new FontSize(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.boldEl = new Bold(),\r\n        this.italicEl = new Italic(),\r\n        this.underlineEl = new Underline(),\r\n        this.strikeEl = new Strike(),\r\n        this.textColorEl = new TextColor(style.color),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.fillColorEl = new FillColor(style.bgcolor),\r\n        this.borderEl = new Border(),\r\n        this.mergeEl = new Merge(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.alignEl = new Align(style.align),\r\n        this.valignEl = new Valign(style.valign),\r\n        this.textwrapEl = new Textwrap(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.freezeEl = new Freeze(),\r\n        this.autofilterEl = new Autofilter(),\r\n        this.formulaEl = new Formula(),\r\n      ],\r\n    ];\r\n\r\n    const { extendToolbar = {} } = data.settings;\r\n\r\n    if (extendToolbar.left && extendToolbar.left.length > 0) {\r\n      this.items.unshift(buildDivider());\r\n      const btns = extendToolbar.left.map(genBtn.bind(this));\r\n\r\n      this.items.unshift(btns);\r\n    }\r\n    if (extendToolbar.right && extendToolbar.right.length > 0) {\r\n      this.items.push(buildDivider());\r\n      const btns = extendToolbar.right.map(genBtn.bind(this));\r\n      this.items.push(btns);\r\n    }\r\n\r\n    this.items.push([this.moreEl = new More()]);\r\n\r\n    this.el = h('div', `${cssPrefix}-toolbar`);\r\n    this.btns = h('div', `${cssPrefix}-toolbar-btns`);\r\n\r\n    this.items.forEach((it) => {\r\n      if (Array.isArray(it)) {\r\n        it.forEach((i) => {\r\n          this.btns.child(i.el);\r\n          i.change = (...args) => {\r\n            this.change(...args);\r\n          };\r\n        });\r\n      } else {\r\n        this.btns.child(it.el);\r\n      }\r\n    });\r\n\r\n    this.el.child(this.btns);\r\n    if (isHide) {\r\n      this.el.hide();\r\n    } else {\r\n      this.reset();\r\n      setTimeout(() => {\r\n        initBtns2.call(this);\r\n        moreResize.call(this);\r\n      }, 0);\r\n      bind(window, 'resize', () => {\r\n        moreResize.call(this);\r\n      });\r\n    }\r\n  }\r\n\r\n  paintformatActive() {\r\n    return this.paintformatEl.active();\r\n  }\r\n\r\n  paintformatToggle() {\r\n    this.paintformatEl.toggle();\r\n  }\r\n\r\n  trigger(type) {\r\n    this[`${type}El`].click();\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n    if (this.isHide) return;\r\n    const { data } = this;\r\n    const style = data.getSelectedCellStyle();\r\n    // console.log('canUndo:', data.canUndo());\r\n    this.undoEl.setState(!data.canUndo());\r\n    this.redoEl.setState(!data.canRedo());\r\n    this.mergeEl.setState(data.canUnmerge(), !data.selector.multiple());\r\n    this.autofilterEl.setState(!data.canAutofilter());\r\n    // this.mergeEl.disabled();\r\n    // console.log('selectedCell:', style, cell);\r\n    const { font, format } = style;\r\n    this.formatEl.setState(format);\r\n    this.fontEl.setState(font.name);\r\n    this.fontSizeEl.setState(font.size);\r\n    this.boldEl.setState(font.bold);\r\n    this.italicEl.setState(font.italic);\r\n    this.underlineEl.setState(style.underline);\r\n    this.strikeEl.setState(style.strike);\r\n    this.textColorEl.setState(style.color);\r\n    this.fillColorEl.setState(style.bgcolor);\r\n    this.alignEl.setState(style.align);\r\n    this.valignEl.setState(style.valign);\r\n    this.textwrapEl.setState(style.textwrap);\r\n    // console.log('freeze is Active:', data.freezeIsActive());\r\n    this.freezeEl.setState(data.freezeIsActive());\r\n  }\r\n}\r\n","/* global document */\r\n/* global window */\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\nimport { bind, eventEL, unbind } from './event';\r\n\r\nexport default class Modal {\r\n  constructor(title, content, width = '600px') {\r\n    this.title = title;\r\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\r\n      h('div', `${cssPrefix}-modal-header`).children(\r\n        new Icon('close').on('click.stop', () => this.hide()),\r\n        this.title,\r\n      ),\r\n      h('div', `${cssPrefix}-modal-content`).children(...content),\r\n    ).hide();\r\n  }\r\n\r\n  show() {\r\n    // dimmer\r\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\r\n    eventEL.document.body.appendChild(this.dimmer.el);\r\n    const { width, height } = this.el.show().box();\r\n    const { clientHeight, clientWidth } = eventEL.document.documentElement;\r\n    this.el.offset({\r\n      left: (clientWidth - width) / 2,\r\n      top: (clientHeight - height) / 3,\r\n    });\r\n    window.xkeydownEsc = (evt) => {\r\n      if (evt.keyCode === 27) {\r\n        this.hide();\r\n      }\r\n    };\r\n    bind(window, 'keydown', window.xkeydownEsc);\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    eventEL.document.body.removeChild(this.dimmer.el);\r\n    unbind(window, 'keydown', window.xkeydownEsc);\r\n    delete window.xkeydownEsc;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class FormInput {\r\n  constructor(width, hint) {\r\n    this.vchange = () => {};\r\n    this.el = h('div', `${cssPrefix}-form-input`);\r\n    this.input = h('input', '').css('width', width)\r\n      .on('input', evt => this.vchange(evt))\r\n      .attr('placeholder', hint);\r\n    this.el.child(this.input);\r\n  }\r\n\r\n  focus() {\r\n    setTimeout(() => {\r\n      this.input.el.focus();\r\n    }, 10);\r\n  }\r\n\r\n  hint(v) {\r\n    this.input.attr('placeholder', v);\r\n  }\r\n\r\n  val(v) {\r\n    return this.input.val(v);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Suggest from './suggest';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class FormSelect {\r\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\r\n    this.key = key;\r\n    this.getTitle = getTitle;\r\n    this.vchange = () => {};\r\n    this.el = h('div', `${cssPrefix}-form-select`);\r\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\r\n      this.itemClick(it.key);\r\n      change(it.key);\r\n      this.vchange(it.key);\r\n    }, width, this.el);\r\n    this.el.children(\r\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\r\n      this.suggest.el,\r\n    ).on('click', () => this.show());\r\n  }\r\n\r\n  show() {\r\n    this.suggest.search('');\r\n  }\r\n\r\n  itemClick(it) {\r\n    this.key = it;\r\n    this.itemEl.html(this.getTitle(it));\r\n  }\r\n\r\n  val(v) {\r\n    if (v !== undefined) {\r\n      this.key = v;\r\n      this.itemEl.html(this.getTitle(v));\r\n      return this;\r\n    }\r\n    return this.key;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nconst patterns = {\r\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\r\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\r\n};\r\n\r\n// rule: { required: false, type, pattern: // }\r\nexport default class FormField {\r\n  constructor(input, rule, label, labelWidth) {\r\n    this.label = '';\r\n    this.rule = rule;\r\n    if (label) {\r\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\r\n    }\r\n    this.tip = h('div', 'tip').child('tip').hide();\r\n    this.input = input;\r\n    this.input.vchange = () => this.validate();\r\n    this.el = h('div', `${cssPrefix}-form-field`)\r\n      .children(this.label, input.el, this.tip);\r\n  }\r\n\r\n  isShow() {\r\n    return this.el.css('display') !== 'none';\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    return this;\r\n  }\r\n\r\n  val(v) {\r\n    return this.input.val(v);\r\n  }\r\n\r\n  hint(hint) {\r\n    this.input.hint(hint);\r\n  }\r\n\r\n  validate() {\r\n    const {\r\n      input, rule, tip, el,\r\n    } = this;\r\n    const v = input.val();\r\n    if (rule.required) {\r\n      if (/^\\s*$/.test(v)) {\r\n        tip.html(t('validation.required'));\r\n        el.addClass('error');\r\n        return false;\r\n      }\r\n    }\r\n    if (rule.type || rule.pattern) {\r\n      const pattern = rule.pattern || patterns[rule.type];\r\n      if (!pattern.test(v)) {\r\n        tip.html(t('validation.notMatch'));\r\n        el.addClass('error');\r\n        return false;\r\n      }\r\n    }\r\n    el.removeClass('error');\r\n    return true;\r\n  }\r\n}\r\n","import Modal from './modal';\r\nimport FormInput from './form_input';\r\nimport FormSelect from './form_select';\r\nimport FormField from './form_field';\r\nimport Button from './button';\r\nimport { t } from '../locale/locale';\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst fieldLabelWidth = 100;\r\n\r\nexport default class ModalValidation extends Modal {\r\n  constructor() {\r\n    const mf = new FormField(\r\n      new FormSelect('cell',\r\n        ['cell'], // cell|row|column\r\n        '100%',\r\n        it => t(`dataValidation.modeType.${it}`)),\r\n      { required: true },\r\n      `${t('dataValidation.range')}:`,\r\n      fieldLabelWidth,\r\n    );\r\n    const rf = new FormField(\r\n      new FormInput('120px', 'E3 or E3:F12'),\r\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\r\n    );\r\n    const cf = new FormField(\r\n      new FormSelect('list',\r\n        ['list', 'number', 'date', 'phone', 'email'],\r\n        '100%',\r\n        it => t(`dataValidation.type.${it}`),\r\n        it => this.criteriaSelected(it)),\r\n      { required: true },\r\n      `${t('dataValidation.criteria')}:`,\r\n      fieldLabelWidth,\r\n    );\r\n\r\n    // operator\r\n    const of = new FormField(\r\n      new FormSelect('be',\r\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\r\n        '160px',\r\n        it => t(`dataValidation.operator.${it}`),\r\n        it => this.criteriaOperatorSelected(it)),\r\n      { required: true },\r\n    ).hide();\r\n    // min, max\r\n    const minvf = new FormField(\r\n      new FormInput('70px', '10'),\r\n      { required: true },\r\n    ).hide();\r\n    const maxvf = new FormField(\r\n      new FormInput('70px', '100'),\r\n      { required: true, type: 'number' },\r\n    ).hide();\r\n    // value\r\n    const svf = new FormField(\r\n      new FormInput('120px', 'a,b,c'),\r\n      { required: true },\r\n    );\r\n    const vf = new FormField(\r\n      new FormInput('70px', '10'),\r\n      { required: true, type: 'number' },\r\n    ).hide();\r\n\r\n    super(t('contextmenu.validation'), [\r\n      h('div', `${cssPrefix}-form-fields`).children(\r\n        mf.el,\r\n        rf.el,\r\n      ),\r\n      h('div', `${cssPrefix}-form-fields`).children(\r\n        cf.el,\r\n        of.el,\r\n        minvf.el,\r\n        maxvf.el,\r\n        vf.el,\r\n        svf.el,\r\n      ),\r\n      h('div', `${cssPrefix}-buttons`).children(\r\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\r\n        new Button('remove').on('click', () => this.btnClick('remove')),\r\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\r\n      ),\r\n    ]);\r\n    this.mf = mf;\r\n    this.rf = rf;\r\n    this.cf = cf;\r\n    this.of = of;\r\n    this.minvf = minvf;\r\n    this.maxvf = maxvf;\r\n    this.vf = vf;\r\n    this.svf = svf;\r\n    this.change = () => {};\r\n  }\r\n\r\n  showVf(it) {\r\n    const hint = it === 'date' ? '2018-11-12' : '10';\r\n    const { vf } = this;\r\n    vf.input.hint(hint);\r\n    vf.show();\r\n  }\r\n\r\n  criteriaSelected(it) {\r\n    const {\r\n      of, minvf, maxvf, vf, svf,\r\n    } = this;\r\n    if (it === 'date' || it === 'number') {\r\n      of.show();\r\n      minvf.rule.type = it;\r\n      maxvf.rule.type = it;\r\n      if (it === 'date') {\r\n        minvf.hint('2018-11-12');\r\n        maxvf.hint('2019-11-12');\r\n      } else {\r\n        minvf.hint('10');\r\n        maxvf.hint('100');\r\n      }\r\n      minvf.show();\r\n      maxvf.show();\r\n      vf.hide();\r\n      svf.hide();\r\n    } else {\r\n      if (it === 'list') {\r\n        svf.show();\r\n      } else {\r\n        svf.hide();\r\n      }\r\n      vf.hide();\r\n      of.hide();\r\n      minvf.hide();\r\n      maxvf.hide();\r\n    }\r\n  }\r\n\r\n  criteriaOperatorSelected(it) {\r\n    if (!it) return;\r\n    const {\r\n      minvf, maxvf, vf,\r\n    } = this;\r\n    if (it === 'be' || it === 'nbe') {\r\n      minvf.show();\r\n      maxvf.show();\r\n      vf.hide();\r\n    } else {\r\n      const type = this.cf.val();\r\n      vf.rule.type = type;\r\n      if (type === 'date') {\r\n        vf.hint('2018-11-12');\r\n      } else {\r\n        vf.hint('10');\r\n      }\r\n      vf.show();\r\n      minvf.hide();\r\n      maxvf.hide();\r\n    }\r\n  }\r\n\r\n  btnClick(action) {\r\n    if (action === 'cancel') {\r\n      this.hide();\r\n    } else if (action === 'remove') {\r\n      this.change('remove');\r\n      this.hide();\r\n    } else if (action === 'save') {\r\n      // validate\r\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\r\n      for (let i = 0; i < attrs.length; i += 1) {\r\n        const field = this[attrs[i]];\r\n        // console.log('field:', field);\r\n        if (field.isShow()) {\r\n          // console.log('it:', it);\r\n          if (!field.validate()) return;\r\n        }\r\n      }\r\n\r\n      const mode = this.mf.val();\r\n      const ref = this.rf.val();\r\n      const type = this.cf.val();\r\n      const operator = this.of.val();\r\n      let value = this.svf.val();\r\n      if (type === 'number' || type === 'date') {\r\n        if (operator === 'be' || operator === 'nbe') {\r\n          value = [this.minvf.val(), this.maxvf.val()];\r\n        } else {\r\n          value = this.vf.val();\r\n        }\r\n      }\r\n      // console.log(mode, ref, type, operator, value);\r\n      this.change('save',\r\n        mode,\r\n        ref,\r\n        {\r\n          type, operator, required: false, value,\r\n        });\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  // validation: { mode, ref, validator }\r\n  setValue(v) {\r\n    if (v) {\r\n      const {\r\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\r\n      } = this;\r\n      const {\r\n        mode, ref, validator,\r\n      } = v;\r\n      const {\r\n        type, operator, value,\r\n      } = validator || { type: 'list' };\r\n      mf.val(mode || 'cell');\r\n      rf.val(ref);\r\n      cf.val(type);\r\n      of.val(operator);\r\n      if (Array.isArray(value)) {\r\n        minvf.val(value[0]);\r\n        maxvf.val(value[1]);\r\n      } else {\r\n        svf.val(value || '');\r\n        vf.val(value || '');\r\n      }\r\n      this.criteriaSelected(type);\r\n      this.criteriaOperatorSelected(operator);\r\n    }\r\n    this.show();\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Button from './button';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nfunction buildMenu(clsName) {\r\n  return h('div', `${cssPrefix}-item ${clsName}`);\r\n}\r\n\r\nfunction buildSortItem(it) {\r\n  return buildMenu('state').child(t(`sort.${it}`))\r\n    .on('click.stop', () => this.itemClick(it));\r\n}\r\n\r\nfunction buildFilterBody(items) {\r\n  const { filterbEl, filterValues } = this;\r\n  filterbEl.html('');\r\n  const itemKeys = Object.keys(items);\r\n  itemKeys.forEach((it, index) => {\r\n    const cnt = items[it];\r\n    const active = filterValues.includes(it) ? 'checked' : '';\r\n    filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\r\n      .on('click.stop', () => this.filterClick(index, it))\r\n      .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\r\n  });\r\n}\r\n\r\nfunction resetFilterHeader() {\r\n  const { filterhEl, filterValues, values } = this;\r\n  filterhEl.html(`${filterValues.length} / ${values.length}`);\r\n  filterhEl.checked(filterValues.length === values.length);\r\n}\r\n\r\nexport default class SortFilter {\r\n  constructor() {\r\n    this.filterbEl = h('div', `${cssPrefix}-body`);\r\n    this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\r\n    this.el = h('div', `${cssPrefix}-sort-filter`).children(\r\n      this.sortAscEl = buildSortItem.call(this, 'asc'),\r\n      this.sortDescEl = buildSortItem.call(this, 'desc'),\r\n      buildMenu('divider'),\r\n      h('div', `${cssPrefix}-filter`).children(\r\n        this.filterhEl,\r\n        this.filterbEl,\r\n      ),\r\n      h('div', `${cssPrefix}-buttons`).children(\r\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\r\n        new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\r\n      ),\r\n    ).hide();\r\n    // this.setFilters(['test1', 'test2', 'text3']);\r\n    this.ci = null;\r\n    this.sortDesc = null;\r\n    this.values = null;\r\n    this.filterValues = [];\r\n  }\r\n\r\n  btnClick(it) {\r\n    if (it === 'ok') {\r\n      const { ci, sort, filterValues } = this;\r\n      if (this.ok) {\r\n        this.ok(ci, sort, 'in', filterValues);\r\n      }\r\n    }\r\n    this.hide();\r\n  }\r\n\r\n  itemClick(it) {\r\n    // console.log('it:', it);\r\n    this.sort = it;\r\n    const { sortAscEl, sortDescEl } = this;\r\n    sortAscEl.checked(it === 'asc');\r\n    sortDescEl.checked(it === 'desc');\r\n  }\r\n\r\n  filterClick(index, it) {\r\n    // console.log('index:', index, it);\r\n    const { filterbEl, filterValues, values } = this;\r\n    const children = filterbEl.children();\r\n    if (it === 'all') {\r\n      if (children.length === filterValues.length) {\r\n        this.filterValues = [];\r\n        children.forEach(i => h(i).checked(false));\r\n      } else {\r\n        this.filterValues = Array.from(values);\r\n        children.forEach(i => h(i).checked(true));\r\n      }\r\n    } else {\r\n      const checked = h(children[index]).toggle('checked');\r\n      if (checked) {\r\n        filterValues.push(it);\r\n      } else {\r\n        filterValues.splice(filterValues.findIndex(i => i === it), 1);\r\n      }\r\n    }\r\n    resetFilterHeader.call(this);\r\n  }\r\n\r\n  // v: autoFilter\r\n  // items: {value: cnt}\r\n  // sort { ci, order }\r\n  set(ci, items, filter, sort) {\r\n    this.ci = ci;\r\n    const { sortAscEl, sortDescEl } = this;\r\n    if (sort !== null) {\r\n      this.sort = sort.order;\r\n      sortAscEl.checked(sort.asc());\r\n      sortDescEl.checked(sort.desc());\r\n    } else {\r\n      this.sortDesc = null;\r\n      sortAscEl.checked(false);\r\n      sortDescEl.checked(false);\r\n    }\r\n    // this.setFilters(items, filter);\r\n    this.values = Object.keys(items);\r\n    this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\r\n    buildFilterBody.call(this, items, filter);\r\n    resetFilterHeader.call(this);\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.offset(v).show();\r\n    let tindex = 1;\r\n    bindClickoutside(this.el, () => {\r\n      if (tindex <= 0) {\r\n        this.hide();\r\n      }\r\n      tindex -= 1;\r\n    });\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    unbindClickoutside(this.el);\r\n  }\r\n}\r\n","/* global document */\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\nimport { eventEL } from './event';\r\n\r\nexport function xtoast(title, content) {\r\n  const el = h('div', `${cssPrefix}-toast`);\r\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\r\n  const remove = () => {\r\n    eventEL.document.body.removeChild(el.el);\r\n    eventEL.document.body.removeChild(dimmer.el);\r\n  };\r\n\r\n  el.children(\r\n    h('div', `${cssPrefix}-toast-header`).children(\r\n      new Icon('close').on('click.stop', () => remove()),\r\n      title,\r\n    ),\r\n    h('div', `${cssPrefix}-toast-content`).html(content),\r\n  );\r\n  eventEL.document.body.appendChild(el.el);\r\n  eventEL.document.body.appendChild(dimmer.el);\r\n  // set offset\r\n  const { width, height } = el.box();\r\n  const { clientHeight, clientWidth } = eventEL.document.documentElement;\r\n  el.offset({\r\n    left: (clientWidth - width) / 2,\r\n    top: (clientHeight - height) / 3,\r\n  });\r\n}\r\n\r\nexport default {};\r\n","/* global window */\r\nimport { h } from \"./element\";\r\nimport {\r\n  bind,\r\n  mouseMoveUp,\r\n  bindTouch,\r\n  createEventEmitter,\r\n  eventEL,\r\n} from \"./event\";\r\nimport Resizer from \"./resizer\";\r\nimport Scrollbar from \"./scrollbar\";\r\nimport Selector from \"./selector\";\r\nimport Editor from \"./editor\";\r\nimport Print from \"./print\";\r\nimport ContextMenu from \"./contextmenu\";\r\nimport Table from \"./table\";\r\nimport Toolbar from \"./toolbar/index\";\r\nimport ModalValidation from \"./modal_validation\";\r\nimport SortFilter from \"./sort_filter\";\r\nimport { xtoast } from \"./message\";\r\nimport { cssPrefix } from \"../config\";\r\nimport { formulas } from \"../core/formula\";\r\n\r\n/**\r\n * @desc throttle fn\r\n * @param func function\r\n * @param wait Delay in milliseconds\r\n */\r\nfunction throttle(func, wait) {\r\n  let timeout;\r\n  return (...arg) => {\r\n    const that = this;\r\n    const args = arg;\r\n    if (!timeout) {\r\n      timeout = setTimeout(() => {\r\n        timeout = null;\r\n        func.apply(that, args);\r\n      }, wait);\r\n    }\r\n  };\r\n}\r\n\r\nfunction scrollbarMove() {\r\n  const { data, verticalScrollbar, horizontalScrollbar } = this;\r\n  const { l, t, left, top, width, height } = data.getSelectedRect();\r\n  const tableOffset = this.getTableOffset();\r\n  // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\r\n  if (Math.abs(left) + width > tableOffset.width) {\r\n    horizontalScrollbar.move({ left: l + width - tableOffset.width });\r\n  } else {\r\n    const fsw = data.freezeTotalWidth();\r\n    if (left < fsw) {\r\n      horizontalScrollbar.move({ left: l - 1 - fsw });\r\n    }\r\n  }\r\n  // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\r\n  if (Math.abs(top) + height > tableOffset.height) {\r\n    verticalScrollbar.move({ top: t + height - tableOffset.height - 1 });\r\n  } else {\r\n    const fsh = data.freezeTotalHeight();\r\n    if (top < fsh) {\r\n      verticalScrollbar.move({ top: t - 1 - fsh });\r\n    }\r\n  }\r\n}\r\n\r\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\r\n  if (ri === -1 && ci === -1) return;\r\n  const { table, selector, toolbar, data, contextMenu } = this;\r\n  const cell = data.getCell(ri, ci);\r\n  if (multiple) {\r\n    selector.setEnd(ri, ci, moving);\r\n    this.trigger(\"cells-selected\", cell, selector.range);\r\n  } else {\r\n    // trigger click event\r\n    selector.set(ri, ci, indexesUpdated);\r\n    this.trigger(\"cell-selected\", cell, ri, ci);\r\n  }\r\n  contextMenu.setMode(ri === -1 || ci === -1 ? \"row-col\" : \"range\");\r\n  toolbar.reset();\r\n  table.render();\r\n}\r\n\r\n// multiple: boolean\r\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\r\nfunction selectorMove(multiple, direction) {\r\n  const { selector, data } = this;\r\n  const { rows, cols } = data;\r\n  let [ri, ci] = selector.indexes;\r\n  const { eri, eci } = selector.range;\r\n  if (multiple) {\r\n    [ri, ci] = selector.moveIndexes;\r\n  }\r\n  // console.log('selector.move:', ri, ci);\r\n  if (direction === \"left\") {\r\n    if (ci > 0) ci -= 1;\r\n  } else if (direction === \"right\") {\r\n    if (eci !== ci) ci = eci;\r\n    if (ci < cols.len - 1) ci += 1;\r\n  } else if (direction === \"up\") {\r\n    if (ri > 0) ri -= 1;\r\n  } else if (direction === \"down\") {\r\n    if (eri !== ri) ri = eri;\r\n    if (ri < rows.len - 1) ri += 1;\r\n  } else if (direction === \"row-first\") {\r\n    ci = 0;\r\n  } else if (direction === \"row-last\") {\r\n    ci = cols.len - 1;\r\n  } else if (direction === \"col-first\") {\r\n    ri = 0;\r\n  } else if (direction === \"col-last\") {\r\n    ri = rows.len - 1;\r\n  }\r\n  if (multiple) {\r\n    selector.moveIndexes = [ri, ci];\r\n  }\r\n  selectorSet.call(this, multiple, ri, ci);\r\n  scrollbarMove.call(this);\r\n}\r\n\r\n// private methods\r\nfunction overlayerMousemove(evt) {\r\n  // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\r\n  if (evt.buttons !== 0) return;\r\n  if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\r\n  const { offsetX, offsetY } = evt;\r\n  const { rowResizer, colResizer, tableEl, data } = this;\r\n  const { rows, cols } = data;\r\n  if (offsetX > cols.indexWidth && offsetY > rows.height) {\r\n    rowResizer.hide();\r\n    colResizer.hide();\r\n    return;\r\n  }\r\n  const tRect = tableEl.box();\r\n  const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\r\n  if (cRect.ri >= 0 && cRect.ci === -1) {\r\n    cRect.width = cols.indexWidth;\r\n    rowResizer.show(cRect, {\r\n      width: tRect.width,\r\n    });\r\n    if (rows.isHide(cRect.ri - 1)) {\r\n      rowResizer.showUnhide(cRect.ri);\r\n    } else {\r\n      rowResizer.hideUnhide();\r\n    }\r\n  } else {\r\n    rowResizer.hide();\r\n  }\r\n  if (cRect.ri === -1 && cRect.ci >= 0) {\r\n    cRect.height = rows.height;\r\n    colResizer.show(cRect, {\r\n      height: tRect.height,\r\n    });\r\n    if (cols.isHide(cRect.ci - 1)) {\r\n      colResizer.showUnhide(cRect.ci);\r\n    } else {\r\n      colResizer.hideUnhide();\r\n    }\r\n  } else {\r\n    colResizer.hide();\r\n  }\r\n}\r\n\r\n// let scrollThreshold = 15;\r\nfunction overlayerMousescroll(evt) {\r\n  // scrollThreshold -= 1;\r\n  // if (scrollThreshold > 0) return;\r\n  // scrollThreshold = 15;\r\n\r\n  const { verticalScrollbar, horizontalScrollbar, data } = this;\r\n  const { top } = verticalScrollbar.scroll();\r\n  const { left } = horizontalScrollbar.scroll();\r\n  // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\r\n\r\n  const { rows, cols } = data;\r\n\r\n  // deltaY for vertical delta\r\n  const { deltaY, deltaX } = evt;\r\n  const loopValue = (ii, vFunc) => {\r\n    let i = ii;\r\n    let v = 0;\r\n    do {\r\n      v = vFunc(i);\r\n      i += 1;\r\n    } while (v <= 0);\r\n    return v;\r\n  };\r\n  // console.log('deltaX', deltaX, 'evt.detail', evt.detail);\r\n  // if (evt.detail) deltaY = evt.detail * 40;\r\n  const moveY = (vertical) => {\r\n    if (vertical > 0) {\r\n      // up\r\n      const ri = data.scroll.ri + 1;\r\n      if (ri < rows.len) {\r\n        const rh = loopValue(ri, (i) => rows.getHeight(i));\r\n        verticalScrollbar.move({ top: top + rh - 1 });\r\n      }\r\n    } else {\r\n      // down\r\n      const ri = data.scroll.ri - 1;\r\n      if (ri >= 0) {\r\n        const rh = loopValue(ri, (i) => rows.getHeight(i));\r\n        verticalScrollbar.move({ top: ri === 0 ? 0 : top - rh });\r\n      }\r\n    }\r\n  };\r\n\r\n  // deltaX for Mac horizontal scroll\r\n  const moveX = (horizontal) => {\r\n    if (horizontal > 0) {\r\n      // left\r\n      const ci = data.scroll.ci + 1;\r\n      if (ci < cols.len) {\r\n        const cw = loopValue(ci, (i) => cols.getWidth(i));\r\n        horizontalScrollbar.move({ left: left + cw - 1 });\r\n      }\r\n    } else {\r\n      // right\r\n      const ci = data.scroll.ci - 1;\r\n      if (ci >= 0) {\r\n        const cw = loopValue(ci, (i) => cols.getWidth(i));\r\n        horizontalScrollbar.move({ left: ci === 0 ? 0 : left - cw });\r\n      }\r\n    }\r\n  };\r\n  const tempY = Math.abs(deltaY);\r\n  const tempX = Math.abs(deltaX);\r\n  const temp = Math.max(tempY, tempX);\r\n  // console.log('event:', evt);\r\n  // detail for windows/mac firefox vertical scroll\r\n  if (/Firefox/i.test(eventEL.window.navigator.userAgent))\r\n    throttle(moveY(evt.detail), 50);\r\n  if (temp === tempX) throttle(moveX(deltaX), 50);\r\n  if (temp === tempY) throttle(moveY(deltaY), 50);\r\n}\r\n\r\nfunction overlayerTouch(direction, distance) {\r\n  const { verticalScrollbar, horizontalScrollbar } = this;\r\n  const { top } = verticalScrollbar.scroll();\r\n  const { left } = horizontalScrollbar.scroll();\r\n\r\n  if (direction === \"left\" || direction === \"right\") {\r\n    horizontalScrollbar.move({ left: left - distance });\r\n  } else if (direction === \"up\" || direction === \"down\") {\r\n    verticalScrollbar.move({ top: top - distance });\r\n  }\r\n}\r\n\r\nfunction verticalScrollbarSet() {\r\n  const { data, verticalScrollbar } = this;\r\n  const { height } = this.getTableOffset();\r\n  const erth = data.exceptRowTotalHeight(0, -1);\r\n  // console.log('erth:', erth);\r\n  verticalScrollbar.set(height, data.rows.totalHeight() - erth);\r\n}\r\n\r\nfunction horizontalScrollbarSet() {\r\n  const { data, horizontalScrollbar } = this;\r\n  const { width } = this.getTableOffset();\r\n  if (data) {\r\n    horizontalScrollbar.set(width, data.cols.totalWidth());\r\n  }\r\n}\r\n\r\nfunction sheetFreeze() {\r\n  const { selector, data, editor } = this;\r\n  const [ri, ci] = data.freeze;\r\n  if (ri > 0 || ci > 0) {\r\n    const fwidth = data.freezeTotalWidth();\r\n    const fheight = data.freezeTotalHeight();\r\n    editor.setFreezeLengths(fwidth, fheight);\r\n  }\r\n  selector.resetAreaOffset();\r\n}\r\n\r\nfunction sheetReset() {\r\n  const { tableEl, overlayerEl, overlayerCEl, table, toolbar, selector, el } =\r\n    this;\r\n  const tOffset = this.getTableOffset();\r\n  const vRect = this.getRect();\r\n  tableEl.attr(vRect);\r\n  overlayerEl.offset(vRect);\r\n  overlayerCEl.offset(tOffset);\r\n  el.css(\"width\", `${vRect.width}px`);\r\n  verticalScrollbarSet.call(this);\r\n  horizontalScrollbarSet.call(this);\r\n  sheetFreeze.call(this);\r\n  table.render();\r\n  toolbar.reset();\r\n  selector.reset();\r\n}\r\n\r\nfunction clearClipboard() {\r\n  const { data, selector } = this;\r\n  data.clearClipboard();\r\n  selector.hideClipboard();\r\n}\r\n\r\nfunction copy(evt) {\r\n  const { data, selector } = this;\r\n  if (data.settings.mode === \"read\") return;\r\n  data.copy();\r\n  data.copyToSystemClipboard(evt);\r\n  selector.showClipboard();\r\n}\r\n\r\nfunction cut() {\r\n  const { data, selector } = this;\r\n  if (data.settings.mode === \"read\") return;\r\n  data.cut();\r\n  selector.showClipboard();\r\n}\r\n\r\nfunction paste(what, evt) {\r\n  const { data } = this;\r\n  if (data.settings.mode === \"read\") return;\r\n  if (data.clipboard.isClear()) {\r\n    const resetSheet = () => sheetReset.call(this);\r\n    const eventTrigger = (rows) => {\r\n      this.trigger(\"pasted-clipboard\", rows);\r\n    };\r\n    // pastFromSystemClipboard is async operation, need to tell it how to reset sheet and trigger event after it finishes\r\n    // pasting content from system clipboard\r\n    data.pasteFromSystemClipboard(resetSheet, eventTrigger);\r\n  } else if (data.paste(what, (msg) => xtoast(\"Tip\", msg))) {\r\n    sheetReset.call(this);\r\n  } else if (evt) {\r\n    const cdata = evt.clipboardData.getData(\"text/plain\");\r\n    this.data.pasteFromText(cdata);\r\n    sheetReset.call(this);\r\n  }\r\n}\r\n\r\nfunction hideRowsOrCols() {\r\n  this.data.hideRowsOrCols();\r\n  sheetReset.call(this);\r\n}\r\n\r\nfunction unhideRowsOrCols(type, index) {\r\n  this.data.unhideRowsOrCols(type, index);\r\n  sheetReset.call(this);\r\n}\r\n\r\nfunction autofilter() {\r\n  const { data } = this;\r\n  data.autofilter();\r\n  sheetReset.call(this);\r\n}\r\n\r\nfunction toolbarChangePaintformatPaste() {\r\n  const { toolbar } = this;\r\n  if (toolbar.paintformatActive()) {\r\n    paste.call(this, \"format\");\r\n    clearClipboard.call(this);\r\n    toolbar.paintformatToggle();\r\n  }\r\n}\r\n\r\nfunction overlayerMousedown(evt) {\r\n  // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\r\n  // console.log('evt.target.className:', evt.target.className);\r\n  const { selector, data, table, sortFilter } = this;\r\n  const { offsetX, offsetY } = evt;\r\n  const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\r\n  const cellRect = data.getCellRectByXY(offsetX, offsetY);\r\n  const { left, top, width, height } = cellRect;\r\n  let { ri, ci } = cellRect;\r\n  // sort or filter\r\n  const { autoFilter } = data;\r\n  if (autoFilter.includes(ri, ci)) {\r\n    if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\r\n      const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\r\n      sortFilter.hide();\r\n      sortFilter.set(\r\n        ci,\r\n        items,\r\n        autoFilter.getFilter(ci),\r\n        autoFilter.getSort(ci)\r\n      );\r\n      sortFilter.setOffset({ left, top: top + height + 2 });\r\n      return;\r\n    }\r\n  }\r\n\r\n  // console.log('ri:', ri, ', ci:', ci);\r\n  if (!evt.shiftKey) {\r\n    // console.log('selectorSetStart:::');\r\n    if (isAutofillEl) {\r\n      selector.showAutofill(ri, ci);\r\n    } else {\r\n      selectorSet.call(this, false, ri, ci);\r\n    }\r\n\r\n    // mouse move up\r\n    mouseMoveUp(\r\n      window,\r\n      (e) => {\r\n        // console.log('mouseMoveUp::::');\r\n        ({ ri, ci } = data.getCellRectByXY(e.offsetX, e.offsetY));\r\n        if (isAutofillEl) {\r\n          selector.showAutofill(ri, ci);\r\n        } else if (e.buttons === 1 && !e.shiftKey) {\r\n          selectorSet.call(this, true, ri, ci, true, true);\r\n        }\r\n      },\r\n      () => {\r\n        if (isAutofillEl && selector.arange && data.settings.mode !== \"read\") {\r\n          if (\r\n            data.autofill(selector.arange, \"all\", (msg) => xtoast(\"Tip\", msg))\r\n          ) {\r\n            table.render();\r\n          }\r\n        }\r\n        selector.hideAutofill();\r\n        toolbarChangePaintformatPaste.call(this);\r\n      }\r\n    );\r\n  }\r\n\r\n  if (!isAutofillEl && evt.buttons === 1) {\r\n    if (evt.shiftKey) {\r\n      // console.log('shiftKey::::');\r\n      selectorSet.call(this, true, ri, ci);\r\n    }\r\n  }\r\n}\r\n\r\nfunction editorSetOffset() {\r\n  const { editor, data } = this;\r\n  const sOffset = data.getSelectedRect();\r\n  const tOffset = this.getTableOffset();\r\n  let sPosition = \"top\";\r\n  // console.log('sOffset:', sOffset, ':', tOffset);\r\n  if (sOffset.top > tOffset.height / 2) {\r\n    sPosition = \"bottom\";\r\n  }\r\n  editor.setOffset(sOffset, sPosition);\r\n}\r\n\r\nfunction editorSet() {\r\n  const { editor, data } = this;\r\n  if (data.settings.mode === \"read\") return;\r\n  editorSetOffset.call(this);\r\n  editor.setCell(data.getSelectedCell(), data.getSelectedValidator());\r\n  clearClipboard.call(this);\r\n}\r\n\r\nfunction verticalScrollbarMove(distance) {\r\n  const { data, table, selector } = this;\r\n  data.scrolly(distance, () => {\r\n    selector.resetBRLAreaOffset();\r\n    editorSetOffset.call(this);\r\n    table.render();\r\n  });\r\n}\r\n\r\nfunction horizontalScrollbarMove(distance) {\r\n  const { data, table, selector } = this;\r\n  data.scrollx(distance, () => {\r\n    selector.resetBRTAreaOffset();\r\n    editorSetOffset.call(this);\r\n    table.render();\r\n  });\r\n}\r\n\r\nfunction rowResizerFinished(cRect, distance) {\r\n  const { ri } = cRect;\r\n  const { table, selector, data } = this;\r\n  const { sri, eri } = selector.range;\r\n  if (ri >= sri && ri <= eri) {\r\n    for (let row = sri; row <= eri; row += 1) {\r\n      data.rows.setHeight(row, distance);\r\n    }\r\n  } else {\r\n    data.rows.setHeight(ri, distance);\r\n  }\r\n\r\n  table.render();\r\n  selector.resetAreaOffset();\r\n  verticalScrollbarSet.call(this);\r\n  editorSetOffset.call(this);\r\n}\r\n\r\nfunction colResizerFinished(cRect, distance) {\r\n  const { ci } = cRect;\r\n  const { table, selector, data } = this;\r\n  const { sci, eci } = selector.range;\r\n  if (ci >= sci && ci <= eci) {\r\n    for (let col = sci; col <= eci; col += 1) {\r\n      data.cols.setWidth(col, distance);\r\n    }\r\n  } else {\r\n    data.cols.setWidth(ci, distance);\r\n  }\r\n\r\n  table.render();\r\n  selector.resetAreaOffset();\r\n  horizontalScrollbarSet.call(this);\r\n  editorSetOffset.call(this);\r\n}\r\n\r\nfunction dataSetCellText(text, state = \"finished\") {\r\n  const { data, table } = this;\r\n  // const [ri, ci] = selector.indexes;\r\n  if (data.settings.mode === \"read\") return;\r\n  data.setSelectedCellText(text, state);\r\n  const { ri, ci } = data.selector;\r\n  if (state === \"finished\") {\r\n    table.render();\r\n  } else {\r\n    this.trigger(\"cell-edited\", text, ri, ci);\r\n  }\r\n}\r\n\r\nfunction insertDeleteRowColumn(type) {\r\n  const { data } = this;\r\n  if (data.settings.mode === \"read\") return;\r\n  if (type === \"insert-row\") {\r\n    data.insert(\"row\");\r\n  } else if (type === \"delete-row\") {\r\n    data.delete(\"row\");\r\n  } else if (type === \"insert-column\") {\r\n    data.insert(\"column\");\r\n  } else if (type === \"delete-column\") {\r\n    data.delete(\"column\");\r\n  } else if (type === \"delete-cell\") {\r\n    data.deleteCell();\r\n  } else if (type === \"delete-cell-format\") {\r\n    data.deleteCell(\"format\");\r\n  } else if (type === \"delete-cell-text\") {\r\n    data.deleteCell(\"text\");\r\n  } else if (type === \"cell-printable\") {\r\n    data.setSelectedCellAttr(\"printable\", true);\r\n  } else if (type === \"cell-non-printable\") {\r\n    data.setSelectedCellAttr(\"printable\", false);\r\n  } else if (type === \"cell-editable\") {\r\n    data.setSelectedCellAttr(\"editable\", true);\r\n  } else if (type === \"cell-non-editable\") {\r\n    data.setSelectedCellAttr(\"editable\", false);\r\n  }\r\n  clearClipboard.call(this);\r\n  sheetReset.call(this);\r\n}\r\n\r\nfunction toolbarChange(type, value) {\r\n  const { data } = this;\r\n  if (type === \"undo\") {\r\n    this.undo();\r\n  } else if (type === \"redo\") {\r\n    this.redo();\r\n  } else if (type === \"print\") {\r\n    this.print.preview();\r\n  } else if (type === \"paintformat\") {\r\n    if (value === true) copy.call(this);\r\n    else clearClipboard.call(this);\r\n  } else if (type === \"clearformat\") {\r\n    insertDeleteRowColumn.call(this, \"delete-cell-format\");\r\n  } else if (type === \"link\") {\r\n    // link\r\n  } else if (type === \"chart\") {\r\n    // chart\r\n  } else if (type === \"autofilter\") {\r\n    // filter\r\n    autofilter.call(this);\r\n  } else if (type === \"freeze\") {\r\n    if (value) {\r\n      const { ri, ci } = data.selector;\r\n      this.freeze(ri, ci);\r\n    } else {\r\n      this.freeze(0, 0);\r\n    }\r\n  } else {\r\n    data.setSelectedCellAttr(type, value);\r\n    if (type === \"formula\" && !data.selector.multiple()) {\r\n      editorSet.call(this);\r\n    }\r\n    sheetReset.call(this);\r\n  }\r\n}\r\n\r\nfunction sortFilterChange(ci, order, operator, value) {\r\n  // console.log('sort:', sortDesc, operator, value);\r\n  this.data.setAutoFilter(ci, order, operator, value);\r\n  sheetReset.call(this);\r\n}\r\n\r\nfunction sheetInitEvents() {\r\n  const {\r\n    selector,\r\n    overlayerEl,\r\n    rowResizer,\r\n    colResizer,\r\n    verticalScrollbar,\r\n    horizontalScrollbar,\r\n    editor,\r\n    contextMenu,\r\n    toolbar,\r\n    modalValidation,\r\n    sortFilter,\r\n  } = this;\r\n  // overlayer\r\n  overlayerEl\r\n    .on(\"mousemove\", (evt) => {\r\n      overlayerMousemove.call(this, evt);\r\n    })\r\n    .on(\"mousedown\", (evt) => {\r\n      editor.clear();\r\n      contextMenu.hide();\r\n      // the left mouse button: mousedown → mouseup → click\r\n      // the right mouse button: mousedown → contenxtmenu → mouseup\r\n      if (evt.buttons === 2) {\r\n        if (this.data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\r\n          contextMenu.setPosition(evt.offsetX, evt.offsetY);\r\n        } else {\r\n          overlayerMousedown.call(this, evt);\r\n          contextMenu.setPosition(evt.offsetX, evt.offsetY);\r\n        }\r\n        evt.stopPropagation();\r\n      } else if (evt.detail === 2) {\r\n        editorSet.call(this);\r\n      } else {\r\n        overlayerMousedown.call(this, evt);\r\n      }\r\n    })\r\n    .on(\"mousewheel.stop\", (evt) => {\r\n      overlayerMousescroll.call(this, evt);\r\n    })\r\n    .on(\"mouseout\", (evt) => {\r\n      const { offsetX, offsetY } = evt;\r\n      if (offsetY <= 0) colResizer.hide();\r\n      if (offsetX <= 0) rowResizer.hide();\r\n    });\r\n\r\n  selector.inputChange = (v) => {\r\n    dataSetCellText.call(this, v, \"input\");\r\n    editorSet.call(this);\r\n  };\r\n\r\n  // slide on mobile\r\n  bindTouch(overlayerEl.el, {\r\n    move: (direction, d) => {\r\n      overlayerTouch.call(this, direction, d);\r\n    },\r\n  });\r\n\r\n  // toolbar change\r\n  toolbar.change = (type, value) => toolbarChange.call(this, type, value);\r\n\r\n  // sort filter ok\r\n  sortFilter.ok = (ci, order, o, v) =>\r\n    sortFilterChange.call(this, ci, order, o, v);\r\n\r\n  // resizer finished callback\r\n  rowResizer.finishedFn = (cRect, distance) => {\r\n    rowResizerFinished.call(this, cRect, distance);\r\n  };\r\n  colResizer.finishedFn = (cRect, distance) => {\r\n    colResizerFinished.call(this, cRect, distance);\r\n  };\r\n  // resizer unhide callback\r\n  rowResizer.unhideFn = (index) => {\r\n    unhideRowsOrCols.call(this, \"row\", index);\r\n  };\r\n  colResizer.unhideFn = (index) => {\r\n    unhideRowsOrCols.call(this, \"col\", index);\r\n  };\r\n  // scrollbar move callback\r\n  verticalScrollbar.moveFn = (distance, evt) => {\r\n    verticalScrollbarMove.call(this, distance, evt);\r\n  };\r\n  horizontalScrollbar.moveFn = (distance, evt) => {\r\n    horizontalScrollbarMove.call(this, distance, evt);\r\n  };\r\n  // editor\r\n  editor.change = (state, itext) => {\r\n    dataSetCellText.call(this, itext, state);\r\n  };\r\n  // modal validation\r\n  modalValidation.change = (action, ...args) => {\r\n    if (action === \"save\") {\r\n      this.data.addValidation(...args);\r\n    } else {\r\n      this.data.removeValidation();\r\n    }\r\n  };\r\n  // contextmenu\r\n  contextMenu.itemClick = (type) => {\r\n    // console.log('type:', type);\r\n    if (type === \"validation\") {\r\n      modalValidation.setValue(this.data.getSelectedValidation());\r\n    } else if (type === \"copy\") {\r\n      copy.call(this);\r\n    } else if (type === \"cut\") {\r\n      cut.call(this);\r\n    } else if (type === \"paste\") {\r\n      paste.call(this, \"all\");\r\n    } else if (type === \"paste-value\") {\r\n      paste.call(this, \"text\");\r\n    } else if (type === \"paste-format\") {\r\n      paste.call(this, \"format\");\r\n    } else if (type === \"hide\") {\r\n      hideRowsOrCols.call(this);\r\n    } else {\r\n      insertDeleteRowColumn.call(this, type);\r\n    }\r\n  };\r\n\r\n  bind(window, \"resize\", () => {\r\n    this.reload();\r\n  });\r\n\r\n  bind(window, \"click\", (evt) => {\r\n    this.focusing = overlayerEl.contains(evt.target);\r\n  });\r\n\r\n  bind(window, \"paste\", (evt) => {\r\n    if (!this.focusing) return;\r\n    paste.call(this, \"all\", evt);\r\n    evt.preventDefault();\r\n  });\r\n\r\n  bind(window, \"copy\", (evt) => {\r\n    if (!this.focusing) return;\r\n    copy.call(this, evt);\r\n    evt.preventDefault();\r\n  });\r\n\r\n  // for selector\r\n  bind(window, \"keydown\", (evt) => {\r\n    if (!this.focusing) return;\r\n    const keyCode = evt.keyCode || evt.which;\r\n    const { key, ctrlKey, shiftKey, metaKey } = evt;\r\n    // console.log('keydown.evt: ', keyCode);\r\n    if (ctrlKey || metaKey) {\r\n      // const { sIndexes, eIndexes } = selector;\r\n      // let what = 'all';\r\n      // if (shiftKey) what = 'text';\r\n      // if (altKey) what = 'format';\r\n      switch (keyCode) {\r\n        case 90:\r\n          // undo: ctrl + z\r\n          this.undo();\r\n          evt.preventDefault();\r\n          break;\r\n        case 89:\r\n          // redo: ctrl + y\r\n          this.redo();\r\n          evt.preventDefault();\r\n          break;\r\n        case 67:\r\n          // ctrl + c\r\n          // => copy\r\n          // copy.call(this);\r\n          // evt.preventDefault();\r\n          break;\r\n        case 88:\r\n          // ctrl + x\r\n          cut.call(this);\r\n          evt.preventDefault();\r\n          break;\r\n        case 85:\r\n          // ctrl + u\r\n          toolbar.trigger(\"underline\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 86:\r\n          // ctrl + v\r\n          // => paste\r\n          // evt.preventDefault();\r\n          break;\r\n        case 37:\r\n          // ctrl + left\r\n          selectorMove.call(this, shiftKey, \"row-first\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 38:\r\n          // ctrl + up\r\n          selectorMove.call(this, shiftKey, \"col-first\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 39:\r\n          // ctrl + right\r\n          selectorMove.call(this, shiftKey, \"row-last\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 40:\r\n          // ctrl + down\r\n          selectorMove.call(this, shiftKey, \"col-last\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 32:\r\n          // ctrl + space, all cells in col\r\n          selectorSet.call(this, false, -1, this.data.selector.ci, false);\r\n          evt.preventDefault();\r\n          break;\r\n        case 66:\r\n          // ctrl + B\r\n          toolbar.trigger(\"bold\");\r\n          break;\r\n        case 73:\r\n          // ctrl + I\r\n          toolbar.trigger(\"italic\");\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    } else {\r\n      // console.log('evt.keyCode:', evt.keyCode);\r\n      switch (keyCode) {\r\n        case 32:\r\n          if (shiftKey) {\r\n            // shift + space, all cells in row\r\n            selectorSet.call(this, false, this.data.selector.ri, -1, false);\r\n          }\r\n          break;\r\n        case 27: // esc\r\n          contextMenu.hide();\r\n          clearClipboard.call(this);\r\n          break;\r\n        case 37: // left\r\n          selectorMove.call(this, shiftKey, \"left\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 38: // up\r\n          selectorMove.call(this, shiftKey, \"up\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 39: // right\r\n          selectorMove.call(this, shiftKey, \"right\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 40: // down\r\n          selectorMove.call(this, shiftKey, \"down\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 9: // tab\r\n          editor.clear();\r\n          // shift + tab => move left\r\n          // tab => move right\r\n          selectorMove.call(this, false, shiftKey ? \"left\" : \"right\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 13: // enter\r\n          editor.clear();\r\n          // shift + enter => move up\r\n          // enter => move down\r\n          selectorMove.call(this, false, shiftKey ? \"up\" : \"down\");\r\n          evt.preventDefault();\r\n          break;\r\n        case 8: // backspace\r\n          insertDeleteRowColumn.call(this, \"delete-cell-text\");\r\n          evt.preventDefault();\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n\r\n      if (key === \"Delete\") {\r\n        insertDeleteRowColumn.call(this, \"delete-cell-text\");\r\n        evt.preventDefault();\r\n      } else if (\r\n        (keyCode >= 65 && keyCode <= 90) ||\r\n        (keyCode >= 48 && keyCode <= 57) ||\r\n        (keyCode >= 96 && keyCode <= 105) ||\r\n        evt.key === \"=\"\r\n      ) {\r\n        dataSetCellText.call(this, evt.key, \"input\");\r\n        editorSet.call(this);\r\n      } else if (keyCode === 113) {\r\n        // F2\r\n        editorSet.call(this);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport default class Sheet {\r\n  constructor(targetEl, data) {\r\n    this.eventMap = createEventEmitter();\r\n    const { view, showToolbar, showContextmenu } = data.settings;\r\n    this.el = h(\"div\", `${cssPrefix}-sheet`);\r\n    this.toolbar = new Toolbar(data, view.width, !showToolbar);\r\n    this.print = new Print(data);\r\n    targetEl.children(this.toolbar.el, this.el, this.print.el);\r\n    this.data = data;\r\n    // table\r\n    this.tableEl = h(\"canvas\", `${cssPrefix}-table`);\r\n    // resizer\r\n    this.rowResizer = new Resizer(false, data.rows.height);\r\n    this.colResizer = new Resizer(true, data.cols.minWidth);\r\n    // scrollbar\r\n    this.verticalScrollbar = new Scrollbar(true);\r\n    this.horizontalScrollbar = new Scrollbar(false);\r\n    // editor\r\n    this.editor = new Editor(\r\n      formulas,\r\n      () => this.getTableOffset(),\r\n      data.rows.height\r\n    );\r\n    // data validation\r\n    this.modalValidation = new ModalValidation();\r\n    // contextMenu\r\n    this.contextMenu = new ContextMenu(() => this.getRect(), !showContextmenu);\r\n    // selector\r\n    this.selector = new Selector(data);\r\n    this.overlayerCEl = h(\"div\", `${cssPrefix}-overlayer-content`).children(\r\n      this.editor.el,\r\n      this.selector.el\r\n    );\r\n    this.overlayerEl = h(\"div\", `${cssPrefix}-overlayer`).child(\r\n      this.overlayerCEl\r\n    );\r\n    // sortFilter\r\n    this.sortFilter = new SortFilter();\r\n    // root element\r\n    this.el.children(\r\n      this.tableEl,\r\n      this.overlayerEl.el,\r\n      this.rowResizer.el,\r\n      this.colResizer.el,\r\n      this.verticalScrollbar.el,\r\n      this.horizontalScrollbar.el,\r\n      this.contextMenu.el,\r\n      this.modalValidation.el,\r\n      this.sortFilter.el\r\n    );\r\n    // table\r\n    this.table = new Table(this.tableEl.el, data);\r\n    sheetInitEvents.call(this);\r\n    sheetReset.call(this);\r\n    // init selector [0, 0]\r\n    selectorSet.call(this, false, 0, 0);\r\n  }\r\n\r\n  on(eventName, func) {\r\n    this.eventMap.on(eventName, func);\r\n    return this;\r\n  }\r\n\r\n  trigger(eventName, ...args) {\r\n    const { eventMap } = this;\r\n    eventMap.fire(eventName, args);\r\n  }\r\n\r\n  resetData(data) {\r\n    // before\r\n    this.editor.clear();\r\n    // after\r\n    this.data = data;\r\n    verticalScrollbarSet.call(this);\r\n    horizontalScrollbarSet.call(this);\r\n    this.toolbar.resetData(data);\r\n    this.print.resetData(data);\r\n    this.selector.resetData(data);\r\n    this.table.resetData(data);\r\n  }\r\n\r\n  loadData(data) {\r\n    this.data.setData(data);\r\n    sheetReset.call(this);\r\n    return this;\r\n  }\r\n\r\n  // freeze rows or cols\r\n  freeze(ri, ci) {\r\n    const { data } = this;\r\n    data.setFreeze(ri, ci);\r\n    sheetReset.call(this);\r\n    return this;\r\n  }\r\n\r\n  undo() {\r\n    this.data.undo();\r\n    sheetReset.call(this);\r\n  }\r\n\r\n  redo() {\r\n    this.data.redo();\r\n    sheetReset.call(this);\r\n  }\r\n\r\n  reload() {\r\n    sheetReset.call(this);\r\n    return this;\r\n  }\r\n\r\n  getRect() {\r\n    const { data } = this;\r\n    return { width: data.viewWidth(), height: data.viewHeight() };\r\n  }\r\n\r\n  getTableOffset() {\r\n    const { rows, cols } = this.data;\r\n    const { width, height } = this.getRect();\r\n    return {\r\n      width: width - cols.indexWidth,\r\n      height: height - rows.height,\r\n      left: cols.indexWidth,\r\n      top: rows.height,\r\n    };\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport Icon from './icon';\r\nimport FormInput from './form_input';\r\nimport Dropdown from './dropdown';\r\n// Record: temp not used\r\n// import { xtoast } from './message';\r\nimport { tf } from '../locale/locale';\r\n\r\nclass DropdownMore extends Dropdown {\r\n  constructor(click) {\r\n    const icon = new Icon('ellipsis');\r\n    super(icon, 'auto', false, 'top-left');\r\n    this.contentClick = click;\r\n  }\r\n\r\n  reset(items) {\r\n    const eles = items.map((it, i) => h('div', `${cssPrefix}-item`)\r\n      .css('width', '150px')\r\n      .css('font-weight', 'normal')\r\n      .on('click', () => {\r\n        this.contentClick(i);\r\n        this.hide();\r\n      })\r\n      .child(it));\r\n    this.setContentChildren(...eles);\r\n  }\r\n\r\n  setTitle() {}\r\n}\r\n\r\nconst menuItems = [\r\n  { key: 'delete', title: tf('contextmenu.deleteSheet') },\r\n];\r\n\r\nfunction buildMenuItem(item) {\r\n  return h('div', `${cssPrefix}-item`)\r\n    .child(item.title())\r\n    .on('click', () => {\r\n      this.itemClick(item.key);\r\n      this.hide();\r\n    });\r\n}\r\n\r\nfunction buildMenu() {\r\n  return menuItems.map(it => buildMenuItem.call(this, it));\r\n}\r\n\r\nclass ContextMenu {\r\n  constructor() {\r\n    this.el = h('div', `${cssPrefix}-contextmenu`)\r\n      .css('width', '160px')\r\n      .children(...buildMenu.call(this))\r\n      .hide();\r\n    this.itemClick = () => {};\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    el.hide();\r\n    unbindClickoutside(el);\r\n  }\r\n\r\n  setOffset(offset) {\r\n    const { el } = this;\r\n    el.offset(offset);\r\n    el.show();\r\n    bindClickoutside(el);\r\n  }\r\n}\r\n\r\nexport default class Bottombar {\r\n  constructor(addFunc = () => {},\r\n    swapFunc = () => {},\r\n    deleteFunc = () => {},\r\n    updateFunc = () => {}) {\r\n    this.swapFunc = swapFunc;\r\n    this.updateFunc = updateFunc;\r\n    this.dataNames = [];\r\n    this.activeEl = null;\r\n    this.deleteEl = null;\r\n    this.items = [];\r\n    this.moreEl = new DropdownMore((i) => {\r\n      this.clickSwap2(this.items[i]);\r\n    });\r\n    this.contextMenu = new ContextMenu();\r\n    this.contextMenu.itemClick = deleteFunc;\r\n    this.el = h('div', `${cssPrefix}-bottombar`).children(\r\n      this.contextMenu.el,\r\n      this.menuEl = h('ul', `${cssPrefix}-menu`).child(\r\n        h('li', '').children(\r\n          new Icon('add').on('click', () => {\r\n            addFunc();\r\n          }),\r\n          h('span', '').child(this.moreEl),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  addItem(name, active, options) {\r\n    this.dataNames.push(name);\r\n    const item = h('li', active ? 'active' : '').child(name);\r\n    item.on('click', () => {\r\n      this.clickSwap2(item);\r\n    }).on('contextmenu', (evt) => {\r\n      if (options.mode === 'read') return;\r\n      const { offsetLeft, offsetHeight } = evt.target;\r\n      this.contextMenu.setOffset({ left: offsetLeft, bottom: offsetHeight + 1 });\r\n      this.deleteEl = item;\r\n    }).on('dblclick', () => {\r\n      if (options.mode === 'read') return;\r\n      const v = item.html();\r\n      const input = new FormInput('auto', '');\r\n      input.val(v);\r\n      input.input.on('blur', ({ target }) => {\r\n        const { value } = target;\r\n        const nindex = this.dataNames.findIndex(it => it === v);\r\n        this.renameItem(nindex, value);\r\n        /*\r\n        this.dataNames.splice(nindex, 1, value);\r\n        this.moreEl.reset(this.dataNames);\r\n        item.html('').child(value);\r\n        this.updateFunc(nindex, value);\r\n        */\r\n      });\r\n      item.html('').child(input.el);\r\n      input.focus();\r\n    });\r\n    if (active) {\r\n      this.clickSwap(item);\r\n    }\r\n    this.items.push(item);\r\n    this.menuEl.child(item);\r\n    this.moreEl.reset(this.dataNames);\r\n  }\r\n\r\n  renameItem(index, value) {\r\n    this.dataNames.splice(index, 1, value);\r\n    this.moreEl.reset(this.dataNames);\r\n    this.items[index].html('').child(value);\r\n    this.updateFunc(index, value);\r\n  }\r\n\r\n  clear() {\r\n    this.items.forEach((it) => {\r\n      this.menuEl.removeChild(it.el);\r\n    });\r\n    this.items = [];\r\n    this.dataNames = [];\r\n    this.moreEl.reset(this.dataNames);\r\n  }\r\n\r\n  deleteItem() {\r\n    const { activeEl, deleteEl } = this;\r\n    if (this.items.length > 1) {\r\n      const index = this.items.findIndex(it => it === deleteEl);\r\n      this.items.splice(index, 1);\r\n      this.dataNames.splice(index, 1);\r\n      this.menuEl.removeChild(deleteEl.el);\r\n      this.moreEl.reset(this.dataNames);\r\n      if (activeEl === deleteEl) {\r\n        const [f] = this.items;\r\n        this.activeEl = f;\r\n        this.activeEl.toggle();\r\n        return [index, 0];\r\n      }\r\n      return [index, -1];\r\n    }\r\n    return [-1];\r\n  }\r\n\r\n  clickSwap2(item) {\r\n    const index = this.items.findIndex(it => it === item);\r\n    this.clickSwap(item);\r\n    this.activeEl.toggle();\r\n    this.swapFunc(index);\r\n  }\r\n\r\n  clickSwap(item) {\r\n    if (this.activeEl !== null) {\r\n      this.activeEl.toggle();\r\n    }\r\n    this.activeEl = item;\r\n  }\r\n}\r\n","/* global window, document */\r\nimport { h } from \"./component/element\";\r\nimport DataProxy, { defaultSize } from \"./core/data_proxy\";\r\nimport Sheet from \"./component/sheet\";\r\nimport Bottombar from \"./component/bottombar\";\r\nimport { cssPrefix } from \"./config\";\r\nimport { locale } from \"./locale/locale\";\r\nimport \"./index.less\";\r\nimport { eventEL } from \"./component/event\";\r\n\r\nclass Spreadsheet {\r\n  constructor(selectors, options = {}) {\r\n    let targetEl = selectors;\r\n    this.options = { showBottomBar: true, ...options };\r\n    this.sheetIndex = 1;\r\n    this.datas = [];\r\n    if (typeof selectors === \"string\") {\r\n      targetEl = document.querySelector(selectors);\r\n    }\r\n    eventEL.current = targetEl;\r\n    eventEL.window = targetEl.getRootNode().defaultView;\r\n    eventEL.document = targetEl.getRootNode();\r\n    const observer = new ResizeObserver(([entry]) => {\r\n      let { width, height } = entry.contentRect;\r\n      defaultSize.width = width;\r\n      defaultSize.height = height;\r\n      for (let _resizeefunc of eventEL.resizeFunc) {\r\n        _resizeefunc();\r\n      }\r\n    });\r\n    observer.observe(targetEl);\r\n    this.bottombar = this.options.showBottomBar\r\n      ? new Bottombar(\r\n          () => {\r\n            if (this.options.mode === \"read\") return;\r\n            const d = this.addSheet();\r\n            this.sheet.resetData(d);\r\n          },\r\n          (index) => {\r\n            const d = this.datas[index];\r\n            this.sheet.resetData(d);\r\n          },\r\n          () => {\r\n            this.deleteSheet();\r\n          },\r\n          (index, value) => {\r\n            this.datas[index].name = value;\r\n            this.sheet.trigger(\"change\");\r\n          }\r\n        )\r\n      : null;\r\n    this.data = this.addSheet();\r\n    const rootEl = h(\"div\", `${cssPrefix}`).on(\"contextmenu\", (evt) =>\r\n      evt.preventDefault()\r\n    );\r\n    // create canvas element\r\n    targetEl.appendChild(rootEl.el);\r\n    this.sheet = new Sheet(rootEl, this.data);\r\n    if (this.bottombar !== null) {\r\n      rootEl.child(this.bottombar.el);\r\n    }\r\n  }\r\n\r\n  addSheet(name, active = true) {\r\n    const n = name || `sheet${this.sheetIndex}`;\r\n    const d = new DataProxy(n, this.options);\r\n    d.change = (...args) => {\r\n      this.sheet.trigger(\"change\", ...args);\r\n    };\r\n    this.datas.push(d);\r\n    // console.log('d:', n, d, this.datas);\r\n    if (this.bottombar !== null) {\r\n      this.bottombar.addItem(n, active, this.options);\r\n    }\r\n    this.sheetIndex += 1;\r\n    return d;\r\n  }\r\n\r\n  deleteSheet() {\r\n    if (this.bottombar === null) return;\r\n\r\n    const [oldIndex, nindex] = this.bottombar.deleteItem();\r\n    if (oldIndex >= 0) {\r\n      this.datas.splice(oldIndex, 1);\r\n      if (nindex >= 0) this.sheet.resetData(this.datas[nindex]);\r\n      this.sheet.trigger(\"change\");\r\n    }\r\n  }\r\n\r\n  loadData(data) {\r\n    const ds = Array.isArray(data) ? data : [data];\r\n    if (this.bottombar !== null) {\r\n      this.bottombar.clear();\r\n    }\r\n    this.datas = [];\r\n    if (ds.length > 0) {\r\n      for (let i = 0; i < ds.length; i += 1) {\r\n        const it = ds[i];\r\n        const nd = this.addSheet(it.name, i === 0);\r\n        nd.setData(it);\r\n        if (i === 0) {\r\n          this.sheet.resetData(nd);\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    return this.datas.map((it) => it.getData());\r\n  }\r\n\r\n  cellText(ri, ci, text, sheetIndex = 0) {\r\n    this.datas[sheetIndex].setCellText(ri, ci, text, \"finished\");\r\n    return this;\r\n  }\r\n\r\n  cell(ri, ci, sheetIndex = 0) {\r\n    return this.datas[sheetIndex].getCell(ri, ci);\r\n  }\r\n\r\n  cellStyle(ri, ci, sheetIndex = 0) {\r\n    return this.datas[sheetIndex].getCellStyle(ri, ci);\r\n  }\r\n\r\n  reRender() {\r\n    this.sheet.table.render();\r\n    return this;\r\n  }\r\n\r\n  on(eventName, func) {\r\n    this.sheet.on(eventName, func);\r\n    return this;\r\n  }\r\n\r\n  validate() {\r\n    const { validations } = this.data;\r\n    return validations.errors.size <= 0;\r\n  }\r\n\r\n  change(cb) {\r\n    this.sheet.on(\"change\", cb);\r\n    return this;\r\n  }\r\n\r\n  static locale(lang, message) {\r\n    locale(lang, message);\r\n  }\r\n}\r\n\r\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\r\n\r\n// if (window) {\r\n//   window.x_spreadsheet = spreadsheet;\r\n//   window.x_spreadsheet.locale = (lang, message) => locale(lang, message);\r\n// }\r\n\r\nexport default Spreadsheet;\r\nexport { spreadsheet };\r\n"],"sourceRoot":""}