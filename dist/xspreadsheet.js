!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e){},function(t,e,r){},function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.r(e),r.d(e,"spreadsheet",(function(){return gs}));var l={current:window,window:window,document:document,resizeFunc:new Set};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.window,e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;t===window&&(t=l.window),"resize"!==e?t.addEventListener(e,r):l.resizeFunc.add(r)}function u(t,e,r){t===window&&(t=l.window),"resize"!==e?t.removeEventListener(e,r):l.resizeFunc.delete(r)}function c(t){t.xclickoutside&&(u(l.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function f(t,e){t.xclickoutside=function(r){2===r.detail||t.contains(r.target)||(e?e(t):(t.hide(),c(t)))},a(l.document.body,"click",t.xclickoutside)}function s(t,e,r){a(t,"mousemove",e),t.xEvtUp=function(n){u(t,"mousemove",e),u(t,"mouseup",t.xEvtUp),r(n)},a(t,"mouseup",t.xEvtUp)}function h(t,e,r,n){Math.abs(t)>Math.abs(e)?n(t>0?"right":"left",t,r):n(e>0?"down":"up",e,r)}function y(){var t=new Map;function e(e,r){var n;return t.has(e)&&(n=t.get(e),Array.isArray(n)&&n.push(r)||!1)||t.set(e,[].concat(r))}function r(e,r){var n,i;return t.has(e)&&(n=t.get(e),(i=n.indexOf(r))>=0&&n.splice(i,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,n){return e(t,(function e(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];n.call.apply(n,[null].concat(o)),r(t,e)}))},fire:function(e,r){return t.has(e)&&function(){var o,l=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw l}}}}(t.get(e));try{for(l.s();!(o=l.n()).done;){var a=o.value;a.call.apply(a,[null].concat(n(r)))}}catch(t){l.e(t)}finally{l.f()}}()},removeListener:r,removeAllListeners:function(){t.clear()}}}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==p(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===p(o)?o:String(o)),n)}var i,o}var g=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";b(this,t),"string"==typeof e?(this.el=l.document.createElement(e),this.el.className=r):this.el=e,this.data={}}var e,r,n;return e=t,(r=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var r=v(t.split(".")),n=r[0],i=r.slice(1),o=n;return"mousewheel"===o&&/Firefox/i.test(l.window.navigator.userAgent)&&(o="DOMMouseScroll"),this.el.addEventListener(o,(function(t){e(t);for(var r=0;r<i.length;r+=1){var n=i[r];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=l.document.createTextNode(e):e instanceof t&&(r=e.el),this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){r.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&m(e.prototype,r),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new g(t,e)};r(0);function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var j=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function k(t){for(var e="",r=t;r>=j.length;)r/=j.length,r-=1,e+=j[parseInt(r,10)%j.length];return e+=j[t%j.length]}function P(t){for(var e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function E(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n);return[P(e),parseInt(r,10)-1]}function x(t,e){return"".concat(k(t)).concat(e+1)}function T(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===r)return t;var i=E(t),o=S(i,2),l=o[0],a=o[1];return n(l,a)?x(l+e,a+r):t}function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==C(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===C(o)?o:String(o)),n)}var i,o}var D=function(){function t(e,r,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;A(this,t),this.sri=e,this.sci=r,this.eri=n,this.eci=i,this.w=o,this.h=l}var e,r,n;return e=t,n=[{key:"valueOf",value:function(e){var r=e.split(":"),n=R(E(r[0]),2),i=n[0],o=n[1],l=o,a=i;if(r.length>1){var u=R(E(r[1]),2);a=u[0],l=u[1]}return new t(o,i,l,a)}}],(r=[{key:"set",value:function(t,e,r,n){this.sri=t,this.sci=e,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];if(1===n.length){var o=E(n[0]),l=R(o,2);e=l[0],t=l[1]}else 2===n.length&&(t=n[0],e=n[1]);var a=this.sri,u=this.sci,c=this.eri,f=this.eci;return a<=t&&t<=c&&u<=e&&e<=f}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,i=this.eri,o=this.eci,l=r;l<=i;l+=1)if(e(l))for(var a=n;a<=o;a+=1)t(l,a)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,n=this.sci,i=this.eri,o=this.eci;return new t(e.sri<r?e.sri:r,e.sci<n?e.sci:n,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var r=[],n=function(e,n,i,o){r.push(new t(e,n,i,o))},i=this.sri,o=this.sci,l=this.eri,a=this.eci,u=e.sri-i,c=e.sci-o,f=l-e.eri,s=a-e.eci;return u>0?(n(i,o,e.sri-1,a),f>0?(n(e.eri+1,o,l,a),c>0&&n(e.sri,o,e.eri,e.sci-1),s>0&&n(e.sri,e.eci+1,e.eri,a)):(c>0&&n(e.sri,o,l,e.sci-1),s>0&&n(e.sri,e.eci+1,l,a))):f>0&&(n(e.eri+1,o,l,a),c>0&&n(i,o,e.eri,e.sci-1),s>0&&n(i,e.eci+1,e.eri,a)),c>0?(n(i,o,l,e.sci-1),s>0?(n(i,e.eri+1,l,a),u>0&&n(i,e.sci,e.sri-1,e.eci),f>0&&n(e.sri+1,e.sci,l,e.eci)):(u>0&&n(i,e.sci,e.sri-1,a),f>0&&n(e.sri+1,e.sci,l,a))):s>0&&(n(l,e.eci+1,l,a),u>0&&n(i,o,e.sri-1,e.eci),f>0&&n(e.eri+1,o,l,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,n=this.eci,i=x(e,t);return this.multiple()&&(i="".concat(i,":").concat(x(n,r))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&I(e.prototype,r),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==N(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===N(o)?o:String(o)),n)}var i,o}var M=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new D(0,0,0,0),this.ri=0,this.ci=0}var e,r,n;return e=t,(r=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&z(e.prototype,r),n&&z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==B(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===B(o)?o:String(o)),n)}var i,o}function F(t,e,r){return e&&H(t.prototype,e),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var W=F((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==V(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===V(o)?o:String(o)),n)}var i,o}var $=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,r,n;return e=t,(r=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}},{key:"redo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canRedo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}])&&U(e.prototype,r),n&&U(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===q(o)?o:String(o)),n)}var i,o}var Y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,r,n;return e=t,(r=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&L(e.prototype,r),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==X(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===X(o)?o:String(o)),n)}var i,o}function J(t,e,r){return e&&K(t.prototype,e),r&&K(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var G=function(){function t(e,r,n){Z(this,t),this.ci=e,this.operator=r,this.value=n}return J(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,r=this.value;return"all"===e||"in"===e&&r.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),Q=function(){function t(e,r){Z(this,t),this.ci=e,this.order=r}return J(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),tt=function(){function t(){Z(this,t),this.ref=null,this.filters=[],this.sort=null}return J(t,[{key:"setData",value:function(t){var e=t.ref,r=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=r.map((function(t){return new G(t.ci,t.operator,t.value)})),n&&(this.sort=new Q(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,r=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(t,e,r){var n=this.getFilter(t);null==n?this.filters.push(new G(t,e,r)):n.set(e,r)}},{key:"setSort",value:function(t,e){this.sort=e?new Q(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,r=0;r<e.length;r+=1)if(e[r].ci===t)return e[r];return null}},{key:"filteredRows",value:function(t){var e=new Set,r=new Set;if(this.active())for(var n=this.range(),i=n.sri,o=n.eri,l=this.filters,a=i+1;a<=o;a+=1)for(var u=0;u<l.length;u+=1){var c=l[u],f=t(a,c.ci),s=f?f.text:"";if(!c.includes(s)){e.add(a);break}r.add(a)}return{rset:e,fset:r}}},{key:"items",value:function(t,e){var r={};if(this.active())for(var n=this.range(),i=n.sri,o=n.eri,l=i+1;l<=o;l+=1){var a=e(l,t);if(null===a||/^\s*$/.test(a.text))r[""]=(r[""]||0)+1;else{var u=a.text,c=(r[u]||0)+1;r[u]=c}}return r}},{key:"range",value:function(){return D.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function et(t){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==et(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===et(o)?o:String(o)),n)}var i,o}var it=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];rt(this,t),this._=e}var e,r,n;return e=t,(r=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,r,n){this._.forEach((function(i){var o=i.sri,l=i.sci,a=i.eri,u=i.eci,c=i;"row"===t?o>=e?(c.sri+=r,c.eri+=r):o<e&&e<=a&&(c.eri+=r,n(o,l,r,0)):"column"===t&&(l>=e?(c.sci+=r,c.eci+=r):l<e&&e<=u&&(c.eci+=r,n(o,l,0,r)))}))}},{key:"move",value:function(t,e,r){this._.forEach((function(n){var i=n;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=r,i.eci+=r)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return D.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&nt(e.prototype,r),n&&nt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var ot=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((function(r){Object.keys(r).forEach((function(n){var i=r[n];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[n]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[n]=e[n]||{},t(e[n],i)):e[n]=i}))})),e};function lt(t){for(var e="".concat(t),r=0,n=!1,i=0;i<e.length;i+=1)!0===n&&(r+=1),"."===e.charAt(i)&&(n=!0);return r}function at(t,e,r){if(Number.isNaN(e)||Number.isNaN(r))return e+t+r;var n=lt(e),i=lt(r),o=Number(e),l=Number(r),a=0;if("-"===t)a=o-l;else if("+"===t)a=o+l;else if("*"===t)a=o*l;else if("/"===t)return lt(a=o/l)>5?a.toFixed(2):a;return a.toFixed(Math.max(n,i))}var ut={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return ot.apply(void 0,[{}].concat(e))},equals:function t(e,r){var n=Object.keys(e);if(n.length!==Object.keys(r).length)return!1;for(var i=0;i<n.length;i+=1){var o=n[i],l=e[o],a=r[o];if(void 0===a)return!1;if("string"==typeof l||"number"==typeof l||"boolean"==typeof l){if(l!==a)return!1}else if(Array.isArray(l)){if(l.length!==a.length)return!1;for(var u=0;u<l.length;u+=1)if(!t(l[u],a[u]))return!1}else if("function"!=typeof l&&!Array.isArray(l)&&l instanceof Object&&!t(l,a))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(t[r]!==e[r])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,n=0;return Object.keys(t).forEach((function(i){r+=e(t[i],i),n+=1})),[r,n]},rangeEach:function(t,e,r){for(var n=t;n<e;n+=1)r(n)},rangeSum:function(t,e,r){for(var n=0,i=t;i<e;i+=1)n+=r(i);return n},rangeReduceIf:function(t,e,r,n,i,o){for(var l=r,a=n,u=t;u<e&&!(l>i);u+=1)l+=a=o(u);return[u,l-a,a]},deleteProperty:function(t,e){var r=t["".concat(e)];return delete t["".concat(e)],r},numberCalc:at};function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return st(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return st(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ct(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ct(o)?o:String(o)),n)}var i,o}var yt=function(){function t(e){var r=e.len,n=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.height=n}var e,r,n;return e=t,(r=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,r){var n=this;return ut.rangeSum(t,e,(function(t){return r&&r.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var r=this.get(t);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[e]?r.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var r=this.getCell(t,e);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var r=this.getOrNew(t);return r.cells[e]=r.cells[e]||{},r.cells[e]}},{key:"setCell",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===n?i.cells[e]=r:"text"===n?(i.cells[e]=i.cells[e]||{},i.cells[e].text=r.text):"format"===n&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=r.style,r.merge&&(i.cells[e].merge=r.merge))}},{key:"setCellText",value:function(t,e,r){var n=this.getCellOrNew(t,e);!1!==n.editable&&(n.text=r)}},{key:"copyPaste",value:function(t,e,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},l=t.sri,a=t.sci,u=t.eri,c=t.eci,f=e.sri,s=e.sci,h=e.eri,y=e.eci,p=t.size(),v=ft(p,2),d=v[0],b=v[1],m=e.size(),g=ft(m,2),w=g[0],S=g[1],O=!0,j=0;(h<l||y<a)&&(O=!1,j=h<l?w:S);for(var k=l;k<=u;k+=1)if(this._[k])for(var P=a;P<=c;P+=1)if(this._[k].cells&&this._[k].cells[P])for(var E=f;E<=h;E+=d)for(var x=function(){var t=E+(k-l),e=C+(P-a),p=ut.cloneDeep(n._[k].cells[P]);if(i&&p&&p.text&&p.text.length>0){var v=p.text,m=C-s+(E-f)+2;if(O||(m-=j+1),"="===v[0])p.text=v.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var e=0,r=0;return l===f?e=m-1:r=m-1,/^\d+$/.test(t)?t:T(t,e,r)}));else if(d<=1&&b>1&&(f>u||h<l)||b<=1&&d>1&&(s>c||y<a)||d<=1&&b<=1){var g=/[\\.\d]+$/.exec(v);if(null!==g){var w=Number(g[0])+m-1;p.text=v.substring(0,g.index)+w}}}n.setCell(t,e,p,r),o(t,e,p)},C=s;C<=y;C+=b)x()}},{key:"cutPaste",value:function(t,e){var r=this,n={};this.each((function(i){r.eachCells(i,(function(o){var l=parseInt(i,10),a=parseInt(o,10);t.includes(i,o)&&(l=e.sri+(l-t.sri),a=e.sci+(a-t.sci)),n[l]=n[l]||{cells:{}},n[l].cells[a]=r._[i].cells[o]}))})),this._=n}},{key:"paste",value:function(t,e){var r=this;if(!(t.length<=0)){var n=e.sri,i=e.sci;t.forEach((function(t,e){var o=n+e;t.forEach((function(t,e){var n=i+e;r.setCellText(o,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(i,o){var l=parseInt(i,10);l>=t&&(l+=r,e.eachCells(i,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return T(e,0,r,(function(e,r){return r>=t}))})))}))),n[l]=o})),this._=n,this.len+=r}},{key:"delete",value:function(t,e){var r=this,n=e-t+1,i={};this.each((function(o,l){var a=parseInt(o,10);a<t?i[a]=l:o>e&&(i[a-n]=l,r.eachCells(o,(function(t,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return T(t,0,-n,(function(t,r){return r>e}))})))})))})),this._=i,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,i){var o={};e.eachCells(n,(function(e,n){var i=parseInt(e,10);i>=t&&(i+=r,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return T(e,r,0,(function(e){return e>=t}))})))),o[i]=n})),i.cells=o}))}},{key:"deleteColumn",value:function(t,e){var r=this,n=e-t+1;this.each((function(i,o){var l={};r.eachCells(i,(function(r,i){var o=parseInt(r,10);o<t?l[o]=i:o>e&&(l[o-n]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return T(t,-n,0,(function(t){return t>e}))}))))})),o.cells=l}))}},{key:"deleteCells",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,r)}))}},{key:"deleteCell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var i=this.getCell(t,e);null!==i&&!1!==i.editable&&("all"===r?delete n.cells[e]:"text"===r?(i.text&&delete i.text,i.value&&delete i.value):"format"===r?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===r&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],r=this._[e];if(r){var n=r.cells,i=Object.keys(n),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var r=ft(e,2),n=r[0],i=r[1];t(n,i)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var r=ft(t,2),n=r[0],i=r[1];e(n,i)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&ht(e.prototype,r),n&&ht(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==pt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===pt(o)?o:String(o)),n)}var i,o}var dt=function(){function t(e){var r=e.len,n=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.width=n,this.indexWidth=i,this.minWidth=o}var e,r,n;return e=t,(r=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var r=this;return ut.rangeSum(t,e,(function(t){return r.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&vt(e.prototype,r),n&&vt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function bt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return mt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mt(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return l=t.done,t},e:function(t){a=!0,o=t},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw o}}}}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var gt=["en"],wt={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function St(t,e){if(e){var r,n=bt(gt);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(!e[i])break;for(var o=e[i],l=t.match(/(?:\\.|[^.])+/g),a=0;a<l.length;a+=1){var u=o[l[a]];if(!u)break;if(a===l.length-1)return u;o=u}}}catch(t){n.e(t)}finally{n.f()}}}function Ot(t){var e=St(t,wt);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=St(t,window.x_spreadsheet.$messages)),e||""}function jt(t){return function(){return Ot(t)}}function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Et(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Et(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==kt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===kt(o)?o:String(o)),n)}var i,o}var Tt={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function Ct(t,e){var r="";if(!t){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];r=Ot.apply(void 0,["validation.".concat(e)].concat(i))}return[t,r]}var Rt=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=r,this.value=n,this.type=e,this.operator=i,this.message=""}var e,r,n;return e=t,(r=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?ut.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,r=this.operator,n=this.value,i=this.type;if(e&&/^\s*$/.test(t))return Ct(!1,"required");if(/^\s*$/.test(t))return[!0];if(Tt[i]&&!Tt[i].test(t))return Ct(!1,"notMatch");if("list"===i)return Ct(this.values().includes(t),"notIn");if(r){var o=this.parseValue(t);if("be"===r){var l=Pt(n,2),a=l[0],u=l[1];return Ct(o>=this.parseValue(a)&&o<=this.parseValue(u),"between",a,u)}if("nbe"===r){var c=Pt(n,2),f=c[0],s=c[1];return Ct(o<this.parseValue(f)||o>this.parseValue(s),"notBetween",f,s)}if("eq"===r)return Ct(o===this.parseValue(n),"equal",n);if("neq"===r)return Ct(o!==this.parseValue(n),"notEqual",n);if("lt"===r)return Ct(o<this.parseValue(n),"lessThan",n);if("lte"===r)return Ct(o<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return Ct(o>this.parseValue(n),"greaterThan",n);if("gte"===r)return Ct(o>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&xt(e.prototype,r),n&&xt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return At(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return At(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==It(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===It(o)?o:String(o)),n)}var i,o}function zt(t,e,r){return e&&Nt(t.prototype,e),r&&Nt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Mt=function(){function t(e,r,n){Dt(this,t),this.refs=r,this.mode=e,this.validator=n}return zt(t,[{key:"includes",value:function(t,e){for(var r=this.refs,n=0;n<r.length;n+=1){if(D.valueOf(r[n]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(D.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(r){var n=D.valueOf(r);n.intersects(t)?n.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(r)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,r=this.validator;return{refs:t,mode:e,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(e){var r=e.refs,n=e.mode,i=e.type,o=e.required,l=e.operator,a=e.value;return new t(n,r,new Rt(i,o,a,l))}}]),t}(),Bt=function(){function t(){Dt(this,t),this._=[],this.errors=new Map}return zt(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,r){var n=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==n){var l=_t(n.validator.validate(r),2),a=l[0],u=l[1];a?o.delete(i):o.set(i,u)}else o.delete(i);return!0}},{key:"add",value:function(t,e,r){var n=r.type,i=r.required,o=r.value,l=r.operator,a=new Rt(n,i,o,l),u=this.getByValidator(a);null!==u?u.addRef(e):this._.push(new Mt(t,[e],a))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var r=this._[e];if(r.validator.equals(t))return r}return null}},{key:"get",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return Mt.valueOf(t)}))}}]),t}();function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t){return function(t){if(Array.isArray(t))return $t(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ut(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ht(o)?o:String(o)),n)}var i,o}function Vt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||Ut(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(t,e){if(t){if("string"==typeof t)return $t(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$t(t,e):void 0}}function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var qt={width:l.document.documentElement.clientHeight,height:l.document.documentElement.clientWidth},Lt={mode:"edit",view:{height:function(){return qt.height},width:function(){return qt.width}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function Yt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,i=e.clone(),o=t.size(),l=Vt(o,2),a=l[0],u=l[1],c=e.size(),f=Vt(c,2),s=f[0],h=f[1];return a>s&&(i.eri=e.sri+a-1),u>h&&(i.eci=e.sci+u-1),!n.intersects(i)||(r(Ot("error.pasteForMergedCell")),!1)}function Xt(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges;"all"!==r&&"format"!==r||(i.deleteCells(e,r),o.deleteWithin(e)),i.copyPaste(t,e,r,n,(function(t,e,r){if(r&&r.merge){var n=Vt(r.merge,2),i=n[0],l=n[1];if(i<=0&&l<=0)return;o.add(new D(t,e,t+i,e+l))}}))}function Zt(t,e){var r=this.clipboard,n=this.rows,i=this.merges;n.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),r.clear()}function Kt(t,e,r){var n=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=ut.cloneDeep(n[i.style])),o=ut.merge(o,{border:r}),i.style=this.addStyle(o)}function Jt(t){var e=this,r=t.mode,n=t.style,i=t.color,o=this.styles,l=this.selector,a=this.rows,u=l.range,c=u.sri,f=u.sci,s=u.eri,h=u.eci,y=!this.isSingleSelected();if(y||"inside"!==r&&"horizontal"!==r&&"vertical"!==r)if("outside"!==r||y){if("none"===r)l.range.each((function(t,r){var n=a.getCell(t,r);if(n&&void 0!==n.style){var i=ut.cloneDeep(o[n.style]);delete i.border,n.style=e.addStyle(i)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)for(var p=[],v=c;v<=s;v+=1)for(var d=f;d<=h;d+=1){for(var b=[],m=0;m<p.length;m+=1){var g=Vt(p[m],4),w=g[0],S=g[1],O=g[2],j=g[3];if(v===w+O+1&&b.push(m),w<=v&&v<=w+O&&d===S){d+=j+1;break}}if(b.forEach((function(t){return p.splice(t,1)})),d>h)break;var k=a.getCell(v,d),P=0,E=0;if(k&&k.merge){var x=Vt(k.merge,2);P=x[0],E=x[1],p.push([v,d,P,E])}var T=P>0&&v+P===s,C=E>0&&d+E===h,R={};"all"===r?R={bottom:[n,i],top:[n,i],left:[n,i],right:[n,i]}:"inside"===r?(!C&&d<h&&(R.right=[n,i]),!T&&v<s&&(R.bottom=[n,i])):"horizontal"===r?!T&&v<s&&(R.bottom=[n,i]):"vertical"===r?!C&&d<h&&(R.right=[n,i]):"outside"===r&&y&&(c===v&&(R.top=[n,i]),(T||s===v)&&(R.bottom=[n,i]),f===d&&(R.left=[n,i]),(C||h===d)&&(R.right=[n,i])),Object.keys(R).length>0&&Kt.call(this,v,d,R),d+=E}else if("top"===r||"bottom"===r)for(var _=f;_<=h;_+=1)"top"===r&&(Kt.call(this,c,_,{top:[n,i]}),_+=a.getCellMerge(c,_)[1]),"bottom"===r&&(Kt.call(this,s,_,{bottom:[n,i]}),_+=a.getCellMerge(s,_)[1]);else if("left"===r||"right"===r)for(var A=c;A<=s;A+=1)"left"===r&&(Kt.call(this,A,f,{left:[n,i]}),A+=a.getCellMerge(A,f)[0]),"right"===r&&(Kt.call(this,A,h,{right:[n,i]}),A+=a.getCellMerge(A,h)[0])}else Kt.call(this,c,f,{top:[n,i],bottom:[n,i],left:[n,i],right:[n,i]})}function Gt(t,e){var r=this.rows,n=this.freezeTotalHeight(),i=r.height;n+r.height<t&&(i-=e);for(var o=this.exceptRowSet,l=0,a=i,u=r.height;l<r.len&&!(a>t);l+=1)o.has(l)||(a+=u=r.getHeight(l));return(a-=u)<=0?{ri:-1,top:0,height:u}:{ri:l-1,top:a,height:u}}function Qt(t,e){var r=this.cols,n=this.freezeTotalWidth(),i=r.indexWidth;n+r.indexWidth<t&&(i-=e);var o=Vt(ut.rangeReduceIf(0,r.len,i,r.indexWidth,t,(function(t){return r.getWidth(t)})),3),l=o[0],a=o[1],u=o[2];return a<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:l-1,left:a,width:u}}var te=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=ut.merge(Lt,r||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new it,this.rows=new yt(this.settings.row),this.cols=new dt(this.settings.col),this.validations=new Bt,this.hyperlinks={},this.comments={},this.selector=new M,this.scroll=new W,this.history=new $,this.clipboard=new Y,this.autoFilter=new tt,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var e,r,n;return e=t,(r=[{key:"addValidation",value:function(t,e,r){var n=this;this.changeData((function(){n.validations.add(t,e,r)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=this.validations.get(e,r);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=t.range,i=this.validations.get(e,r),o={ref:n.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],r=this.selector.range,n=r.sri,i=r.eri,o=r.sci,a=r.eci,u=n;u<=i;u+=1){for(var c=[],f=o;f<=a;f+=1){var s=this.getCell(u,f);c.push(s&&s.text||"")}e.push(c)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),l.window.navigator.clipboard&&l.window.navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,i=this.selector;return!n.isClear()&&!!Yt.call(this,n.range,i.range,r)&&(this.changeData((function(){n.isCopy()?Xt.call(t,n.range,i.range,e):n.isCut()&&Zt.call(t,n.range,i.range)})),!0)}},{key:"pasteFromSystemClipboard",value:function(t,e){var r=this,n=this.selector;l.window.navigator.clipboard.readText().then((function(i){var o=r.parseClipboardContent(i),l=n.ri;o.forEach((function(t){var e=n.ci;t.forEach((function(t){r.setCellText(l,e,t,"input"),e+=1})),l+=1})),t(),e(r.rows.getData())}))}},{key:"parseClipboardContent",value:function(t){var e=[],r=t.split("\n"),n=0;return r.forEach((function(t){e[n]=t.split("\t"),n+=1})),e}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var r=this.rows,n=this.selector;this.changeData((function(){r.paste(e,n.range)}))}}},{key:"autofill",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!Yt.call(this,i,t,n)&&(this.changeData((function(){Xt.call(r,i,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var r=this.selector,n=this.rows,i=this.cols,o=this.merges,l=r.range,a=l.sri,u=l.sci,c=l.eri,f=l.eci,s=r.ri,h=r.ci,y=t,p=e;return t<0&&(y=n.len-1),e<0&&(p=i.len-1),y>s?(a=s,c=y):(a=y,c=s),p>h?(u=h,f=p):(u=p,f=h),r.range=o.union(new D(a,u,c,f)),r.range=o.union(r.range),r.range}},{key:"calSelectedRangeByStart",value:function(t,e){var r=this.selector,n=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new D(t,e,t,e),-1===t&&(o.sri=0,o.eri=n.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),r.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var r=this;this.changeData((function(){var n=r.selector,i=r.styles,o=r.rows;if("merge"===t)e?r.merge():r.unmerge();else if("border"===t)Jt.call(r,e);else if("formula"===t){var l=n.ri,a=n.ci,u=n.range;if(n.multiple()){var c=Vt(n.size(),2),f=c[0],s=c[1],h=u.sri,y=u.sci,p=u.eri,v=u.eci;if(f>1)for(var d=y;d<=v;d+=1)o.getCellOrNew(p+1,d).text="=".concat(e,"(").concat(x(d,h),":").concat(x(d,p),")");else s>1&&(o.getCellOrNew(l,v+1).text="=".concat(e,"(").concat(x(y,l),":").concat(x(v,l),")"))}else o.getCellOrNew(l,a).text="=".concat(e,"()")}else n.range.each((function(n,l){var a=o.getCellOrNew(n,l),u={};if(void 0!==a.style&&(u=ut.cloneDeep(i[a.style])),"format"===t)u.format=e,a.style=r.addStyle(u);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,u.font=Object.assign(u.font||{},c),a.style=r.addStyle(u)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(u[t]=e,a.style=r.addStyle(u)):a[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.autoFilter,n=this.selector,i=this.rows,o=n.ri,l=n.ci,a=o;this.unsortedRowMap.has(o)&&(a=this.unsortedRowMap.get(o));var u=i.getCell(a,l),c=u?u.text:"";if(this.setCellText(a,l,t,e),r.active()){var f=r.getFilter(l);if(f){var s=f.value.findIndex((function(t){return t===c}));s>=0&&f.value.splice(s,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,r)}},{key:"xyInSelectedRect",value:function(t,e){var r=this.getSelectedRect(),n=r.left,i=r.top,o=r.width,l=r.height,a=t-this.cols.indexWidth,u=e-this.rows.height;return a>n&&a<n+o&&u>i&&u<i+l}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,r=this.rows,n=this.cols,i=this.exceptRowSet,o=t.sri,l=t.sci,a=t.eri,u=t.eci;if(o<0&&l<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=n.sumWidth(0,l),f=r.sumHeight(0,o,i),s=r.sumHeight(o,a+1,i),h=n.sumWidth(l,u+1),y=c-e.x,p=f-e.y,v=this.freezeTotalHeight(),d=this.freezeTotalWidth();return d>0&&d>c&&(y=c),v>0&&v>f&&(p=f),{l:c,t:f,left:y,top:p,height:s,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var r=this.scroll,n=this.merges,i=this.rows,o=this.cols,l=Gt.call(this,e,r.y),a=l.ri,u=l.top,c=l.height,f=Qt.call(this,t,r.x),s=f.ci,h=f.left,y=f.width;if(-1===s&&(y=o.totalWidth()),-1===a&&(c=i.totalHeight()),a>=0||s>=0){var p=n.getFirstIncludes(a,s);if(p){a=p.sri,s=p.sci;var v=this.cellRect(a,s);h=v.left,u=v.top,y=v.width,c=v.height}}return{ri:a,ci:s,left:h,top:u,width:y,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,i=t.eci,o=this.getCell(e,r);if(o&&o.merge){var l=Vt(o.merge,2),a=l[0],u=l[1];if(e+a===n&&r+u===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,i=t.eci,o=this.getCell(e,r);if(o&&o.merge){var l=Vt(o.merge,2),a=l[0],u=l[1];if(e+a===n&&r+u===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,r=this.rows;if(!this.isSingleSelected()){var n=Vt(e.size(),2),i=n[0],o=n[1];if(i>1||o>1){var l=e.range,a=l.sri,u=l.sci;this.changeData((function(){var n=r.getCellOrNew(a,u);n.merge=[i-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(a,u,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var r=e.range,n=r.sri,i=r.sci;this.changeData((function(){t.rows.deleteCell(n,i,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,r=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=r.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,r,n){var i=this.autoFilter;i.addFilter(t,r,n),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,r=this.rows;if(e.active()){var n=e.sort,i=e.filteredRows((function(t,e){return r.getCell(t,e)})),o=i.rset,l=i.fset,a=Array.from(l),u=Array.from(l);n&&a.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,a.forEach((function(e,r){t.sortedRowMap.set(u[r],e),t.unsortedRowMap.set(e,u[r])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){t.rows.deleteCells(r.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(r.range)}))}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,i=n.sri,o=n.sci,l=e.rows,a=e.merges,u=e.cols,c=i;"row"===t?l.insert(i,r):"column"===t&&(l.insertColumn(o,r),c=o,u.len+=1),a.shift(t,c,r,(function(t,e,r,n){var i=l.getCell(t,e);i.merge[0]+=r,i.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var r=e.rows,n=e.merges,i=e.selector,o=e.cols,l=i.range,a=i.range,u=a.sri,c=a.sci,f=a.eri,s=a.eci,h=Vt(i.range.size(),2),y=h[0],p=h[1],v=u,d=y;"row"===t?r.delete(u,f):"column"===t&&(r.deleteColumn(c,s),v=l.sci,d=p,o.len-=s-c+1),n.shift(t,v,-d,(function(t,e,n,i){var o=r.getCell(t,e);o.merge[0]+=n,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge}))}))}},{key:"scrollx",value:function(t,e){var r=this.scroll,n=this.freeze,i=this.cols,o=Vt(n,2)[1],l=Vt(ut.rangeReduceIf(o,i.len,0,0,t,(function(t){return i.getWidth(t)})),3),a=l[0],u=l[1],c=l[2],f=u;t>0&&(f+=c),r.x!==f&&(r.ci=t>0?a:0,r.x=f,e())}},{key:"scrolly",value:function(t,e){var r=this.scroll,n=this.freeze,i=this.rows,o=Vt(n,1)[0],l=Vt(ut.rangeReduceIf(o,i.len,0,0,t,(function(t){return i.getHeight(t)})),3),a=l[0],u=l[1],c=l[2],f=u;t>0&&(f+=c),r.y!==f&&(r.ri=t>0?a:0,r.y=f,e())}},{key:"cellRect",value:function(t,e){var r=this.rows,n=this.cols,i=n.sumWidth(0,e),o=r.sumHeight(0,t),l=r.getCell(t,e),a=n.getWidth(e),u=r.getHeight(t);if(null!==l&&l.merge){var c=Vt(l.merge,2),f=c[0],s=c[1];if(f>0)for(var h=1;h<=f;h+=1)u+=r.getHeight(t+h);if(s>0)for(var y=1;y<=s;y+=1)a+=n.getWidth(e+y)}return{left:i,top:o,width:a,height:u,cell:l}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var r=this.getCell(t,e);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(t,e){var r=this.getCell(t,e);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var r=this.styles,n=this.rows.getCell(t,e),i=n&&void 0!==n.style?r[n.style]:{};return ut.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,r=t.ci;return this.getCellStyleOrDefault(e,r)}},{key:"setCellText",value:function(t,e,r,n){var i=this.rows,o=this.history,l=this.validations;"finished"===n?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,r)):(i.setCellText(t,e,r),this.change(this.getData())),l.validate(t,e,r)}},{key:"freezeIsActive",value:function(){var t=Vt(this.freeze,2),e=t[0],r=t[1];return e>0||r>0}},{key:"setFreeze",value:function(t,e){var r=this;this.changeData((function(){r.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var r=this;this.changeData((function(){r.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var r=this;this.changeData((function(){r.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,r=t.showToolbar,n=t.showBottomBar,i=e.height();return n&&(i-=41),r&&(i-=41),i}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=Vt(this.freeze,2),e=t[0],r=t[1];return new D(0,0,e-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,r=Vt(t.maxCell(),2),n=r[0],i=r[1],o=t.sumHeight(0,n+1),l=e.sumWidth(0,i+1);return new D(0,0,n,i,l,o)}},{key:"exceptRowTotalHeight",value:function(t,e){var r=this.exceptRowSet,n=this.rows,i=Array.from(r),o=0;return i.forEach((function(r){if(r<t||r>e){var i=n.getHeight(r);o+=i}})),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,r=this.cols,n=this.freeze,i=this.exceptRowSet,o=t.ri,l=t.ci;o<=0&&(o=Vt(n,1)[0]),l<=0&&(l=Vt(n,2)[1]);for(var a=0,u=0,c=[e.len,r.len],f=c[0],s=c[1],h=o;h<e.len&&(i.has(h)||(u+=e.getHeight(h),f=h),!(u>this.viewHeight()));h+=1);for(var y=l;y<r.len&&(s=y,!((a+=r.getWidth(y))>this.viewWidth()));y+=1);return new D(o,l,f,s,a,u)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,r=this.selector,n=Vt(r.size(),2),i=n[0],o=n[1],l=r.range,a=l.sri,u=l.sci,c=l.eri,f=l.eci;if(i===t.len)for(var s=u;s<=f;s+=1)e.setHide(s,!0);else if(o===e.len)for(var h=a;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,r){for(var n=0,i=this.rows,o=this.exceptRowSet,l=Ft(o),a=0,u=0;u<l.length;u+=1)l[u]<t&&(a+=1);for(var c=t+a;c<=e+a;c+=1)if(o.has(c))a+=1;else{var f=i.getHeight(c);if(f>0&&(r(c,n,f),(n+=f)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,r){for(var n=0,i=this.cols,o=t;o<=e;o+=1){var l=i.getWidth(o);if(l>0&&(r(o,n,l),(n+=l)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,r=0;r<e.length;r+=1){var n=e[r];if(ut.equals(n,t))return r}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(r){if("merges"===r||"rows"===r||"cols"===r||"validations"===r)e[r].setData(t[r]);else if("freeze"===r){var n=Vt(E(t[r]),2),i=n[0],o=n[1];e.freeze=[o,i]}else"autofilter"===r?e.autoFilter.setData(t[r]):void 0!==t[r]&&(e[r]=t[r])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,r=this.styles,n=this.merges,i=this.rows,o=this.cols,l=this.validations,a=this.autoFilter;return{name:t,freeze:x(e[1],e[0]),styles:r,merges:n.getData(),rows:i.getData(),cols:o.getData(),validations:l.getData(),autofilter:a.getData()}}}])&&Wt(e.prototype,r),n&&Wt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ee="x-spreadsheet";window.devicePixelRatio;function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==re(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===re(o)?o:String(o)),n)}var i,o}var oe=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;ne(this,t),this.moving=!1,this.vertical=r,this.el=w("div","".concat(ee,"-resizer ").concat(r?"vertical":"horizontal")).children(this.unhideHoverEl=w("div","".concat(ee,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=w("div","".concat(ee,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=w("div","".concat(ee,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}}var e,r,n;return e=t,(r=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var r=this.moving,n=this.vertical,i=this.hoverEl,o=this.lineEl,l=this.el,a=this.unhideHoverEl;if(!r){this.cRect=t;var u=t.left,c=t.top,f=t.width,s=t.height;l.offset({left:n?u+f-5:u,top:n?c:c+s-5}).show(),i.offset({width:n?5:f,height:n?s:5}),o.offset({width:n?0:e.width,height:n?e.height:0}),a.offset({left:n?5-f:u,top:n?c:5-s,width:n?5:f,height:n?s:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,r=t,n=this.el,i=this.lineEl,o=this.cRect,l=this.vertical,a=this.minDistance,u=l?o.width:o.height;i.show(),s(window,(function(t){e.moving=!0,null!==r&&1===t.buttons&&(l?(u+=t.movementX)>a&&n.css("left","".concat(o.left+u,"px")):(u+=t.movementY)>a&&n.css("top","".concat(o.top+u,"px")),r=t)}),(function(){r=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(u<a&&(u=a),e.finishedFn(o,u))}))}}])&&ie(e.prototype,r),n&&ie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function le(t){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==le(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===le(o)?o:String(o)),n)}var i,o}var ue=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=w("div","".concat(ee,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=w("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,i=e.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:i,t)}))}var e,r,n;return e=t,(r=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var r=t-1;if(e>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(e,"px"))}else this.el.hide();return this}}])&&ae(e.prototype,r),n&&ae(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ce(t){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function se(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ce(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ce(o)?o:String(o)),n)}var i,o}function he(t,e,r){return e&&se(t.prototype,e),r&&se(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var ye=10,pe=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];fe(this,t),this.useHideInput=r,this.autoFocus=n,this.inputChange=function(){},this.cornerEl=w("div","".concat(ee,"-selector-corner")),this.areaEl=w("div","".concat(ee,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=w("div","".concat(ee,"-selector-clipboard")).hide(),this.autofillEl=w("div","".concat(ee,"-selector-autofill")).hide(),this.el=w("div","".concat(ee,"-selector")).css("z-index","".concat(ye)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),r&&(this.hideInput=w("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=w("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=w("div","hide-input").child(this.hideInput))),ye+=1}return he(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,r=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:r-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,r=t.top,n=t.width,i=t.height;this.clipboardEl.offset({left:e,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,r=t.top,n=t.width,i=t.height;this.autofillEl.offset({width:n-3,height:i-3,left:e,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function ve(t){var e=this.data,r=t.left,n=t.top,i=t.width,o=t.height,l=t.scroll,a=t.l,u=t.t,c=e.freezeTotalWidth(),f=e.freezeTotalHeight(),s=r-c;c>a&&(s-=l.x);var h=n-f;return f>u&&(h-=l.y),{left:s,top:h,width:i,height:o}}function de(t){var e=this.data,r=t.left,n=t.width,i=t.height,o=t.l,l=t.t,a=t.scroll,u=e.freezeTotalWidth(),c=r-u;return u>o&&(c-=a.x),{left:c,top:l,width:n,height:i}}function be(t){var e=this.data,r=t.top,n=t.width,i=t.height,o=t.l,l=t.t,a=t.scroll,u=e.freezeTotalHeight(),c=r-u;return u>l&&(c-=a.y),{left:o,top:c,width:n,height:i}}function me(t){this.br.setAreaOffset(ve.call(this,t))}function ge(t){this.tl.setAreaOffset(t)}function we(t){this.t.setAreaOffset(de.call(this,t))}function Se(t){this.l.setAreaOffset(be.call(this,t))}function Oe(t){this.l.setClipboardOffset(be.call(this,t))}function je(t){this.br.setClipboardOffset(ve.call(this,t))}function ke(t){this.tl.setClipboardOffset(t)}function Pe(t){this.t.setClipboardOffset(de.call(this,t))}function Ee(t){me.call(this,t),ge.call(this,t),we.call(this,t),Se.call(this,t)}function xe(t){je.call(this,t),ke.call(this,t),Pe.call(this,t),Oe.call(this,t)}var Te=function(){function t(e){var r=this;fe(this,t);var n=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new pe(!0,n),this.t=new pe,this.l=new pe,this.tl=new pe,this.br.inputChange=function(t){r.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=w("div","".concat(ee,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,ye+=1}return he(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,r=this.t,n=this.l,i=this.br,o=t.freezeTotalHeight(),l=t.freezeTotalWidth();o>0||l>0?(e.setOffset({width:l,height:o}),r.setOffset({left:l,height:o}),n.setOffset({top:o,width:l}),i.setOffset({left:l,top:o})):(e.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ee.call(this,t),xe.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();me.call(this,t),we.call(this,t),je.call(this,e),Pe.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();me.call(this,t),Se.call(this,t),je.call(this,e),Oe.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(t,e),o=i.sri,l=i.sci;if(r){var a=t,u=e;t<0&&(a=0),e<0&&(u=0),n.selector.setIndexes(a,u),this.indexes=[a,u]}this.moveIndexes=[o,l],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=this.lastri,o=this.lastci;if(r){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),Ee.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,r=t.eci;this.setEnd(e,r)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var r=this.range,n=r.sri,i=r.sci,o=r.eri,l=r.eci,a=t,u=e,c=n-t,f=o-t,s=l-e;if(i-e>0)this.arange=new D(n,u,o,i-1);else if(c>0)this.arange=new D(a,i,n-1,l);else if(s<0)this.arange=new D(n,l+1,o,u);else{if(!(f<0))return void(this.arange=null);this.arange=new D(o+1,i,a,l)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var y=this.br,p=this.l,v=this.t,d=this.tl;y.showAutofill(ve.call(this,h)),p.showAutofill(be.call(this,h)),v.showAutofill(de.call(this,h)),d.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();xe.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}]),t}();function Ce(t){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Re(t){return function(t){if(Array.isArray(t))return _e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return _e(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _e(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Ce(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ce(o)?o:String(o)),n)}var i,o}function De(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Ne(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function ze(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function Me(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:De.call(this,t);break;case 39:t.stopPropagation();break;case 40:Ne.call(this,t);break;case 13:case 9:ze.call(this,t);break;default:t.stopPropagation()}}var Be=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";Ae(this,t),this.filterItems=[],this.items=e,this.el=w("div","".concat(ee,"-suggest")).css("width",n).hide(),this.itemClick=r,this.itemIndex=-1}var e,r,n;return e=t,(r=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),c(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,r=this,n=this.items;if(/^\s*$/.test(t)||(n=n.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),n=n.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var n=w("div","".concat(ee,"-item")).child(e).on("click.stop",(function(){r.itemClick(t),r.hide()}));return t.label&&n.child(w("div","label").html(t.label)),n})),this.filterItems=n,!(n.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,Re(n)).show(),f(i.parent(),(function(){r.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return Me.call(e,t)}))}}])&&Ie(e.prototype,r),n&&Ie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function He(t){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==He(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===He(o)?o:String(o)),n)}var i,o}function We(t,e){return(We=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ve(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$e(t);if(e){var i=$e(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ue(this,r)}}function Ue(t,e){if(e&&("object"===He(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&We(t,e)}(o,t);var e,r,n,i=Ve(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,"div","".concat(ee,"-icon"))).iconNameEl=w("div","".concat(ee,"-icon-img ").concat(t)),e.child(e.iconNameEl),e}return e=o,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(ee,"-icon-img ").concat(t))}}])&&Fe(e.prototype,r),n&&Fe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(g);function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ye(t){return function(t){if(Array.isArray(t))return Xe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Xe(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xe(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Le(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Le(o)?o:String(o)),n)}var i,o}function Ke(t,e){t.setMonth(t.getMonth()+e)}function Je(t,e){var r=new Date(t);return r.setDate(e-t.getDay()+1),r}var Ge=function(){function t(e){var r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=w("div","calendar-header-left"),this.bodyEl=w("tbody",""),this.buildAll(),this.el=w("div","x-spreadsheet-calendar").children(w("div","calendar-header").children(this.headerLeftEl,w("div","calendar-header-right").children(w("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new qe("chevron-left")),w("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new qe("chevron-right")))),w("table","calendar-body").children(w("thead","").child((r=w("tr","")).children.apply(r,Ye(Ot("calendar.weeks").map((function(t){return w("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}}var e,r,n;return e=t,(r=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){Ke(this.value,-1),this.buildAll()}},{key:"next",value:function(){Ke(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(Ot("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,r=this.value,n=this.cvalue,i=this.bodyEl,o=function(t,e,r){for(var n=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var l=0;l<7;l+=1){var a=Je(n,7*o+l),u=a.getMonth()!==e,c=a.getMonth()===r.getMonth()&&a.getDate()===r.getDate();i[o][l]={d:a,disabled:u,active:c}}return i}(r.getFullYear(),r.getMonth(),n).map((function(t){var r,n=t.map((function(t){var r="cell";return t.disabled&&(r+=" disabled"),t.active&&(r+=" active"),w("td","").child(w("div",r).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(r=w("tr","")).children.apply(r,Ye(n))}));(t=i.html("")).children.apply(t,Ye(o))}}])&&Ze(e.prototype,r),n&&Ze(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qe(t){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Qe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Qe(o)?o:String(o)),n)}var i,o}var er=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new Ge(new Date),this.el=w("div","".concat(ee,"-datepicker")).child(this.calendar.el).hide()}var e,r,n;return e=t,(r=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(r){t(r),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&tr(e.prototype,r),n&&tr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rr(t){return(rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==rr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===rr(o)?o:String(o)),n)}var i,o}function ir(t){return function(t){if(Array.isArray(t))return or(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return or(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return or(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lr(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,r=this.textEl,n=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,ir(i.map((function(t){return t.length})))),l=e.offset().width/t.length,a=(o+1)*l+5,u=this.viewFn().width-n.left-l,c=i.length;if(a>n.width){var f=a;a>u&&(f=u,c+=parseInt(a/u,10),c+=a%u>0?1:0),r.css("width","".concat(f,"px"))}(c*=this.rowHeight)>n.height&&r.css("height","".concat(c,"px"))}}function ar(t,e){var r=t.target,n=r.value,i=r.selectionEnd,o="".concat(n.slice(0,i)).concat(e).concat(n.slice(i));r.value=o,r.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),lr.call(this)}function ur(t){var e=t.keyCode,r=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&r&&(ar.call(this,t,"\n"),t.stopPropagation()),13!==e||r||t.preventDefault()}function cr(t){var e=t.target.value,r=this.suggest,n=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?r.search(e):r.hide();else{var l=e.lastIndexOf("=");-1!==l?r.search(e.substring(l+1)):r.hide()}n.html(e),lr.call(this),this.change("input",e)}else t.target.value=o.text||"";else{if(this.inputText=e,i)"list"===i.type?r.search(e):r.hide();else{var a=e.lastIndexOf("=");-1!==a?r.search(e.substring(a+1)):r.hide()}n.html(e),lr.call(this),this.change("input",e)}}function fr(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function sr(t,e){var r=this.textEl,n=this.textlineEl;r.el.blur(),r.val(t),n.html(t),fr.call(this,e)}function hr(t){var e=this.inputText,r=this.validator,n=0;if(r&&"list"===r.type)this.inputText=t,n=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),l=e.substring(i+1);l=-1!==l.indexOf(")")?l.substring(l.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),n=this.inputText.length,this.inputText+=")".concat(l)}sr.call(this,this.inputText,n)}function yr(){this.suggest.setItems(this.formulas)}var pr=function(){function t(e,r,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=r,this.rowHeight=n,this.formulas=e,this.suggest=new Be(e,(function(t){hr.call(i,t)})),this.datepicker=new er,this.datepicker.change((function(t){i.setText(function(t){var e=t.getMonth()+1,r=t.getDate();return e<10&&(e="0".concat(e)),r<10&&(r="0".concat(r)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(r)}(t)),i.clear()})),this.areaEl=w("div","".concat(ee,"-editor-area")).children(this.textEl=w("textarea","").on("input",(function(t){return cr.call(i,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return ur.call(i,t)})),this.textlineEl=w("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=w("div","".concat(ee,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,r,n;return e=t,(r=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),yr.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=this.textEl,n=this.areaEl,i=this.suggest,o=this.freeze,l=this.el;if(t){this.areaOffset=t;var a=t.left,u=t.top,c=t.width,f=t.height,s=t.l,h=t.t,y={left:0,top:0};o.w>s&&o.h>h||(o.w<s&&o.h<h?(y.left=o.w,y.top=o.h):o.w>s?y.top=o.h:o.h>h&&(y.left=o.w)),l.offset(y),n.offset({left:a-y.left-.8,top:u-y.top-.8}),r.offset({width:c-9+.8,height:f-3+.8});var p={left:0};p[e]=f,i.setOffset(p),i.hide()}}},{key:"setCell",value:function(t,e){if(!t||!1!==t.editable){var r=this.el,n=this.datepicker,i=this.suggest;r.show(),this.cell=t;var o=t&&t.text||"";if(this.setText(o),this.validator=e,e){var l=e.type;"date"===l&&(n.show(),/^\s*$/.test(o)||n.setValue(o)),"list"===l&&(i.setItems(e.values()),i.search(""))}}}},{key:"setText",value:function(t){this.inputText=t,sr.call(this,t,t.length),lr.call(this)}}])&&nr(e.prototype,r),n&&nr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function vr(t){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==vr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==vr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===vr(o)?o:String(o)),n)}var i,o}function br(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mr(t,e){return(mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Sr(t);if(e){var i=Sr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wr(this,r)}}function wr(t,e){if(e&&("object"===vr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Or=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mr(t,e)}(o,t);var e,r,n,i=gr(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return br(this,o),(e=i.call(this,"div","".concat(ee,"-button ").concat(r))).child(Ot("button.".concat(t))),e}return e=o,r&&dr(e.prototype,r),n&&dr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(g);function jr(t){return function(t){if(Array.isArray(t))return Er(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||Pr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(t,e){if(t){if("string"==typeof t)return Er(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Er(t,e):void 0}}function Er(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==xr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==xr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===xr(o)?o:String(o)),n)}var i,o}function Rr(t,e,r){return e&&Cr(t.prototype,e),r&&Cr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _r(){return window.devicePixelRatio||1}function Ar(){return _r()-.5}function Ir(t){return parseInt(t*_r(),10)}function Dr(t){var e=Ir(t);return e>0?e-.5:.5}var Nr=function(){function t(e,r,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Tr(this,t),this.x=e,this.y=r,this.width=n,this.height=i,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return Rr(t,[{key:"setBorders",value:function(t){var e=t.top,r=t.bottom,n=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,r=this.padding,n=this.x;return"left"===t?n+=r:"center"===t?n+=e/2:"right"===t&&(n+=e-r),n}},{key:"texty",value:function(t,e){var r=this.height,n=this.padding,i=this.y;return"top"===t?i+=n:"middle"===t?i+=r/2-e/2:"bottom"===t&&(i+=r-n-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,r=this.width;return[[t+r,e],[t+r,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,r=this.width,n=this.height;return[[t,e+n],[t+r,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function zr(t,e,r,n,i,o,l){var a={x:0,y:0};"underline"===t?a.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?a.y=o/2:"top"===i&&(a.y=-(o/2+2))),"center"===n?a.x=l/2:"right"===n&&(a.x=l),this.line([e-a.x,r-a.y],[e-a.x+l,r-a.y])}var Mr=function(){function t(e,r,n){Tr(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(r,n),this.ctx.scale(_r(),_r())}return Rr(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Ir(t),this.el.height=Ir(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,r=t.height;return this.ctx.clearRect(0,0,e,r),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Ir(t),Ir(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,r,n){return this.ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this.ctx.fillRect(Ir(t)-.5,Ir(e)-.5,Ir(r),Ir(n)),this}},{key:"fillText",value:function(t,e,r){return this.ctx.fillText(t,Ir(e),Ir(r)),this}},{key:"text",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.ctx,l=n.align,a=n.valign,u=n.font,c=n.color,f=n.strike,s=n.underline,h=e.textx(l);o.save(),o.beginPath(),this.attr({textAlign:l,textBaseline:a,font:"".concat(u.italic?"italic":""," ").concat(u.bold?"bold":""," ").concat(Ir(u.size),"px ").concat(u.name),fillStyle:c,strokeStyle:c});var y="".concat(t).split("\n"),p=e.innerWidth(),v=[];y.forEach((function(t){var e=o.measureText(t).width;if(i&&e>Ir(p)){for(var r={w:0,len:0,start:0},n=0;n<t.length;n+=1)r.w>=Ir(p)&&(v.push(t.substr(r.start,r.len)),r={w:0,len:0,start:n}),r.len+=1,r.w+=o.measureText(t[n]).width+1;r.len>0&&v.push(t.substr(r.start,r.len))}else v.push(t)}));var d=(v.length-1)*(u.size+2),b=e.texty(a,d);return v.forEach((function(t){var e=o.measureText(t).width;r.fillText(t,h,b),f&&zr.call(r,"strike",h,b,l,a,u.size,e),s&&zr.call(r,"underline",h,b,l,a,u.size,e),b+=u.size+2})),o.restore(),this}},{key:"border",value:function(t,e){var r=this.ctx;return r.lineWidth=Ar,r.strokeStyle=e,"medium"===t?r.lineWidth=Ir(2)-.5:"thick"===t?r.lineWidth=Ir(3):"dashed"===t?r.setLineDash([Ir(3),Ir(2)]):"dotted"===t?r.setLineDash([Ir(1),Ir(1)]):"double"===t&&r.setLineDash([Ir(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],r=kr(e,2),n=r[0],i=r[1];t.moveTo(Dr(n),Dr(i));for(var o=1;o<arguments.length;o+=1){var l=o<0||arguments.length<=o?void 0:arguments[o],a=kr(l,2),u=a[0],c=a[1];t.lineTo(Dr(u),Dr(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var r=t.borderTop,n=t.borderRight,i=t.borderBottom,o=t.borderLeft;r&&(this.border.apply(this,jr(r)),this.line.apply(this,jr(t.topxys()))),n&&(this.border.apply(this,jr(n)),this.line.apply(this,jr(t.rightxys()))),i&&(this.border.apply(this,jr(i)),this.line.apply(this,jr(t.bottomxys()))),o&&(this.border.apply(this,jr(o)),this.line.apply(this,jr(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,r=t.x,n=t.y,i=r+t.width-15,o=n+t.height-15;e.save(),e.beginPath(),e.moveTo(Ir(i),Ir(o)),e.lineTo(Ir(i+8),Ir(o)),e.lineTo(Ir(i+4),Ir(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,r=t.x,n=t.y,i=r+t.width-1;e.save(),e.beginPath(),e.moveTo(Ir(i-8),Ir(n-1)),e.lineTo(Ir(i),Ir(n-1)),e.lineTo(Ir(i),Ir(n+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,r=t.x,n=t.y,i=r+t.width-1;e.save(),e.beginPath(),e.moveTo(Ir(i-8),Ir(n-1)),e.lineTo(Ir(i),Ir(n-1)),e.lineTo(Ir(i),Ir(n+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var r=this.ctx,n=t.x,i=t.y,o=t.width,l=t.height,a=t.bgcolor;r.save(),r.beginPath(),r.fillStyle=a||"#fff",r.rect(Dr(n+1),Dr(i+1),Ir(o-2),Ir(l-2)),r.clip(),r.fill(),e(),r.restore()}}]),t}(),Br=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Hr=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Fr(t){for(var e=0;e<Hr.length;e+=1){var r=Hr[e];if(r.pt===t)return r.px}return t}function Wr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Vr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vr(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ur=function(t){for(var e=[],r=[],n=[],i=0,o="",l=1,a="",u=0;u<t.length;u+=1){var c=t.charAt(u);if(" "!==c){if(c>="a"&&c<="z")n.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)n.push(c);else if('"'===c){for(u+=1;'"'!==t.charAt(u);)n.push(t.charAt(u)),u+=1;r.push('"'.concat(n.join(""))),n=[]}else if("-"===c&&/[+\-*/,(]/.test(a))n.push(c);else{if("("!==c&&n.length>0&&r.push(n.join("")),")"===c){var f=e.pop();if(2===i)try{for(var s=Wr(E(r.pop()),2),h=s[0],y=s[1],p=Wr(E(r.pop()),2),v=p[0],d=p[1],b=0,m=v;m<=h;m+=1)for(var g=d;g<=y;g+=1)r.push(x(m,g)),b+=1;r.push([f,b])}catch(t){}else if(1===i||3===i)3===i&&r.push(o),r.push([f,l]),l=1;else for(;"("!==f&&(r.push(f),!(e.length<=0));)f=e.pop();i=0}else if("="===c||">"===c||"<"===c){var w=t.charAt(u+1);o=c,"="!==w&&"-"!==w||(o+=w,u+=1),i=3}else if(":"===c)i=2;else if(","===c)3===i&&r.push(o),i=1,l+=1;else if("("===c&&n.length>0)e.push(n.join(""));else{if(e.length>0&&("+"===c||"-"===c)){var S=e[e.length-1];if("("!==S&&r.push(e.pop()),"*"===S||"/"===S)for(;e.length>0&&"("!==(S=e[e.length-1]);)r.push(e.pop())}else if(e.length>0){var O=e[e.length-1];"*"!==O&&"/"!==O||r.push(e.pop())}e.push(c)}n=[]}a=c}}for(n.length>0&&r.push(n.join(""));e.length>0;)r.push(e.pop());return r},$r=function(t,e){var r=Wr(t,1)[0],n=t;if('"'===r)return t.substring(1);var i=1;if("-"===r&&(n=t.substring(1),i=-1),n[0]>="0"&&n[0]<="9")return i*Number(n);var o=Wr(E(n),2);return i*e(o[0],o[1])},qr=function(t,e,r,n){for(var i=[],o=0;o<t.length;o+=1){var l=t[o],a=l[0];if("+"===l){var u=i.pop();i.push(at("+",i.pop(),u))}else if("-"===l)if(1===i.length){var c=i.pop();i.push(at("*",c,-1))}else{var f=i.pop();i.push(at("-",i.pop(),f))}else if("*"===l)i.push(at("*",i.pop(),i.pop()));else if("/"===l){var s=i.pop();i.push(at("/",i.pop(),s))}else if("="===a||">"===a||"<"===a){var h=i.pop();Number.isNaN(h)||(h=Number(h));var y=i.pop();Number.isNaN(y)||(y=Number(y));var p=!1;"="===a?p=y===h:">"===l?p=y>h:">="===l?p=y>=h:"<"===l?p=y<h:"<="===l&&(p=y<=h),i.push(p)}else if(Array.isArray(l)){for(var v=Wr(l,2),d=v[0],b=v[1],m=[],g=0;g<b;g+=1)m.push(i.pop());i.push(e[d].render(m.reverse()))}else{if(n.includes(l))return 0;(a>="a"&&a<="z"||a>="A"&&a<="Z")&&n.push(l),i.push($r(l,r)),n.pop()}}return i[0]},Lr=function t(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=Ur(e.substring(1));return o.length<=0?e:qr(o,r,(function(e,o){return t(n(e,o),r,n,i)}),i)}return e};function Yr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||Zr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xr(t){return function(t){if(Array.isArray(t))return Kr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Zr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(t,e){if(t){if("string"==typeof t)return Kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kr(t,e):void 0}}function Kr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Jr=[{key:"SUM",title:jt("formula.sum"),render:function(t){return t.reduce((function(t,e){return at("+",t,e)}),0)}},{key:"AVERAGE",title:jt("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:jt("formula.max"),render:function(t){return Math.max.apply(Math,Xr(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:jt("formula.min"),render:function(t){return Math.min.apply(Math,Xr(t.map((function(t){return Number(t)}))))}},{key:"IF",title:jt("formula._if"),render:function(t){var e=Yr(t,3),r=e[0],n=e[1],i=e[2];return r?n:i}},{key:"AND",title:jt("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:jt("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:jt("formula.concat"),render:function(t){return t.join("")}}],Gr=Jr,Qr={};function tn(t){return function(t){if(Array.isArray(t))return nn(t)}(t)||on(t)||rn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(t){return function(t){if(Array.isArray(t))return t}(t)||on(t)||rn(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(t,e){if(t){if("string"==typeof t)return nn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nn(t,e):void 0}}function nn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function on(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}Jr.forEach((function(t){Qr[t.key]=t}));var ln=function(t){return t},an=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=en(Number(t).toFixed(2).toString().split("\\.")),r=e[0],n=e.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(tn(n))}return t},un=[{key:"normal",title:jt("format.normal"),type:"string",render:ln},{key:"text",title:jt("format.text"),type:"string",render:ln},{key:"number",title:jt("format.number"),type:"number",label:"1,000.12",render:an},{key:"percent",title:jt("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:jt("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(an(t))}},{key:"usd",title:jt("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(an(t))}},{key:"eur",title:jt("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(an(t))}},{key:"date",title:jt("format.date"),type:"date",label:"26/09/2008",render:ln},{key:"time",title:jt("format.time"),type:"date",label:"15:59:00",render:ln},{key:"datetime",title:jt("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:ln},{key:"duration",title:jt("format.duration"),type:"date",label:"24:01:00",render:ln}],cn={};function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return hn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==fn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===fn(o)?o:String(o)),n)}var i,o}un.forEach((function(t){cn[t.key]=t}));var pn={fillStyle:"#f4f5f8"},vn={fillStyle:"#fff",lineWidth:Ar,strokeStyle:"#e6e6e6"};function dn(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.cellRect(e,r),o=i.left,l=i.top,a=i.width,u=i.height;return new Nr(o,l+n,a,u,5)}function bn(t,e,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.sortedRowMap,l=e.rows,a=e.cols;if(!l.isHide(r)&&!a.isHide(n)){var u=r;o.has(r)&&(u=o.get(r));var c=e.getCell(u,n);if(null!==c){var f=!1;"editable"in c&&!1===c.editable&&(f=!0);var s=e.getCellStyleOrDefault(u,n),h=dn(e,r,n,i);h.bgcolor=s.bgcolor,void 0!==s.border&&(h.setBorders(s.border),t.strokeBorders(h)),t.rect(h,(function(){var i="";i=e.settings.evalPaused?c.text||"":Lr(c.text||"",Qr,(function(t,r){return e.getCellTextOrDefault(r,t)})),s.format&&(i=cn[s.format].render(i));var o=Object.assign({},s.font);o.size=Fr(o.size),t.text(i,h,{align:s.align,valign:s.valign,font:o,color:s.color,strike:s.strike,underline:s.underline},s.textwrap),e.validations.getError(r,n)&&t.error(h),f&&t.frozen(h)}))}}}function mn(t){var e=this.data,r=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var i=n.hrange();t.intersects(i)&&i.each((function(t,n){var i=dn(e,t,n);r.dropdown(i)}))}}function gn(t,e,r,n,i){var o=this.draw,l=this.data;o.save(),o.translate(e,r).translate(n,i);var a=l.exceptRowSet,u=l.exceptRowTotalHeight(t.sri,t.eri);o.save(),o.translate(0,-u),t.each((function(t,e){bn(o,l,t,e)}),(function(t){return function(t){var e=a.has(t);if(e){var r=l.rows.getHeight(t);o.translate(0,-r)}return!e}(t)})),o.restore();var c=new Set;o.save(),o.translate(0,-u),l.eachMergesInView(t,(function(t){var e=t.sri,r=t.sci,n=t.eri;if(a.has(e)){if(!c.has(e)){c.add(e);var i=l.rows.sumHeight(e,n+1);o.translate(0,-i)}}else bn(o,l,e,r)})),o.restore(),mn.call(this,t),o.restore()}function wn(t,e,r,n){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,r,n),i.restore()}function Sn(t,e,r,n,i,o){var l=this,a=this.draw,u=this.data,c=e.h,f=e.w,s=o+n,h=i+r;a.save(),a.attr(pn),"all"!==t&&"left"!==t||a.fillRect(0,s,r,c),"all"!==t&&"top"!==t||a.fillRect(h,0,f,n);var y=u.selector.range,p=y.sri,v=y.sci,d=y.eri,b=y.eci;a.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Ir(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Ar(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(u.rowEach(e.sri,e.eri,(function(t,e,n){var i=s+e,o=t;a.line([0,i],[r,i]),p<=o&&o<d+1&&wn.call(l,0,i,r,n),a.fillText(o+1,r/2,i+n/2),t>0&&u.rows.isHide(t-1)&&(a.save(),a.attr({strokeStyle:"#c6c6c6"}),a.line([5,i+5],[r-5,i+5]),a.restore())})),a.line([0,c+s],[r,c+s]),a.line([r,s],[r,c+s])),"all"!==t&&"top"!==t||(u.colEach(e.sci,e.eci,(function(t,e,r){var i=h+e,o=t;a.line([i,0],[i,n]),v<=o&&o<b+1&&wn.call(l,i,0,r,n),a.fillText(k(o),i+r/2,n/2),t>0&&u.cols.isHide(t-1)&&(a.save(),a.attr({strokeStyle:"#c6c6c6"}),a.line([i+5,5],[i+5,n-5]),a.restore())})),a.line([f+h,0],[f+h,n]),a.line([0,n],[f+h,n])),a.restore()}function On(t,e){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),r.restore()}function jn(t,e,r,n,i){var o=t.sri,l=t.sci,a=t.eri,u=t.eci,c=t.w,f=t.h,s=this.draw,h=this.data,y=h.settings;s.save(),s.attr(vn).translate(e+n,r+i),y.showGrid?(h.rowEach(o,a,(function(t,e,r){t!==o&&s.line([0,e],[c,e]),t===a&&s.line([0,e+r],[c,e+r])})),h.colEach(l,u,(function(t,e,r){t!==l&&s.line([e,0],[e,f]),t===u&&s.line([e+r,0],[e+r,f])})),s.restore()):s.restore()}function kn(t,e,r,n){var i=this.draw,o=this.data,l=o.viewWidth()-t,a=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,n],[l,n]),i.line([r,0],[r,a]),i.restore()}var Pn=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new Mr(e,r.viewWidth(),r.viewHeight()),this.data=r}var e,r,n;return e=t,(r=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,r=t.cols.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),l=t.freezeTotalHeight(),a=t.scroll,u=a.x,c=a.y;jn.call(this,i,r,n,o,l),gn.call(this,i,r,n,-u,-c),Sn.call(this,"all",i,r,n,o,l),On.call(this,r,n);var f=sn(t.freeze,2),s=f[0],h=f[1];if(s>0||h>0){if(s>0){var y=i.clone();y.sri=0,y.eri=s-1,y.h=l,jn.call(this,y,r,n,o,0),gn.call(this,y,r,n,-u,0),Sn.call(this,"top",y,r,n,o,0)}if(h>0){var p=i.clone();p.sci=0,p.eci=h-1,p.w=o,jn.call(this,p,r,n,0,l),Sn.call(this,"left",p,r,n,0,l),gn.call(this,p,r,n,0,-c)}var v=t.freezeViewRange();jn.call(this,v,r,n,0,0),Sn.call(this,"all",v,r,n,0,0),gn.call(this,v,r,n,0,0),kn.call(this,r,n,o,l)}}},{key:"clear",value:function(){this.draw.clear()}}])&&yn(e.prototype,r),n&&yn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xn(t){return function(t){if(Array.isArray(t))return Tn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Tn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Cn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==En(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==En(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===En(o)?o:String(o)),n)}var i,o}var Rn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],_n=["landscape","portrait"];function An(t){return parseInt(96*t,10)}function In(t){"cancel"===t?this.el.hide():this.toPrint()}function Dn(t){var e=this.paper,r=t.target.value,n=Rn[r];e.w=An(n[1]),e.h=An(n[2]),this.preview()}function Nn(t){var e=this.paper,r=t.target.value,n=_n[r];e.orientation=n,this.preview()}var zn=function(){function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:An(Rn[0][1]),h:An(Rn[0][2]),padding:50,orientation:_n[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=w("div","".concat(ee,"-print")).children(w("div","".concat(ee,"-print-bar")).children(w("div","-title").child("Print settings"),w("div","-right").children(w("div","".concat(ee,"-buttons")).children(new Or("cancel").on("click",In.bind(this,"cancel")),new Or("next","primary").on("click",In.bind(this,"next"))))),w("div","".concat(ee,"-print-content")).children(this.contentEl=w("div","-content"),w("div","-sider").child(w("form","").children(w("fieldset","").children(w("label","").child("".concat(Ot("print.size"))),(r=w("select","")).children.apply(r,xn(Rn.map((function(t,e){return w("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",Dn.bind(this))),w("fieldset","").children(w("label","").child("".concat(Ot("print.orientation"))),(n=w("select","")).children.apply(n,xn(_n.map((function(t,e){return w("option","").attr("value",e).child("".concat(Ot("print.orientations")[e]))})))).on("change",Nn.bind(this))))))).hide()}var e,r,n;return e=t,(r=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,r=this.paper,n=r.width,i=r.height,o=r.padding,l=n-2*o,a=i-2*o,u=e.contentRange(),c=parseInt(u.h/a,10)+1,f=l/u.w,s=o,h=o;f>1&&(s+=(l-u.w)/2);var y=0,p=0;this.contentEl.html(""),this.canvases=[];for(var v={sri:0,sci:0,eri:0,eci:0},d=function(){var r=0,o=0,l=w("div","".concat(ee,"-canvas-card")),c=w("canvas","".concat(ee,"-canvas"));t.canvases.push(c.el);var d=new Mr(c.el,n,i);for(d.save(),d.translate(s,h),f<1&&d.scale(f,f);y<=u.eri;y+=1){var b=e.rows.getHeight(y);if(!((r+=b)<a)){o=-(r-b);break}for(var m=0;m<=u.eci;m+=1)bn(d,e,y,m,p),v.eci=m}v.eri=y,d.restore(),d.save(),d.translate(s,h),f<1&&d.scale(f,f);var g=p;e.eachMergesInView(v,(function(t){var r=t.sri,n=t.sci;bn(d,e,r,n,g)})),d.restore(),v.sri=v.eri,v.sci=v.eci,p+=o,t.contentEl.child(w("div","".concat(ee,"-canvas-card-wraper")).child(l.child(c)))},b=0;b<c;b+=1)d();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=w("iframe","").hide().el;l.document.body.appendChild(e);var r=e.contentWindow,n=r.document,i=l.document.createElement("style");i.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),n.head.appendChild(i),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),n.body.appendChild(e)})),r.print()}}])&&Cn(e.prototype,r),n&&Cn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Mn(t){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t){return function(t){if(Array.isArray(t))return Hn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Hn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Fn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Mn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Mn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Mn(o)?o:String(o)),n)}var i,o}var Vn=[{key:"copy",title:jt("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:jt("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:jt("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:jt("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:jt("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:jt("contextmenu.insertRow")},{key:"insert-column",title:jt("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:jt("contextmenu.deleteRow")},{key:"delete-column",title:jt("contextmenu.deleteColumn")},{key:"delete-cell-text",title:jt("contextmenu.deleteCellText")},{key:"hide",title:jt("contextmenu.hide")},{key:"divider"},{key:"validation",title:jt("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:jt("contextmenu.cellprintable")},{key:"cell-non-printable",title:jt("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:jt("contextmenu.celleditable")},{key:"cell-non-editable",title:jt("contextmenu.cellnoneditable")}];function Un(t){var e=this;return"divider"===t.key?w("div","".concat(ee,"-item divider")):w("div","".concat(ee,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),w("div","label").child(t.label||""))}function $n(){var t=this;return Vn.map((function(e){return Un.call(t,e)}))}var qn=function(){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Fn(this,t),this.menuItems=$n.call(this),this.el=(r=w("div","".concat(ee,"-contextmenu"))).children.apply(r,Bn(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=n,this.setMode("range")}var e,r,n;return e=t,(r=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),c(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var r=this.el,n=r.show().offset().width,i=this.viewFn(),o=i.height/2,l=t;i.width-t<=n&&(l-=n),r.css("left","".concat(l,"px")),e>o?r.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):r.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),f(r)}}}])&&Wn(e.prototype,r),n&&Wn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Ln(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ln(o)?o:String(o)),n)}var i,o}var Xn=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=Ot("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),r&&(this.tip+=" (".concat(r,")")),this.tag=e,this.shortcut=r,this.value=n,this.el=this.element(),this.change=function(){}}var e,r,n;return e=t,(r=[{key:"element",value:function(){var t=this,e=this.tip;return w("div","".concat(ee,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var r=e.getBoundingClientRect(),n=r.left,i=r.top,o=r.width,u=r.height,c=w("div","".concat(ee,"-tooltip")).html(t).show();l.document.body.appendChild(c.el);var f=c.box();c.css("left","".concat(n+o/2-f.width/2,"px")).css("top","".concat(i+u+2,"px")),a(e,"mouseleave",(function(){l.document.body.contains(c.el)&&l.document.body.removeChild(c.el)})),a(e,"click",(function(){l.document.body.contains(c.el)&&l.document.body.removeChild(c.el)}))}}(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&Yn(e.prototype,r),n&&Yn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Zn(t){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Zn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Zn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Zn(o)?o:String(o)),n)}var i,o}function Gn(){return(Gn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Qn(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Qn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ni(t)););return t}function ti(t,e){return(ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ni(t);if(e){var i=ni(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ri(this,r)}}function ri(t,e){if(e&&("object"===Zn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ii=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ti(t,e)}(o,t);var e,r,n,i=ei(o);function o(){return Kn(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,e=this.tag;return this.dd=this.dropdown(),this.dd.change=function(r){return t.change(e,t.getValue(r))},Gn(ni(o.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&Jn(e.prototype,r),n&&Jn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Xn);function oi(t){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function li(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ai(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==oi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===oi(o)?o:String(o)),n)}var i,o}function ui(t,e){return(ui=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ci(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=si(t);if(e){var i=si(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fi(this,r)}}function fi(t,e){if(e&&("object"===oi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ui(t,e)}(o,t);var e,r,n,i=ci(o);function o(t,e,r,n){var l,a;li(this,o),(a=i.call(this,"div","".concat(ee,"-dropdown ").concat(n))).title=t,a.change=function(){},a.headerClick=function(){},"string"==typeof t?a.title=w("div","".concat(ee,"-dropdown-title")).child(t):r&&a.title.addClass("arrow-left"),a.contentEl=w("div","".concat(ee,"-dropdown-content")).css("width",e).hide();for(var u=arguments.length,c=new Array(u>4?u-4:0),f=4;f<u;f++)c[f-4]=arguments[f];return(l=a).setContentChildren.apply(l,c),a.headerEl=w("div","".concat(ee,"-dropdown-header")),a.headerEl.on("click",(function(){"block"!==a.contentEl.css("display")?a.show():a.hide()})).children(a.title,r?w("div","".concat(ee,"-icon arrow-right")).child(w("div","".concat(ee,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}return e=o,(r=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),f(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),c(this.parent())}}])&&ai(e.prototype,r),n&&ai(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(g);function yi(t){return(yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pi(t){return function(t){if(Array.isArray(t))return vi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return vi(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vi(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function di(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==yi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==yi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===yi(o)?o:String(o)),n)}var i,o}function bi(t,e){return(bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=wi(t);if(e){var i=wi(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return gi(this,r)}}function gi(t,e){if(e&&("object"===yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function wi(t){return(wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Si=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bi(t,e)}(o,t);var e,r,n,i=mi(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=new qe("align-".concat(e)),l=t.map((function(t){return(e="align-".concat(t),w("div","".concat(ee,"-item")).child(new qe(e))).on("click",(function(){r.setTitle(t),r.change(t)}));var e}));return r=i.call.apply(i,[this,n,"auto",!0,"bottom-left"].concat(pi(l)))}return e=o,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&di(e.prototype,r),n&&di(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hi);function Oi(t){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Oi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Oi(o)?o:String(o)),n)}var i,o}function ki(t,e){return(ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Pi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xi(t);if(e){var i=xi(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ei(this,r)}}function Ei(t,e){if(e&&("object"===Oi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xi(t){return(xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ti=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ki(t,e)}(o,t);var e,r,n,i=Pi(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"align","",t)}return e=o,(r=[{key:"dropdown",value:function(){var t=this.value;return new Si(["left","center","right"],t)}}])&&ji(e.prototype,r),n&&ji(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function Ci(t){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Ci(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ci(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ci(o)?o:String(o)),n)}var i,o}function _i(t,e){return(_i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ai(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Di(t);if(e){var i=Di(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ii(this,r)}}function Ii(t,e){if(e&&("object"===Ci(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ni=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_i(t,e)}(o,t);var e,r,n,i=Ai(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"valign","",t)}return e=o,(r=[{key:"dropdown",value:function(){var t=this.value;return new Si(["top","middle","bottom"],t)}}])&&Ri(e.prototype,r),n&&Ri(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function zi(t){return(zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==zi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==zi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===zi(o)?o:String(o)),n)}var i,o}function Hi(){return(Hi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Fi(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Fi(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$i(t)););return t}function Wi(t,e){return(Wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Vi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$i(t);if(e){var i=$i(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ui(this,r)}}function Ui(t,e){if(e&&("object"===zi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $i(t){return($i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wi(t,e)}(o,t);var e,r,n,i=Vi(o);function o(){return Mi(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"element",value:function(){var t=this,e=this.tag;return Hi($i(o.prototype),"element",this).call(this).child(new qe(e)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&Bi(e.prototype,r),n&&Bi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Xn);function Li(t){return(Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Li(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Li(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Li(o)?o:String(o)),n)}var i,o}function Xi(t,e){return(Xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Zi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ji(t);if(e){var i=Ji(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ki(this,r)}}function Ki(t,e){if(e&&("object"===Li(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xi(t,e)}(o,t);var e,r,n,i=Zi(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"autofilter")}return e=o,(r=[{key:"setState",value:function(){}}])&&Yi(e.prototype,r),n&&Yi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(qi);function Qi(t){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Qi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Qi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Qi(o)?o:String(o)),n)}var i,o}function eo(t,e){return(eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ro(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=io(t);if(e){var i=io(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return no(this,r)}}function no(t,e){if(e&&("object"===Qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eo(t,e)}(o,t);var e,r,n,i=ro(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"font-bold","Ctrl+B")}return e=o,r&&to(e.prototype,r),n&&to(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(qi);function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ao(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==lo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==lo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===lo(o)?o:String(o)),n)}var i,o}function uo(t,e){return(uo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function co(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=so(t);if(e){var i=so(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fo(this,r)}}function fo(t,e){if(e&&("object"===lo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function so(t){return(so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ho=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uo(t,e)}(o,t);var e,r,n,i=co(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"font-italic","Ctrl+I")}return e=o,r&&ao(e.prototype,r),n&&ao(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(qi);function yo(t){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==yo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==yo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===yo(o)?o:String(o)),n)}var i,o}function vo(t,e){return(vo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function bo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=go(t);if(e){var i=go(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return mo(this,r)}}function mo(t,e){if(e&&("object"===yo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vo(t,e)}(o,t);var e,r,n,i=bo(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"strike","Ctrl+U")}return e=o,r&&po(e.prototype,r),n&&po(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(qi);function So(t){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==So(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==So(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===So(o)?o:String(o)),n)}var i,o}function jo(t,e){return(jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ko(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Eo(t);if(e){var i=Eo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Po(this,r)}}function Po(t,e){if(e&&("object"===So(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Eo(t){return(Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jo(t,e)}(o,t);var e,r,n,i=ko(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"underline","Ctrl+U")}return e=o,r&&Oo(e.prototype,r),n&&Oo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(qi);function To(t){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Co(t){return function(t){if(Array.isArray(t))return Ro(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ro(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ro(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ro(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==To(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==To(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===To(o)?o:String(o)),n)}var i,o}function Ao(t,e,r){return e&&_o(t.prototype,e),r&&_o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Io=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Do=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],No=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function zo(t){var e=this;return w("td","").child(w("div","".concat(ee,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var Mo=Ao((function t(){var e,r,n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=w("div","".concat(ee,"-color-palette")),this.change=function(){};var o=w("table","").children((e=w("tbody","")).children.apply(e,[(r=w("tr","".concat(ee,"-theme-color-placeholders"))).children.apply(r,Co(Io.map((function(t){return zo.call(i,t)}))))].concat(Co(Do.map((function(t){var e;return(e=w("tr","".concat(ee,"-theme-colors"))).children.apply(e,Co(t.map((function(t){return zo.call(i,t)}))))}))),[(n=w("tr","".concat(ee,"-standard-colors"))).children.apply(n,Co(No.map((function(t){return zo.call(i,t)}))))])));this.el.child(o)}));function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ho(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Bo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Bo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Bo(o)?o:String(o)),n)}var i,o}function Fo(t,e){return(Fo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Wo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Uo(t);if(e){var i=Uo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Vo(this,r)}}function Vo(t,e){if(e&&("object"===Bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Uo(t){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $o=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fo(t,e)}(o,t);var e,r,n,i=Wo(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=new qe(t).css("height","16px").css("border-bottom","3px solid ".concat(e)),l=new Mo;return l.change=function(t){r.setTitle(t),r.change(t)},r=i.call(this,n,"auto",!1,"bottom-left",l.el)}return e=o,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Ho(e.prototype,r),n&&Ho(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hi);function qo(t){return(qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lo(t){return function(t){if(Array.isArray(t))return Yo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Yo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yo(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==qo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==qo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===qo(o)?o:String(o)),n)}var i,o}function Zo(t,e){return(Zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ko(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Go(t);if(e){var i=Go(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Jo(this,r)}}function Jo(t,e){if(e&&("object"===qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Go(t){return(Go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qo=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],tl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zo(t,e)}(o,t);var e,r,n,i=Ko(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=new qe("line-type"),n=0,l=Qo.map((function(r,i){return w("div","".concat(ee,"-item state ").concat(t===r[0]?"checked":"")).on("click",(function(){l[n].toggle("checked"),l[i].toggle("checked"),n=i,e.hide(),e.change(r)})).child(w("div","".concat(ee,"-line-type")).html(r[1]))}));return e=i.call.apply(i,[this,r,"auto",!1,"bottom-left"].concat(Lo(l)))}return e=o,r&&Xo(e.prototype,r),n&&Xo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(hi);function el(t){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rl(t){return function(t){if(Array.isArray(t))return ol(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||il(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||il(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function il(t,e){if(t){if("string"==typeof t)return ol(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ol(t,e):void 0}}function ol(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ll(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==el(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==el(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===el(o)?o:String(o)),n)}var i,o}function al(t,e,r){return e&&ll(t.prototype,e),r&&ll(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ul(){var t;return w("table","").child((t=w("tbody","")).children.apply(t,arguments))}function cl(t){var e=this;return w("td","").child(w("div","".concat(ee,"-border-palette-cell")).child(new qe("border-".concat(t))).on("click",(function(){e.mode=t;var r=e.mode,n=e.style,i=e.color;e.change({mode:r,style:n,color:i})})))}var fl=al((function t(){var e,r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new $o("line-color",this.color),this.ddColor.change=function(t){n.color=t},this.ddType=new tl(this.style),this.ddType.change=function(t){var e=nl(t,1)[0];n.style=e},this.el=w("div","".concat(ee,"-border-palette"));var i=ul(w("tr","").children(w("td","".concat(ee,"-border-palette-left")).child(ul((e=w("tr","")).children.apply(e,rl(["all","inside","horizontal","vertical","outside"].map((function(t){return cl.call(n,t)})))),(r=w("tr","")).children.apply(r,rl(["left","top","right","bottom","none"].map((function(t){return cl.call(n,t)})))))),w("td","".concat(ee,"-border-palette-right")).children(w("div","".concat(ee,"-toolbar-btn")).child(this.ddColor.el),w("div","".concat(ee,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)}));function sl(t){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==sl(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==sl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===sl(o)?o:String(o)),n)}var i,o}function yl(t,e){return(yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function pl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=dl(t);if(e){var i=dl(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return vl(this,r)}}function vl(t,e){if(e&&("object"===sl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dl(t){return(dl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yl(t,e)}(o,t);var e,r,n,i=pl(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new qe("border-all"),r=new fl;return r.change=function(e){t.change(e),t.hide()},t=i.call(this,e,"auto",!1,"bottom-left",r.el)}return e=o,r&&hl(e.prototype,r),n&&hl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(hi);function ml(t){return(ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ml(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ml(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ml(o)?o:String(o)),n)}var i,o}function wl(t,e){return(wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Sl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=jl(t);if(e){var i=jl(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ol(this,r)}}function Ol(t,e){if(e&&("object"===ml(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function jl(t){return(jl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wl(t,e)}(o,t);var e,r,n,i=Sl(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"border")}return e=o,(r=[{key:"dropdown",value:function(){return new bl}}])&&gl(e.prototype,r),n&&gl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function Pl(t){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function El(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Pl(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Pl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Pl(o)?o:String(o)),n)}var i,o}function Tl(){return(Tl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Cl(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Cl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Il(t)););return t}function Rl(t,e){return(Rl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Il(t);if(e){var i=Il(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Al(this,r)}}function Al(t,e){if(e&&("object"===Pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Il(t){return(Il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rl(t,e)}(o,t);var e,r,n,i=_l(o);function o(){return El(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"element",value:function(){var t=this;return Tl(Il(o.prototype),"element",this).call(this).child(new qe(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&xl(e.prototype,r),n&&xl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Xn);function Nl(t){return(Nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Nl(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Nl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Nl(o)?o:String(o)),n)}var i,o}function Ml(t,e){return(Ml=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Bl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Fl(t);if(e){var i=Fl(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Hl(this,r)}}function Hl(t,e){if(e&&("object"===Nl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Fl(t){return(Fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ml(t,e)}(o,t);var e,r,n,i=Bl(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"clearformat")}return e=o,r&&zl(e.prototype,r),n&&zl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Dl);function Vl(t){return(Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ul(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Vl(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Vl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Vl(o)?o:String(o)),n)}var i,o}function $l(t,e){return($l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ql(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Yl(t);if(e){var i=Yl(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ll(this,r)}}function Ll(t,e){if(e&&("object"===Vl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Yl(t){return(Yl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$l(t,e)}(o,t);var e,r,n,i=ql(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"paintformat")}return e=o,(r=[{key:"setState",value:function(){}}])&&Ul(e.prototype,r),n&&Ul(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(qi);function Zl(t){return(Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Zl(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Zl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Zl(o)?o:String(o)),n)}var i,o}function Jl(t,e){return(Jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Gl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ta(t);if(e){var i=ta(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ql(this,r)}}function Ql(t,e){if(e&&("object"===Zl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ta(t){return(ta=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ea=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jl(t,e)}(o,t);var e,r,n,i=Gl(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"color",void 0,t)}return e=o,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new $o(t,e)}}])&&Kl(e.prototype,r),n&&Kl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function ra(t){return(ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function na(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ra(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ra(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ra(o)?o:String(o)),n)}var i,o}function ia(t,e){return(ia=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=aa(t);if(e){var i=aa(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return la(this,r)}}function la(t,e){if(e&&("object"===ra(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ua=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ia(t,e)}(o,t);var e,r,n,i=oa(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"bgcolor",void 0,t)}return e=o,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new $o(t,e)}}])&&na(e.prototype,r),n&&na(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function ca(t){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fa(t){return function(t){if(Array.isArray(t))return sa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return sa(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sa(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sa(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ha(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ca(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ca(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ca(o)?o:String(o)),n)}var i,o}function ya(t,e){return(ya=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function pa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=da(t);if(e){var i=da(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return va(this,r)}}function va(t,e){if(e&&("object"===ca(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function da(t){return(da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ba=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ya(t,e)}(o,t);var e,r,n,i=pa(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=Hr.map((function(e){return w("div","".concat(ee,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=i.call.apply(i,[this,"10","60px",!0,"bottom-left"].concat(fa(e)))}return e=o,r&&ha(e.prototype,r),n&&ha(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(hi);function ma(t){return(ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ga(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ma(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ma(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ma(o)?o:String(o)),n)}var i,o}function wa(t,e){return(wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Sa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ja(t);if(e){var i=ja(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Oa(this,r)}}function Oa(t,e){if(e&&("object"===ma(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ja(t){return(ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ka=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wa(t,e)}(o,t);var e,r,n,i=Sa(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"font-size")}return e=o,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new ba}}])&&ga(e.prototype,r),n&&ga(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ea(t){return function(t){if(Array.isArray(t))return xa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return xa(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xa(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xa(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ta(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Pa(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Pa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Pa(o)?o:String(o)),n)}var i,o}function Ca(t,e){return(Ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ra(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Aa(t);if(e){var i=Aa(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _a(this,r)}}function _a(t,e){if(e&&("object"===Pa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Aa(t){return(Aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ia=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ca(t,e)}(o,t);var e,r,n,i=Ra(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=Br.map((function(e){return w("div","".concat(ee,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=i.call.apply(i,[this,Br[0].title,"160px",!0,"bottom-left"].concat(Ea(e)))}return e=o,r&&Ta(e.prototype,r),n&&Ta(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(hi);function Da(t){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Na(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Da(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Da(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Da(o)?o:String(o)),n)}var i,o}function za(t,e){return(za=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ma(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ha(t);if(e){var i=Ha(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ba(this,r)}}function Ba(t,e){if(e&&("object"===Da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ha(t){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Fa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&za(t,e)}(o,t);var e,r,n,i=Ma(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"font-name")}return e=o,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ia}}])&&Na(e.prototype,r),n&&Na(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function Wa(t){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Va(t){return function(t){if(Array.isArray(t))return Ua(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ua(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ua(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ua(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Wa(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Wa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Wa(o)?o:String(o)),n)}var i,o}function qa(t,e){return(qa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function La(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xa(t);if(e){var i=Xa(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ya(this,r)}}function Ya(t,e){if(e&&("object"===Wa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Xa(t){return(Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Za=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qa(t,e)}(o,t);var e,r,n,i=La(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=un.slice(0);return e.splice(2,0,{key:"divider"}),e.splice(8,0,{key:"divider"}),e=e.map((function(e){var r=w("div","".concat(ee,"-item"));return"divider"===e.key?r.addClass("divider"):(r.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&r.child(w("div","label").html(e.label))),r})),t=i.call.apply(i,[this,"Normal","220px",!0,"bottom-left"].concat(Va(e)))}return e=o,(r=[{key:"setTitle",value:function(t){for(var e=0;e<un.length;e+=1)un[e].key===t&&this.title.html(un[e].title());this.hide()}}])&&$a(e.prototype,r),n&&$a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hi);function Ka(t){return(Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ja(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Ka(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ka(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ka(o)?o:String(o)),n)}var i,o}function Ga(t,e){return(Ga=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Qa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=eu(t);if(e){var i=eu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return tu(this,r)}}function tu(t,e){if(e&&("object"===Ka(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function eu(t){return(eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ru=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ga(t,e)}(o,t);var e,r,n,i=Qa(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"format")}return e=o,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Za}}])&&Ja(e.prototype,r),n&&Ja(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function nu(t){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iu(t){return function(t){if(Array.isArray(t))return ou(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ou(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ou(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ou(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==nu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==nu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===nu(o)?o:String(o)),n)}var i,o}function au(t,e){return(au=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function uu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fu(t);if(e){var i=fu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return cu(this,r)}}function cu(t,e){if(e&&("object"===nu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fu(t){return(fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var su=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&au(t,e)}(o,t);var e,r,n,i=uu(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=Jr.map((function(e){return w("div","".concat(ee,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=i.call.apply(i,[this,new qe("formula"),"180px",!0,"bottom-left"].concat(iu(e)))}return e=o,r&&lu(e.prototype,r),n&&lu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(hi);function hu(t){return(hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==hu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==hu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===hu(o)?o:String(o)),n)}var i,o}function pu(t,e){return(pu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bu(t);if(e){var i=bu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return du(this,r)}}function du(t,e){if(e&&("object"===hu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bu(t){return(bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pu(t,e)}(o,t);var e,r,n,i=vu(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"formula")}return e=o,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new su}}])&&yu(e.prototype,r),n&&yu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(ii);function gu(t){return(gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==gu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==gu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===gu(o)?o:String(o)),n)}var i,o}function Su(t,e){return(Su=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ou(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ku(t);if(e){var i=ku(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ju(this,r)}}function ju(t,e){if(e&&("object"===gu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ku(t){return(ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Su(t,e)}(o,t);var e,r,n,i=Ou(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"freeze")}return e=o,r&&wu(e.prototype,r),n&&wu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(qi);function Eu(t){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Eu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Eu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Eu(o)?o:String(o)),n)}var i,o}function Tu(t,e){return(Tu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Cu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=_u(t);if(e){var i=_u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ru(this,r)}}function Ru(t,e){if(e&&("object"===Eu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Au=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tu(t,e)}(o,t);var e,r,n,i=Cu(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"merge")}return e=o,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&xu(e.prototype,r),n&&xu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(qi);function Iu(t){return(Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Du(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Iu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Iu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Iu(o)?o:String(o)),n)}var i,o}function Nu(t,e){return(Nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function zu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Bu(t);if(e){var i=Bu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Mu(this,r)}}function Mu(t,e){if(e&&("object"===Iu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bu(t){return(Bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Hu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nu(t,e)}(o,t);var e,r,n,i=zu(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"redo","Ctrl+Y")}return e=o,r&&Du(e.prototype,r),n&&Du(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Dl);function Fu(t){return(Fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Fu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Fu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Fu(o)?o:String(o)),n)}var i,o}function Vu(t,e){return(Vu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Uu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=qu(t);if(e){var i=qu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $u(this,r)}}function $u(t,e){if(e&&("object"===Fu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function qu(t){return(qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Lu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vu(t,e)}(o,t);var e,r,n,i=Uu(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"undo","Ctrl+Z")}return e=o,r&&Wu(e.prototype,r),n&&Wu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Dl);function Yu(t){return(Yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Yu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Yu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Yu(o)?o:String(o)),n)}var i,o}function Zu(t,e){return(Zu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ku(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Gu(t);if(e){var i=Gu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ju(this,r)}}function Ju(t,e){if(e&&("object"===Yu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Gu(t){return(Gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zu(t,e)}(o,t);var e,r,n,i=Ku(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"print","Ctrl+P")}return e=o,r&&Xu(e.prototype,r),n&&Xu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Dl);function tc(t){return(tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ec(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==tc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===tc(o)?o:String(o)),n)}var i,o}function rc(t,e){return(rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oc(t);if(e){var i=oc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ic(this,r)}}function ic(t,e){if(e&&("object"===tc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oc(t){return(oc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rc(t,e)}(o,t);var e,r,n,i=nc(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"textwrap")}return e=o,r&&ec(e.prototype,r),n&&ec(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(qi);function ac(t){return(ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==ac(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ac(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ac(o)?o:String(o)),n)}var i,o}function cc(t,e,r){return e&&uc(t.prototype,e),r&&uc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hc(t,e)}function hc(t,e){return(hc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=vc(t);if(e){var i=vc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return pc(this,r)}}function pc(t,e){if(e&&("object"===ac(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function vc(t){return(vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var dc=function(t){sc(r,t);var e=yc(r);function r(){var t;fc(this,r);var n=new qe("ellipsis"),i=w("div","".concat(ee,"-toolbar-more"));return(t=e.call(this,n,"auto",!1,"bottom-right",i)).moreBtns=i,t.contentEl.css("max-width","420px"),t}return cc(r)}(hi),bc=function(t){sc(r,t);var e=yc(r);function r(){var t;return fc(this,r),(t=e.call(this,"more")).el.hide(),t}return cc(r,[{key:"dropdown",value:function(){return new dc}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),r}(ii);function mc(t){return(mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==mc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==mc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===mc(o)?o:String(o)),n)}var i,o}function Sc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Oc(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jc(){return w("div","".concat(ee,"-toolbar-divider"))}function kc(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var r=e.el,n=r.box(),i=r.computedStyle(),o=i.marginLeft,l=i.marginRight;t.btns2.push([r,n.width+parseInt(o,10)+parseInt(l,10)])}));else{var r=e.box(),n=e.computedStyle(),i=n.marginLeft,o=n.marginRight;t.btns2.push([e,r.width+parseInt(i,10)+parseInt(o,10)])}}))}function Pc(){var t,e,r=this.el,n=this.btns,i=this.moreEl,o=this.btns2,l=i.dd,a=l.moreBtns,u=l.contentEl;r.css("width","".concat(this.widthFn(),"px"));var c=r.box(),f=160,s=12,h=[],y=[];o.forEach((function(t,e){var r=Sc(t,2),n=r[0],i=r[1];f+=i,e===o.length-1||f<c.width?h.push(n):(s+=i,y.push(n))})),(t=n.html("")).children.apply(t,h),(e=a.html("")).children.apply(e,y),u.css("width","".concat(s,"px")),y.length>0?i.show():i.hide()}function Ec(t){var e=this,r=new Xn;r.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),r.tip=t.tip||"";var n=t.el;if(t.icon&&(n=w("img").attr("src",t.icon)),n){var i=w("div","".concat(ee,"-icon"));i.child(n),r.el.child(i)}return r}var xc=function(){function t(e,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];gc(this,t),this.data=e,this.change=function(){},this.widthFn=r,this.isHide=i;var o=e.defaultStyle();this.items=[[this.undoEl=new Lu,this.redoEl=new Hu,new Qu,this.paintformatEl=new Xl,this.clearformatEl=new Wl],jc(),[this.formatEl=new ru],jc(),[this.fontEl=new Fa,this.fontSizeEl=new ka],jc(),[this.boldEl=new oo,this.italicEl=new ho,this.underlineEl=new xo,this.strikeEl=new wo,this.textColorEl=new ea(o.color)],jc(),[this.fillColorEl=new ua(o.bgcolor),this.borderEl=new kl,this.mergeEl=new Au],jc(),[this.alignEl=new Ti(o.align),this.valignEl=new Ni(o.valign),this.textwrapEl=new lc],jc(),[this.freezeEl=new Pu,this.autofilterEl=new Gi,this.formulaEl=new mu]];var l=e.settings.extendToolbar,u=void 0===l?{}:l;if(u.left&&u.left.length>0){this.items.unshift(jc());var c=u.left.map(Ec.bind(this));this.items.unshift(c)}if(u.right&&u.right.length>0){this.items.push(jc());var f=u.right.map(Ec.bind(this));this.items.push(f)}this.items.push([this.moreEl=new bc]),this.el=w("div","".concat(ee,"-toolbar")),this.btns=w("div","".concat(ee,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout((function(){kc.call(n),Pc.call(n)}),0),a(window,"resize",(function(){Pc.call(n)})))}var e,r,n;return e=t,(r=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var r=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(r.name),this.fontSizeEl.setState(r.size),this.boldEl.setState(r.bold),this.italicEl.setState(r.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&wc(e.prototype,r),n&&wc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Tc(t){return(Tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cc(t){return function(t){if(Array.isArray(t))return Rc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Rc(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rc(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ac(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Tc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Tc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Tc(o)?o:String(o)),n)}var i,o}var Ic=function(){function t(e,r){var n,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";_c(this,t),this.title=e,this.el=w("div","".concat(ee,"-modal")).css("width",o).children(w("div","".concat(ee,"-modal-header")).children(new qe("close").on("click.stop",(function(){return i.hide()})),this.title),(n=w("div","".concat(ee,"-modal-content"))).children.apply(n,Cc(r))).hide()}var e,r,n;return e=t,(r=[{key:"show",value:function(){var t=this;this.dimmer=w("div","".concat(ee,"-dimmer active")),l.document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),r=e.width,n=e.height,i=l.document.documentElement,o=i.clientHeight,u=i.clientWidth;this.el.offset({left:(u-r)/2,top:(o-n)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},a(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),l.document.body.removeChild(this.dimmer.el),u(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&Ac(e.prototype,r),n&&Ac(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Dc(t){return(Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Dc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Dc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Dc(o)?o:String(o)),n)}var i,o}var zc=function(){function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=w("div","".concat(ee,"-form-input")),this.input=w("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",r),this.el.child(this.input)}var e,r,n;return e=t,(r=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Nc(e.prototype,r),n&&Nc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Mc(t){return(Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Mc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Mc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Mc(o)?o:String(o)),n)}var i,o}var Fc=function(){function t(e,r,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};Bc(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=w("div","".concat(ee,"-form-select")),this.suggest=new Be(r.map((function(t){return{key:t,title:i.getTitle(t)}})),(function(t){i.itemClick(t.key),l(t.key),i.vchange(t.key)}),n,this.el),this.el.children(this.itemEl=w("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return i.show()}))}var e,r,n;return e=t,(r=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&Hc(e.prototype,r),n&&Hc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Wc(t){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Wc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Wc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Wc(o)?o:String(o)),n)}var i,o}var Uc={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},$c=function(){function t(e,r,n,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=r,n&&(this.label=w("label","label").css("width","".concat(i,"px")).html(n)),this.tip=w("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=w("div","".concat(ee,"-form-field")).children(this.label,e.el,this.tip)}var e,r,n;return e=t,(r=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,r=this.tip,n=this.el,i=t.val();return e.required&&/^\s*$/.test(i)?(r.html(Ot("validation.required")),n.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||Uc[e.type]).test(i)?(n.removeClass("error"),!0):(r.html(Ot("validation.notMatch")),n.addClass("error"),!1)}}])&&Vc(e.prototype,r),n&&Vc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function qc(t){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==qc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==qc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===qc(o)?o:String(o)),n)}var i,o}function Yc(t,e){return(Yc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Xc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Kc(t);if(e){var i=Kc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Zc(this,r)}}function Zc(t,e){if(e&&("object"===qc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Kc(t){return(Kc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yc(t,e)}(o,t);var e,r,n,i=Xc(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new $c(new Fc("cell",["cell"],"100%",(function(t){return Ot("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(Ot("dataValidation.range"),":"),100),r=new $c(new zc("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),n=new $c(new Fc("list",["list","number","date","phone","email"],"100%",(function(t){return Ot("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(Ot("dataValidation.criteria"),":"),100),l=new $c(new Fc("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return Ot("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),a=new $c(new zc("70px","10"),{required:!0}).hide(),u=new $c(new zc("70px","100"),{required:!0,type:"number"}).hide(),c=new $c(new zc("120px","a,b,c"),{required:!0}),f=new $c(new zc("70px","10"),{required:!0,type:"number"}).hide();return(t=i.call(this,Ot("contextmenu.validation"),[w("div","".concat(ee,"-form-fields")).children(e.el,r.el),w("div","".concat(ee,"-form-fields")).children(n.el,l.el,a.el,u.el,f.el,c.el),w("div","".concat(ee,"-buttons")).children(new Or("cancel").on("click",(function(){return t.btnClick("cancel")})),new Or("remove").on("click",(function(){return t.btnClick("remove")})),new Or("save","primary").on("click",(function(){return t.btnClick("save")})))])).mf=e,t.rf=r,t.cf=n,t.of=l,t.minvf=a,t.maxvf=u,t.vf=f,t.svf=c,t.change=function(){},t}return e=o,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",r=this.vf;r.input.hint(e),r.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,r=this.minvf,n=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),r.rule.type=t,n.rule.type=t,"date"===t?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,r=this.maxvf,n=this.vf;if("be"===t||"nbe"===t)e.show(),r.show(),n.hide();else{var i=this.cf.val();n.rule.type=i,"date"===i?n.hint("2018-11-12"):n.hint("10"),n.show(),e.hide(),r.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<e.length;r+=1){var n=this[e[r]];if(n.isShow()&&!n.validate())return}var i=this.mf.val(),o=this.rf.val(),l=this.cf.val(),a=this.of.val(),u=this.svf.val();"number"!==l&&"date"!==l||(u="be"===a||"nbe"===a?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:l,operator:a,required:!1,value:u}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,r=this.rf,n=this.cf,i=this.of,o=this.svf,l=this.vf,a=this.minvf,u=this.maxvf,c=t.mode,f=t.ref,s=t.validator||{type:"list"},h=s.type,y=s.operator,p=s.value;e.val(c||"cell"),r.val(f),n.val(h),i.val(y),Array.isArray(p)?(a.val(p[0]),u.val(p[1])):(o.val(p||""),l.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(y)}this.show()}}])&&Lc(e.prototype,r),n&&Lc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Ic);function Gc(t){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Gc(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Gc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Gc(o)?o:String(o)),n)}var i,o}function tf(t){return w("div","".concat(ee,"-item ").concat(t))}function ef(t){var e=this;return tf("state").child(Ot("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function rf(t){var e=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(t).forEach((function(i,o){var l=t[i],a=n.includes(i)?"checked":"";r.child(w("div","".concat(ee,"-item state ").concat(a)).on("click.stop",(function(){return e.filterClick(o,i)})).children(""===i?Ot("filter.empty"):i,w("div","label").html("(".concat(l,")"))))}))}function nf(){var t=this.filterhEl,e=this.filterValues,r=this.values;t.html("".concat(e.length," / ").concat(r.length)),t.checked(e.length===r.length)}var of=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=w("div","".concat(ee,"-body")),this.filterhEl=w("div","".concat(ee,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=w("div","".concat(ee,"-sort-filter")).children(this.sortAscEl=ef.call(this,"asc"),this.sortDescEl=ef.call(this,"desc"),tf("divider"),w("div","".concat(ee,"-filter")).children(this.filterhEl,this.filterbEl),w("div","".concat(ee,"-buttons")).children(new Or("cancel").on("click",(function(){return e.btnClick("cancel")})),new Or("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,r,n;return e=t,(r=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(e,r,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,r=this.sortDescEl;e.checked("asc"===t),r.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var r=this.filterbEl,n=this.filterValues,i=this.values,o=r.children();"all"===e?o.length===n.length?(this.filterValues=[],o.forEach((function(t){return w(t).checked(!1)}))):(this.filterValues=Array.from(i),o.forEach((function(t){return w(t).checked(!0)}))):w(o[t]).toggle("checked")?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1),nf.call(this)}},{key:"set",value:function(t,e,r,n){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==n?(this.sort=n.order,i.checked(n.asc()),o.checked(n.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=r?Array.from(r.value):Object.keys(e),rf.call(this,e,r),nf.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var r=1;f(this.el,(function(){r<=0&&e.hide(),r-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),c(this.el)}}])&&Qc(e.prototype,r),n&&Qc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function lf(t,e){var r=w("div","".concat(ee,"-toast")),n=w("div","".concat(ee,"-dimmer active"));r.children(w("div","".concat(ee,"-toast-header")).children(new qe("close").on("click.stop",(function(){return l.document.body.removeChild(r.el),void l.document.body.removeChild(n.el)})),t),w("div","".concat(ee,"-toast-content")).html(e)),l.document.body.appendChild(r.el),l.document.body.appendChild(n.el);var i=r.box(),o=i.width,a=i.height,u=l.document.documentElement,c=u.clientHeight,f=u.clientWidth;r.offset({left:(f-o)/2,top:(c-a)/3})}function af(t){return(af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==af(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==af(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===af(o)?o:String(o)),n)}var i,o}function cf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ff(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ff(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ff(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function sf(t,e){var r,n=this;return function(){for(var i=n,o=arguments.length,l=new Array(o),a=0;a<o;a++)l[a]=arguments[a];var u=l;r||(r=setTimeout((function(){r=null,t.apply(i,u)}),e))}}function hf(){var t=this.data,e=this.verticalScrollbar,r=this.horizontalScrollbar,n=t.getSelectedRect(),i=n.l,o=n.t,l=n.left,a=n.top,u=n.width,c=n.height,f=this.getTableOffset();if(Math.abs(l)+u>f.width)r.move({left:i+u-f.width});else{var s=t.freezeTotalWidth();l<s&&r.move({left:i-1-s})}if(Math.abs(a)+c>f.height)e.move({top:o+c-f.height-1});else{var h=t.freezeTotalHeight();a<h&&e.move({top:o-1-h})}}function yf(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==r){var o=this.table,l=this.selector,a=this.toolbar,u=this.data,c=this.contextMenu,f=u.getCell(e,r);t?(l.setEnd(e,r,i),this.trigger("cells-selected",f,l.range)):(l.set(e,r,n),this.trigger("cell-selected",f,e,r)),c.setMode(-1===e||-1===r?"row-col":"range"),a.reset(),o.render()}}function pf(t,e){var r=this.selector,n=this.data,i=n.rows,o=n.cols,l=cf(r.indexes,2),a=l[0],u=l[1],c=r.range,f=c.eri,s=c.eci;if(t){var h=cf(r.moveIndexes,2);a=h[0],u=h[1]}"left"===e?u>0&&(u-=1):"right"===e?(s!==u&&(u=s),u<o.len-1&&(u+=1)):"up"===e?a>0&&(a-=1):"down"===e?(f!==a&&(a=f),a<i.len-1&&(a+=1)):"row-first"===e?u=0:"row-last"===e?u=o.len-1:"col-first"===e?a=0:"col-last"===e&&(a=i.len-1),t&&(r.moveIndexes=[a,u]),yf.call(this,t,a,u),hf.call(this)}function vf(t){if(0===t.buttons&&t.target.className!=="".concat(ee,"-resizer-hover")){var e=t.offsetX,r=t.offsetY,n=this.rowResizer,i=this.colResizer,o=this.tableEl,l=this.data,a=l.rows,u=l.cols;if(e>u.indexWidth&&r>a.height)return n.hide(),void i.hide();var c=o.box(),f=l.getCellRectByXY(t.offsetX,t.offsetY);f.ri>=0&&-1===f.ci?(f.width=u.indexWidth,n.show(f,{width:c.width}),a.isHide(f.ri-1)?n.showUnhide(f.ri):n.hideUnhide()):n.hide(),-1===f.ri&&f.ci>=0?(f.height=a.height,i.show(f,{height:c.height}),u.isHide(f.ci-1)?i.showUnhide(f.ci):i.hideUnhide()):i.hide()}}function df(t){var e=this.verticalScrollbar,r=this.horizontalScrollbar,n=this.data,i=e.scroll().top,o=r.scroll().left,a=n.rows,u=n.cols,c=t.deltaY,f=t.deltaX,s=function(t,e){var r=t,n=0;do{n=e(r),r+=1}while(n<=0);return n},h=function(t){if(t>0){var r=n.scroll.ri+1;if(r<a.len){var o=s(r,(function(t){return a.getHeight(t)}));e.move({top:i+o-1})}}else{var l=n.scroll.ri-1;if(l>=0){var u=s(l,(function(t){return a.getHeight(t)}));e.move({top:0===l?0:i-u})}}},y=Math.abs(c),p=Math.abs(f),v=Math.max(y,p);/Firefox/i.test(l.window.navigator.userAgent)&&sf(h(t.detail),50),v===p&&sf(function(t){if(t>0){var e=n.scroll.ci+1;if(e<u.len){var i=s(e,(function(t){return u.getWidth(t)}));r.move({left:o+i-1})}}else{var l=n.scroll.ci-1;if(l>=0){var a=s(l,(function(t){return u.getWidth(t)}));r.move({left:0===l?0:o-a})}}}(f),50),v===y&&sf(h(c),50)}function bf(t,e){var r=this.verticalScrollbar,n=this.horizontalScrollbar,i=r.scroll().top,o=n.scroll().left;"left"===t||"right"===t?n.move({left:o-e}):"up"!==t&&"down"!==t||r.move({top:i-e})}function mf(){var t=this.data,e=this.verticalScrollbar,r=this.getTableOffset().height,n=t.exceptRowTotalHeight(0,-1);e.set(r,t.rows.totalHeight()-n)}function gf(){var t=this.data,e=this.horizontalScrollbar,r=this.getTableOffset().width;t&&e.set(r,t.cols.totalWidth())}function wf(){var t=this.selector,e=this.data,r=this.editor,n=cf(e.freeze,2),i=n[0],o=n[1];if(i>0||o>0){var l=e.freezeTotalWidth(),a=e.freezeTotalHeight();r.setFreezeLengths(l,a)}t.resetAreaOffset()}function Sf(){var t=this.tableEl,e=this.overlayerEl,r=this.overlayerCEl,n=this.table,i=this.toolbar,o=this.selector,l=this.el,a=this.getTableOffset(),u=this.getRect();t.attr(u),e.offset(u),r.offset(a),l.css("width","".concat(u.width,"px")),mf.call(this),gf.call(this),wf.call(this),n.render(),i.reset(),o.reset()}function Of(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function jf(t){var e=this.data,r=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),r.showClipboard())}function kf(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function Pf(t,e){var r=this,n=this.data;if("read"!==n.settings.mode)if(n.clipboard.isClear()){n.pasteFromSystemClipboard((function(){return Sf.call(r)}),(function(t){r.trigger("pasted-clipboard",t)}))}else if(n.paste(t,(function(t){return lf("Tip",t)})))Sf.call(this);else if(e){var i=e.clipboardData.getData("text/plain");this.data.pasteFromText(i),Sf.call(this)}}function Ef(){this.data.hideRowsOrCols(),Sf.call(this)}function xf(t,e){this.data.unhideRowsOrCols(t,e),Sf.call(this)}function Tf(){this.data.autofilter(),Sf.call(this)}function Cf(){var t=this.toolbar;t.paintformatActive()&&(Pf.call(this,"format"),Of.call(this),t.paintformatToggle())}function Rf(t){var e=this,r=this.selector,n=this.data,i=this.table,o=this.sortFilter,l=t.offsetX,a=t.offsetY,u=t.target.className==="".concat(ee,"-selector-corner"),c=n.getCellRectByXY(l,a),f=c.left,h=c.top,y=c.width,p=c.height,v=c.ri,d=c.ci,b=n.autoFilter;if(b.includes(v,d)&&f+y-20<l&&h+p-20<a){var m=b.items(d,(function(t,e){return n.rows.getCell(t,e)}));return o.hide(),o.set(d,m,b.getFilter(d),b.getSort(d)),void o.setOffset({left:f,top:h+p+2})}t.shiftKey||(u?r.showAutofill(v,d):yf.call(this,!1,v,d),s(window,(function(t){var i=n.getCellRectByXY(t.offsetX,t.offsetY);v=i.ri,d=i.ci,u?r.showAutofill(v,d):1!==t.buttons||t.shiftKey||yf.call(e,!0,v,d,!0,!0)}),(function(){u&&r.arange&&"read"!==n.settings.mode&&n.autofill(r.arange,"all",(function(t){return lf("Tip",t)}))&&i.render(),r.hideAutofill(),Cf.call(e)}))),u||1!==t.buttons||t.shiftKey&&yf.call(this,!0,v,d)}function _f(){var t=this.editor,e=this.data.getSelectedRect(),r=this.getTableOffset(),n="top";e.top>r.height/2&&(n="bottom"),t.setOffset(e,n)}function Af(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(_f.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Of.call(this))}function If(t){var e=this,r=this.data,n=this.table,i=this.selector;r.scrolly(t,(function(){i.resetBRLAreaOffset(),_f.call(e),n.render()}))}function Df(t){var e=this,r=this.data,n=this.table,i=this.selector;r.scrollx(t,(function(){i.resetBRTAreaOffset(),_f.call(e),n.render()}))}function Nf(t,e){var r=t.ri,n=this.table,i=this.selector,o=this.data,l=i.range,a=l.sri,u=l.eri;if(r>=a&&r<=u)for(var c=a;c<=u;c+=1)o.rows.setHeight(c,e);else o.rows.setHeight(r,e);n.render(),i.resetAreaOffset(),mf.call(this),_f.call(this)}function zf(t,e){var r=t.ci,n=this.table,i=this.selector,o=this.data,l=i.range,a=l.sci,u=l.eci;if(r>=a&&r<=u)for(var c=a;c<=u;c+=1)o.cols.setWidth(c,e);else o.cols.setWidth(r,e);n.render(),i.resetAreaOffset(),gf.call(this),_f.call(this)}function Mf(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table;if("read"!==r.settings.mode){r.setSelectedCellText(t,e);var i=r.selector,o=i.ri,l=i.ci;"finished"===e?n.render():this.trigger("cell-edited",t,o,l)}}function Bf(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Of.call(this),Sf.call(this))}function Hf(t,e){var r=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?jf.call(this):Of.call(this);else if("clearformat"===t)Bf.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Tf.call(this);else if("freeze"===t)if(e){var n=r.selector,i=n.ri,o=n.ci;this.freeze(i,o)}else this.freeze(0,0);else r.setSelectedCellAttr(t,e),"formula"!==t||r.selector.multiple()||Af.call(this),Sf.call(this)}function Ff(t,e,r,n){this.data.setAutoFilter(t,e,r,n),Sf.call(this)}function Wf(){var t,e,r,n,i,o,l=this,u=this.selector,c=this.overlayerEl,f=this.rowResizer,s=this.colResizer,y=this.verticalScrollbar,p=this.horizontalScrollbar,v=this.editor,d=this.contextMenu,b=this.toolbar,m=this.modalValidation,g=this.sortFilter;c.on("mousemove",(function(t){vf.call(l,t)})).on("mousedown",(function(t){v.clear(),d.hide(),2===t.buttons?(l.data.xyInSelectedRect(t.offsetX,t.offsetY)||Rf.call(l,t),d.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?Af.call(l):Rf.call(l,t)})).on("mousewheel.stop",(function(t){df.call(l,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&f.hide()})),u.inputChange=function(t){Mf.call(l,t,"input"),Af.call(l)},t=c.el,r=(e={move:function(t,e){bf.call(l,t,e)}}).move,n=e.end,i=0,o=0,a(t,"touchstart",(function(t){var e=t.touches[0],r=e.pageX,n=e.pageY;i=r,o=n})),a(t,"touchmove",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,l=e.pageY,a=n-i,u=l-o;(Math.abs(a)>10||Math.abs(u)>10)&&(h(a,u,t,r),i=n,o=l),t.preventDefault()}})),a(t,"touchend",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,l=e.pageY;h(r-i,l-o,t,n)}})),b.change=function(t,e){return Hf.call(l,t,e)},g.ok=function(t,e,r,n){return Ff.call(l,t,e,r,n)},f.finishedFn=function(t,e){Nf.call(l,t,e)},s.finishedFn=function(t,e){zf.call(l,t,e)},f.unhideFn=function(t){xf.call(l,"row",t)},s.unhideFn=function(t){xf.call(l,"col",t)},y.moveFn=function(t,e){If.call(l,t,e)},p.moveFn=function(t,e){Df.call(l,t,e)},v.change=function(t,e){Mf.call(l,e,t)},m.change=function(t){if("save"===t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(e=l.data).addValidation.apply(e,n)}else l.data.removeValidation()},d.itemClick=function(t){"validation"===t?m.setValue(l.data.getSelectedValidation()):"copy"===t?jf.call(l):"cut"===t?kf.call(l):"paste"===t?Pf.call(l,"all"):"paste-value"===t?Pf.call(l,"text"):"paste-format"===t?Pf.call(l,"format"):"hide"===t?Ef.call(l):Bf.call(l,t)},a(window,"resize",(function(){l.reload()})),a(window,"click",(function(t){l.focusing=c.contains(t.target)})),a(window,"paste",(function(t){l.focusing&&(Pf.call(l,"all",t),t.preventDefault())})),a(window,"copy",(function(t){l.focusing&&(jf.call(l,t),t.preventDefault())})),a(window,"keydown",(function(t){if(l.focusing){var e=t.keyCode||t.which,r=t.key,n=t.ctrlKey,i=t.shiftKey,o=t.metaKey;if(n||o)switch(e){case 90:l.undo(),t.preventDefault();break;case 89:l.redo(),t.preventDefault();break;case 67:break;case 88:kf.call(l),t.preventDefault();break;case 85:b.trigger("underline"),t.preventDefault();break;case 86:break;case 37:pf.call(l,i,"row-first"),t.preventDefault();break;case 38:pf.call(l,i,"col-first"),t.preventDefault();break;case 39:pf.call(l,i,"row-last"),t.preventDefault();break;case 40:pf.call(l,i,"col-last"),t.preventDefault();break;case 32:yf.call(l,!1,-1,l.data.selector.ci,!1),t.preventDefault();break;case 66:b.trigger("bold");break;case 73:b.trigger("italic")}else{switch(e){case 32:i&&yf.call(l,!1,l.data.selector.ri,-1,!1);break;case 27:d.hide(),Of.call(l);break;case 37:pf.call(l,i,"left"),t.preventDefault();break;case 38:pf.call(l,i,"up"),t.preventDefault();break;case 39:pf.call(l,i,"right"),t.preventDefault();break;case 40:pf.call(l,i,"down"),t.preventDefault();break;case 9:v.clear(),pf.call(l,!1,i?"left":"right"),t.preventDefault();break;case 13:v.clear(),pf.call(l,!1,i?"up":"down"),t.preventDefault();break;case 8:Bf.call(l,"delete-cell-text"),t.preventDefault()}"Delete"===r?(Bf.call(l,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(Mf.call(l,t.key,"input"),Af.call(l)):113===e&&Af.call(l)}}}))}var Vf=function(){function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=y();var i=r.settings,o=i.view,l=i.showToolbar,a=i.showContextmenu;this.el=w("div","".concat(ee,"-sheet")),this.toolbar=new xc(r,o.width,!l),this.print=new zn(r),e.children(this.toolbar.el,this.el,this.print.el),this.data=r,this.tableEl=w("canvas","".concat(ee,"-table")),this.rowResizer=new oe(!1,r.rows.height),this.colResizer=new oe(!0,r.cols.minWidth),this.verticalScrollbar=new ue(!0),this.horizontalScrollbar=new ue(!1),this.editor=new pr(Gr,(function(){return n.getTableOffset()}),r.rows.height),this.modalValidation=new Jc,this.contextMenu=new qn((function(){return n.getRect()}),!a),this.selector=new Te(r),this.overlayerCEl=w("div","".concat(ee,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=w("div","".concat(ee,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new of,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new Pn(this.tableEl.el,r),Wf.call(this),Sf.call(this),yf.call(this,!1,0,0)}var e,r,n;return e=t,(r=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,mf.call(this),gf.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),Sf.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Sf.call(this),this}},{key:"undo",value:function(){this.data.undo(),Sf.call(this)}},{key:"redo",value:function(){this.data.redo(),Sf.call(this)}},{key:"reload",value:function(){return Sf.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,r=t.cols,n=this.getRect(),i=n.width,o=n.height;return{width:i-r.indexWidth,height:o-e.height,left:r.indexWidth,top:e.height}}}])&&uf(e.prototype,r),n&&uf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Uf(t){return(Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||Lf(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qf(t){return function(t){if(Array.isArray(t))return Yf(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Lf(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lf(t,e){if(t){if("string"==typeof t)return Yf(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yf(t,e):void 0}}function Yf(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,o=void 0,o=function(t,e){if("object"!==Uf(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Uf(o)?o:String(o)),n)}var i,o}function Kf(t,e,r){return e&&Zf(t.prototype,e),r&&Zf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jf(t,e){return(Jf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Gf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ts(t);if(e){var i=ts(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Qf(this,r)}}function Qf(t,e){if(e&&("object"===Uf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ts(t){return(ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var es=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jf(t,e)}(r,t);var e=Gf(r);function r(t){var n;Xf(this,r);var i=new qe("ellipsis");return(n=e.call(this,i,"auto",!1,"top-left")).contentClick=t,n}return Kf(r,[{key:"reset",value:function(t){var e=this,r=t.map((function(t,r){return w("div","".concat(ee,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(r),e.hide()})).child(t)}));this.setContentChildren.apply(this,qf(r))}},{key:"setTitle",value:function(){}}]),r}(hi),rs=[{key:"delete",title:jt("contextmenu.deleteSheet")}];function ns(t){var e=this;return w("div","".concat(ee,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function is(){var t=this;return rs.map((function(e){return ns.call(t,e)}))}var os=function(){function t(){var e;Xf(this,t),this.el=(e=w("div","".concat(ee,"-contextmenu")).css("width","160px")).children.apply(e,qf(is.call(this))).hide(),this.itemClick=function(){}}return Kf(t,[{key:"hide",value:function(){var t=this.el;t.hide(),c(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),f(e)}}]),t}(),ls=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};Xf(this,t),this.swapFunc=n,this.updateFunc=o,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new es((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new os,this.contextMenu.itemClick=i,this.el=w("div","".concat(ee,"-bottombar")).children(this.contextMenu.el,this.menuEl=w("ul","".concat(ee,"-menu")).child(w("li","").children(new qe("add").on("click",(function(){r()})),w("span","").child(this.moreEl))))}return Kf(t,[{key:"addItem",value:function(t,e,r){var n=this;this.dataNames.push(t);var i=w("li",e?"active":"").child(t);i.on("click",(function(){n.clickSwap2(i)})).on("contextmenu",(function(t){if("read"!==r.mode){var e=t.target,o=e.offsetLeft,l=e.offsetHeight;n.contextMenu.setOffset({left:o,bottom:l+1}),n.deleteEl=i}})).on("dblclick",(function(){if("read"!==r.mode){var t=i.html(),e=new zc("auto","");e.val(t),e.input.on("blur",(function(e){var r=e.target.value,i=n.dataNames.findIndex((function(e){return e===t}));n.renameItem(i,r)})),i.html("").child(e.el),e.focus()}})),e&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var r=this.items.findIndex((function(t){return t===e}));if(this.items.splice(r,1),this.dataNames.splice(r,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var n=$f(this.items,1)[0];return this.activeEl=n,this.activeEl.toggle(),[r,0]}return[r,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}();r(1);function as(t){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function us(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=fs(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return l=t.done,t},e:function(t){a=!0,o=t},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw o}}}}function cs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,l,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return a}}(t,e)||fs(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fs(t,e){if(t){if("string"==typeof t)return ss(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ss(t,e):void 0}}function ss(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?hs(Object(r),!0).forEach((function(e){ps(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ps(t,e,r){return(e=bs(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ds(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bs(n.key),n)}}function bs(t){var e=function(t,e){if("object"!==as(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==as(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===as(e)?e:String(e)}var ms=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vs(this,t);var i=e;this.options=ys({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(i=document.querySelector(e)),l.current=i,l.window=i.getRootNode().defaultView,l.document=i.getRootNode();var o=new ResizeObserver((function(t){var e=cs(t,1)[0].contentRect,r=e.width,n=e.height;qt.width=r,qt.height=n;var i,o=us(l.resizeFunc);try{for(o.s();!(i=o.n()).done;){(0,i.value)()}}catch(t){o.e(t)}finally{o.f()}}));o.observe(i),this.bottombar=this.options.showBottomBar?new ls((function(){if("read"!==r.options.mode){var t=r.addSheet();r.sheet.resetData(t)}}),(function(t){var e=r.datas[t];r.sheet.resetData(e)}),(function(){r.deleteSheet()}),(function(t,e){r.datas[t].name=e,r.sheet.trigger("change")})):null,this.data=this.addSheet();var a=w("div","".concat(ee)).on("contextmenu",(function(t){return t.preventDefault()}));i.appendChild(a.el),this.sheet=new Vf(a,this.data),null!==this.bottombar&&a.child(this.bottombar.el)}var e,r,n;return e=t,n=[{key:"locale",value:function(t,e){!function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?gt=[t]:gt.unshift(t),e&&(wt[t]=e)}(t,e)}}],(r=[{key:"addSheet",value:function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),i=new te(n,this.options);return i.change=function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(i),null!==this.bottombar&&this.bottombar.addItem(n,r,this.options),this.sheetIndex+=1,i}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=cs(this.bottombar.deleteItem(),2),e=t[0],r=t[1];e>=0&&(this.datas.splice(e,1),r>=0&&this.sheet.resetData(this.datas[r]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var r=0;r<e.length;r+=1){var n=e[r],i=this.addSheet(n.name,0===r);i.setData(n),0===r&&this.sheet.resetData(i)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,r,"finished"),this}},{key:"cell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}])&&ds(e.prototype,r),n&&ds(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),gs=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new ms(t,e)};e.default=ms}]);
//# sourceMappingURL=xspreadsheet.js.map